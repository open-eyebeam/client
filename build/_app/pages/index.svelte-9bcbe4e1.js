import{S as Y,i as W,s as Z,E as ae,T as Ft,e as T,k as B,t as K,c as I,a as D,m as F,d as y,h as Q,b as g,g as $,I as E,O as ne,U as Lt,V as Ht,W as Gt,q as k,o as O,M as z,a1 as pe,a2 as ve,_ as X,H as ie,J as le,K as te,v as me,l as P,w as G,x as R,y as C,B as q,n as N,p as U,a3 as Ae,a4 as ke,a5 as It,L as Te,j as ue,R as $t,Q as je,F as Me,G as Pe,a6 as Rt,a7 as Be}from"../chunks/index-d2e0416a.js";import{_ as Ct,k as qt,m as Nt,n as Et,o as Ut,q as Xt,r as Yt,v as Wt,w as St,x as Zt,y as Kt,G as ee,z as Fe,C as Ot,D as ce,f as x,s as ge,E as J,F as he,H as $e,I as _e,J as Le,K as He,h as se,l as Dt,B as Ve,L as jt,t as Vt,M as Qt,N as xt,j as Ee,O as Ge,P as fe,Q as zt,R as Jt,T as er,U as tr,V as Re,W as rr,X as we,Y as nr,Z as ir,$ as ar,u as or,S as lr,a0 as sr,g as Ie,a1 as fr,a2 as ur,a3 as cr,a4 as Ce,a5 as qe,a6 as _r,p as dr,a7 as pr,e as mr,a8 as vr,a9 as hr,aa as gr,ab as br,ac as yr}from"../chunks/movement-aea35483.js";import"../chunks/index-34c2ee49.js";var wr=Math.floor,Ar=Math.random;function kr(l,t){return l+wr(Ar()*(t-l+1))}var Tr=kr,Ir=Tr;function $r(l){var t=l.length;return t?l[Ir(0,t-1)]:void 0}var Mt=$r,Er=Ct;function Sr(l,t){return Er(t,function(e){return l[e]})}var Or=Sr;function Dr(l,t){for(var e=-1,n=Array(l);++e<l;)n[e]=t(e);return n}var jr=Dr,Se={exports:{}};function Vr(){return!1}var Mr=Vr;(function(l,t){var e=qt,n=Mr,i=t&&!t.nodeType&&t,a=i&&!0&&l&&!l.nodeType&&l,s=a&&a.exports===i,f=s?e.Buffer:void 0,c=f?f.isBuffer:void 0,_=c||n;l.exports=_})(Se,Se.exports);var Pr=Nt,Br=Et,Fr=Ut,Lr="[object Arguments]",Hr="[object Array]",Gr="[object Boolean]",Rr="[object Date]",Cr="[object Error]",qr="[object Function]",Nr="[object Map]",Ur="[object Number]",Xr="[object Object]",Yr="[object RegExp]",Wr="[object Set]",Zr="[object String]",Kr="[object WeakMap]",Qr="[object ArrayBuffer]",xr="[object DataView]",zr="[object Float32Array]",Jr="[object Float64Array]",en="[object Int8Array]",tn="[object Int16Array]",rn="[object Int32Array]",nn="[object Uint8Array]",an="[object Uint8ClampedArray]",on="[object Uint16Array]",ln="[object Uint32Array]",H={};H[zr]=H[Jr]=H[en]=H[tn]=H[rn]=H[nn]=H[an]=H[on]=H[ln]=!0;H[Lr]=H[Hr]=H[Qr]=H[Gr]=H[xr]=H[Rr]=H[Cr]=H[qr]=H[Nr]=H[Ur]=H[Xr]=H[Yr]=H[Wr]=H[Zr]=H[Kr]=!1;function sn(l){return Fr(l)&&Br(l.length)&&!!H[Pr(l)]}var fn=sn;function un(l){return function(t){return l(t)}}var cn=un,Oe={exports:{}};(function(l,t){var e=Xt,n=t&&!t.nodeType&&t,i=n&&!0&&l&&!l.nodeType&&l,a=i&&i.exports===n,s=a&&e.process,f=function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();l.exports=f})(Oe,Oe.exports);var _n=fn,dn=cn,Ne=Oe.exports,Ue=Ne&&Ne.isTypedArray,pn=Ue?dn(Ue):_n,mn=pn,vn=jr,hn=Yt,gn=St,bn=Se.exports,yn=Wt,wn=mn,An=Object.prototype,kn=An.hasOwnProperty;function Tn(l,t){var e=gn(l),n=!e&&hn(l),i=!e&&!n&&bn(l),a=!e&&!n&&!i&&wn(l),s=e||n||i||a,f=s?vn(l.length,String):[],c=f.length;for(var _ in l)(t||kn.call(l,_))&&!(s&&(_=="length"||i&&(_=="offset"||_=="parent")||a&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||yn(_,c)))&&f.push(_);return f}var In=Tn,$n=Object.prototype;function En(l){var t=l&&l.constructor,e=typeof t=="function"&&t.prototype||$n;return l===e}var Sn=En;function On(l,t){return function(e){return l(t(e))}}var Dn=On,jn=Dn,Vn=jn(Object.keys,Object),Mn=Vn,Pn=Sn,Bn=Mn,Fn=Object.prototype,Ln=Fn.hasOwnProperty;function Hn(l){if(!Pn(l))return Bn(l);var t=[];for(var e in Object(l))Ln.call(l,e)&&e!="constructor"&&t.push(e);return t}var Gn=Hn,Rn=Zt,Cn=Et;function qn(l){return l!=null&&Cn(l.length)&&!Rn(l)}var Nn=qn,Un=In,Xn=Gn,Yn=Nn;function Wn(l){return Yn(l)?Un(l):Xn(l)}var Zn=Wn,Kn=Or,Qn=Zn;function xn(l){return l==null?[]:Kn(l,Qn(l))}var zn=xn,Jn=Mt,ei=zn;function ti(l){return Jn(ei(l))}var ri=ti,ni=Mt,ii=ri,ai=St;function oi(l){var t=ai(l)?ni:ii;return t(l)}var De=oi;function Xe(l){return{c:ae,l:ae,m:ae,d:ae}}function li(l){let t,e,n,i,a,s,f,c,_=l[2]&&Xe();const v=l[8].default,r=Ft(v,l,l[7],null);return{c(){t=T("div"),_&&_.c(),e=B(),r&&r.c(),n=B(),i=T("div"),a=K("CENTER VIEW (DEBUG)"),this.h()},l(o){t=I(o,"DIV",{class:!0,id:!0,style:!0});var u=D(t);_&&_.l(u),e=F(u),r&&r.l(u),u.forEach(y),n=F(o),i=I(o,"DIV",{class:!0});var p=D(i);a=Q(p,"CENTER VIEW (DEBUG)"),p.forEach(y),this.h()},h(){g(t,"class","room svelte-ib3ibm"),g(t,"id","room"),g(t,"style",l[1]),g(i,"class","center-view svelte-ib3ibm")},m(o,u){$(o,t,u),_&&_.m(t,null),E(t,e),r&&r.m(t,null),l[9](t),$(o,n,u),$(o,i,u),E(i,a),s=!0,f||(c=ne(i,"click",l[3]),f=!0)},p(o,[u]){o[2]?_||(_=Xe(),_.c(),_.m(t,e)):_&&(_.d(1),_=null),r&&r.p&&(!s||u&128)&&Lt(r,v,o,o[7],s?Gt(v,o[7],u,null):Ht(o[7]),null),(!s||u&2)&&g(t,"style",o[1])},i(o){s||(k(r,o),s=!0)},o(o){O(r,o),s=!1},d(o){o&&y(t),_&&_.d(),r&&r.d(o),l[9](null),o&&y(n),o&&y(i),f=!1,c()}}}function si(l,t,e){let n;z(l,Kt,u=>e(2,n=u));let{$$slots:i={},$$scope:a}=t;pe();let{room:s={}}=t,{x:f=0}=t,{y:c=0}=t,_={},v="";const r=(u,p)=>{e(1,v=`${s.inlineStyles} transform: translateX(-${u*ee}px) translateY(-${p*ee}px);`)};function o(u){ve[u?"unshift":"push"](()=>{_=u,e(0,_)})}return l.$$set=u=>{"room"in u&&e(4,s=u.room),"x"in u&&e(5,f=u.x),"y"in u&&e(6,c=u.y),"$$scope"in u&&e(7,a=u.$$scope)},l.$$.update=()=>{l.$$.dirty&96&&r(f,c),l.$$.dirty&16&&e(1,v=`${s.inlineStyles} transform: translateX(-50%) translateY(-50%);`)},[_,v,n,r,s,f,c,a,i,o]}class fi extends Y{constructor(t){super(),W(this,t,si,li,Z,{room:4,x:5,y:6})}}function ui(l){let t,e,n,i,a,s,f;return{c(){t=T("div"),e=T("img"),this.h()},l(c){t=I(c,"DIV",{class:!0,id:!0,alt:!0,style:!0});var _=D(t);e=I(_,"IMG",{src:!0,class:!0}),_.forEach(y),this.h()},h(){X(e.src,n=l[6]&&l[6].imageUrl?l[6].imageUrl:De(l[1]).imageUrl)||g(e,"src",n),g(e,"class","svelte-zqf5vo"),g(t,"class","avatar svelte-zqf5vo"),g(t,"id",l[2]),g(t,"alt",i=l[0].name),g(t,"style",a="transform: translateY("+l[4]+"px) translateX("+l[5]+"px)"),ie(t,"self",l[0].self)},m(c,_){$(c,t,_),E(t,e),l[8](t),f=!0},p(c,[_]){(!f||_&2&&!X(e.src,n=c[6]&&c[6].imageUrl?c[6].imageUrl:De(c[1]).imageUrl))&&g(e,"src",n),(!f||_&4)&&g(t,"id",c[2]),(!f||_&1&&i!==(i=c[0].name))&&g(t,"alt",i),(!f||_&48&&a!==(a="transform: translateY("+c[4]+"px) translateX("+c[5]+"px)"))&&g(t,"style",a),_&1&&ie(t,"self",c[0].self)},i(c){f||(le(()=>{s||(s=te(t,Fe,{},!0)),s.run(1)}),f=!0)},o(c){s||(s=te(t,Fe,{},!1)),s.run(0),f=!1},d(c){c&&y(t),l[8](null),c&&s&&s.end()}}}function ci(l,t,e){let n;z(l,Ot,b=>e(7,n=b));let i={},a={};const s=b=>{i.popper&&(i.hide(),i.destroy(),clearTimeout(a)),v&&v.nodeName&&(i=tippy(v,{content:b.text,arrow:!1,offset:[0,5],sticky:!0,animation:"fade",inertia:!0,theme:"chat",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}),i.show(),a=setTimeout(()=>{i.hide(),setTimeout(()=>{i.destroy()},500)},4e3))};let{player:f={}}=t,{avatars:c=[]}=t,{key:_=""}=t,v={},r=c.find(b=>b._id===f.shape),o=f.y*ee,u=f.x*ee;me(async()=>{f.self||tippy(v,{content:f.name,arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}})});function p(b){ve[b?"unshift":"push"](()=>{v=b,e(3,v)})}return l.$$set=b=>{"player"in b&&e(0,f=b.player),"avatars"in b&&e(1,c=b.avatars),"key"in b&&e(2,_=b.key)},l.$$.update=()=>{if(l.$$.dirty&132){let b=n[n.length-1];b&&b.uuid==_&&Date.now()-b.timestamp<5e3&&s(b)}l.$$.dirty&1&&(e(4,o=f.y*ee),e(5,u=f.x*ee))},[f,c,_,v,o,u,r,n,p]}class _i extends Y{constructor(t){super(),W(this,t,ci,ui,Z,{player:0,avatars:1,key:2})}}function Ye(l,t,e){const n=l.slice();return n[3]=t[e][0],n[4]=t[e][1],n}function We(l){let t,e;return t=new _i({props:{player:l[4],key:l[3],avatars:l[2]}}),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&1&&(a.player=n[4]),i&1&&(a.key=n[3]),i&4&&(a.avatars=n[2]),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function Ze(l,t){let e,n,i,a=t[4].room===t[1]&&!t[4].inTransit&&We(t);return{key:l,first:null,c(){e=P(),a&&a.c(),n=P(),this.h()},l(s){e=P(),a&&a.l(s),n=P(),this.h()},h(){this.first=e},m(s,f){$(s,e,f),a&&a.m(s,f),$(s,n,f),i=!0},p(s,f){t=s,t[4].room===t[1]&&!t[4].inTransit?a?(a.p(t,f),f&3&&k(a,1)):(a=We(t),a.c(),k(a,1),a.m(n.parentNode,n)):a&&(N(),O(a,1,1,()=>{a=null}),U())},i(s){i||(k(a),i=!0)},o(s){O(a),i=!1},d(s){s&&y(e),a&&a.d(s),s&&y(n)}}}function di(l){let t=[],e=new Map,n,i,a=Object.entries(l[0]);const s=f=>f[3];for(let f=0;f<a.length;f+=1){let c=Ye(l,a,f),_=s(c);e.set(_,t[f]=Ze(_,c))}return{c(){for(let f=0;f<t.length;f+=1)t[f].c();n=P()},l(f){for(let c=0;c<t.length;c+=1)t[c].l(f);n=P()},m(f,c){for(let _=0;_<t.length;_+=1)t[_].m(f,c);$(f,n,c),i=!0},p(f,[c]){c&7&&(a=Object.entries(f[0]),N(),t=Ae(t,c,s,1,f,a,e,n.parentNode,ke,Ze,n,Ye),U())},i(f){if(!i){for(let c=0;c<a.length;c+=1)k(t[c]);i=!0}},o(f){for(let c=0;c<t.length;c+=1)O(t[c]);i=!1},d(f){for(let c=0;c<t.length;c+=1)t[c].d(f);f&&y(n)}}}function pi(l,t,e){let{players:n={}}=t,{currentRoomId:i=""}=t,{avatars:a=[]}=t;return l.$$set=s=>{"players"in s&&e(0,n=s.players),"currentRoomId"in s&&e(1,i=s.currentRoomId),"avatars"in s&&e(2,a=s.avatars)},[n,i,a]}class mi extends Y{constructor(t){super(),W(this,t,pi,di,Z,{players:0,currentRoomId:1,avatars:2})}}function Ke(l){let t,e;return{c(){t=T("img"),this.h()},l(n){t=I(n,"IMG",{src:!0,class:!0}),this.h()},h(){X(t.src,e=ce(l[0].iconImage).quality(100).height(300).url())||g(t,"src",e),g(t,"class","svelte-rtn8vc")},m(n,i){$(n,t,i)},p(n,i){i&1&&!X(t.src,e=ce(n[0].iconImage).quality(100).height(300).url())&&g(t,"src",e)},d(n){n&&y(t)}}}function vi(l){let t,e,n,i,a,s,f,c=l[0].iconImage&&Ke(l);return{c(){t=T("div"),c&&c.c(),this.h()},l(_){t=I(_,"DIV",{class:!0,id:!0,alt:!0,style:!0});var v=D(t);c&&c.l(v),v.forEach(y),this.h()},h(){g(t,"class","object svelte-rtn8vc"),g(t,"id",e=l[0]._id),g(t,"alt",n=l[0].title),g(t,"style",l[2]),ie(t,"static",l[0].static),ie(t,"image",l[0].iconImage)},m(_,v){$(_,t,v),c&&c.m(t,null),l[5](t),a=!0,s||(f=ne(t,"click",hi),s=!0)},p(_,[v]){_[0].iconImage?c?c.p(_,v):(c=Ke(_),c.c(),c.m(t,null)):c&&(c.d(1),c=null),(!a||v&1&&e!==(e=_[0]._id))&&g(t,"id",e),(!a||v&1&&n!==(n=_[0].title))&&g(t,"alt",n),v&1&&ie(t,"static",_[0].static),v&1&&ie(t,"image",_[0].iconImage)},i(_){a||(le(()=>{i||(i=te(t,x,{},!0)),i.run(1)}),a=!0)},o(_){i||(i=te(t,x,{},!1)),i.run(0),a=!1},d(_){_&&y(t),c&&c.d(),l[5](null),_&&i&&i.end(),s=!1,f()}}}const hi=()=>{};function gi(l,t,e){let n;z(l,ge,u=>e(4,n=u));let{object:i={}}=t,a={},s={},f=i.y*ee,c=i.x*ee,_=J(i,"dimensions.width",1)*ee,v=J(i,"dimensions.height",1)*ee;const r=`transform: translateY(${f}px) translateX(${c}px); width: ${_}px; height: ${v}px;`;me(async()=>{e(3,s=tippy(a,{content:i.title,arrow:!1,offset:[0,5],theme:i.static?"static":"name",hideOnClick:!1,sticky:!0,trigger:"manual",flip:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}))});function o(u){ve[u?"unshift":"push"](()=>{a=u,e(1,a)})}return l.$$set=u=>{"object"in u&&e(0,i=u.object)},l.$$.update=()=>{l.$$.dirty&24&&s.popper&&(n?s.show():s.hide())},[i,a,r,s,n,o]}class bi extends Y{constructor(t){super(),W(this,t,gi,vi,Z,{object:0})}}function Qe(l,t,e){const n=l.slice();return n[1]=t[e],n}function xe(l,t){let e,n,i;return n=new bi({props:{object:t[1]}}),{key:l,first:null,c(){e=P(),G(n.$$.fragment),this.h()},l(a){e=P(),R(n.$$.fragment,a),this.h()},h(){this.first=e},m(a,s){$(a,e,s),C(n,a,s),i=!0},p(a,s){t=a;const f={};s&1&&(f.object=t[1]),n.$set(f)},i(a){i||(k(n.$$.fragment,a),i=!0)},o(a){O(n.$$.fragment,a),i=!1},d(a){a&&y(e),q(n,a)}}}function yi(l){let t=[],e=new Map,n,i,a=l[0];const s=f=>f[1]._id;for(let f=0;f<a.length;f+=1){let c=Qe(l,a,f),_=s(c);e.set(_,t[f]=xe(_,c))}return{c(){for(let f=0;f<t.length;f+=1)t[f].c();n=P()},l(f){for(let c=0;c<t.length;c+=1)t[c].l(f);n=P()},m(f,c){for(let _=0;_<t.length;_+=1)t[_].m(f,c);$(f,n,c),i=!0},p(f,[c]){c&1&&(a=f[0],N(),t=Ae(t,c,s,1,f,a,e,n.parentNode,ke,xe,n,Qe),U())},i(f){if(!i){for(let c=0;c<a.length;c+=1)k(t[c]);i=!0}},o(f){for(let c=0;c<t.length;c+=1)O(t[c]);i=!1},d(f){for(let c=0;c<t.length;c+=1)t[c].d(f);f&&y(n)}}}function wi(l,t,e){let{objects:n={}}=t;return l.$$set=i=>{"objects"in i&&e(0,n=i.objects)},[n]}class Ai extends Y{constructor(t){super(),W(this,t,wi,yi,Z,{objects:0})}}function ze(l){let t,e;return{c(){t=T("img"),this.h()},l(n){t=I(n,"IMG",{src:!0}),this.h()},h(){X(t.src,e=ce(l[0].backgroundImage).quality(100).url())||g(t,"src",e)},m(n,i){$(n,t,i)},p(n,i){i&1&&!X(t.src,e=ce(n[0].backgroundImage).quality(100).url())&&g(t,"src",e)},d(n){n&&y(t)}}}function ki(l){let t,e,n,i,a,s=l[0].backgroundImage&&ze(l);return{c(){t=T("div"),s&&s.c(),this.h()},l(f){t=I(f,"DIV",{class:!0,id:!0,alt:!0,style:!0});var c=D(t);s&&s.l(c),c.forEach(y),this.h()},h(){g(t,"class","zone svelte-1sqo6n0"),g(t,"id",e=l[0]._id),g(t,"alt",n=l[0].title),g(t,"style",l[2])},m(f,c){$(f,t,c),s&&s.m(t,null),l[5](t),a=!0},p(f,[c]){f[0].backgroundImage?s?s.p(f,c):(s=ze(f),s.c(),s.m(t,null)):s&&(s.d(1),s=null),(!a||c&1&&e!==(e=f[0]._id))&&g(t,"id",e),(!a||c&1&&n!==(n=f[0].title))&&g(t,"alt",n)},i(f){a||(le(()=>{i||(i=te(t,x,{},!0)),i.run(1)}),a=!0)},o(f){i||(i=te(t,x,{},!1)),i.run(0),a=!1},d(f){f&&y(t),s&&s.d(),l[5](null),f&&i&&i.end()}}}function Ti(l,t,e){let n;z(l,ge,u=>e(4,n=u));let{zone:i={}}=t,a={},s={},f=i.y*ee,c=i.x*ee,_=J(i,"dimensions.width",1)*ee,v=J(i,"dimensions.height",1)*ee;const r=`transform: translateY(${f}px) translateX(${c}px); width: ${_}px; height: ${v}px;};`;me(async()=>{e(3,s=tippy(a,{content:i.title,arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,sticky:!0,trigger:"manual",flip:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}))});function o(u){ve[u?"unshift":"push"](()=>{a=u,e(1,a)})}return l.$$set=u=>{"zone"in u&&e(0,i=u.zone)},l.$$.update=()=>{l.$$.dirty&24&&s.popper&&(n?s.show():s.hide())},[i,a,r,s,n,o]}class Ii extends Y{constructor(t){super(),W(this,t,Ti,ki,Z,{zone:0})}}function Je(l,t,e){const n=l.slice();return n[1]=t[e],n}function et(l,t){let e,n,i;return n=new Ii({props:{zone:t[1]}}),{key:l,first:null,c(){e=P(),G(n.$$.fragment),this.h()},l(a){e=P(),R(n.$$.fragment,a),this.h()},h(){this.first=e},m(a,s){$(a,e,s),C(n,a,s),i=!0},p(a,s){t=a;const f={};s&1&&(f.zone=t[1]),n.$set(f)},i(a){i||(k(n.$$.fragment,a),i=!0)},o(a){O(n.$$.fragment,a),i=!1},d(a){a&&y(e),q(n,a)}}}function $i(l){let t=[],e=new Map,n,i,a=l[0];const s=f=>f[1]._id;for(let f=0;f<a.length;f+=1){let c=Je(l,a,f),_=s(c);e.set(_,t[f]=et(_,c))}return{c(){for(let f=0;f<t.length;f+=1)t[f].c();n=P()},l(f){for(let c=0;c<t.length;c+=1)t[c].l(f);n=P()},m(f,c){for(let _=0;_<t.length;_+=1)t[_].m(f,c);$(f,n,c),i=!0},p(f,[c]){c&1&&(a=f[0],N(),t=Ae(t,c,s,1,f,a,e,n.parentNode,ke,et,n,Je),U())},i(f){if(!i){for(let c=0;c<a.length;c+=1)k(t[c]);i=!0}},o(f){for(let c=0;c<t.length;c+=1)O(t[c]);i=!1},d(f){for(let c=0;c<t.length;c+=1)t[c].d(f);f&&y(n)}}}function Ei(l,t,e){let{zones:n={}}=t;return l.$$set=i=>{"zones"in i&&e(0,n=i.zones)},[n]}class Si extends Y{constructor(t){super(),W(this,t,Ei,$i,Z,{zones:0})}}var Pt={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(l){(function(){var t=function(){this.init()};t.prototype={init:function(){var r=this||e;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var o=this||e;if(r=parseFloat(r),o.ctx||v(),typeof r!="undefined"&&r>=0&&r<=1){if(o._volume=r,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(r,e.ctx.currentTime);for(var u=0;u<o._howls.length;u++)if(!o._howls[u]._webAudio)for(var p=o._howls[u]._getSoundIds(),b=0;b<p.length;b++){var m=o._howls[u]._soundById(p[b]);m&&m._node&&(m._node.volume=m._volume*r)}return o}return o._volume},mute:function(r){var o=this||e;o.ctx||v(),o._muted=r,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(r?0:o._volume,e.ctx.currentTime);for(var u=0;u<o._howls.length;u++)if(!o._howls[u]._webAudio)for(var p=o._howls[u]._getSoundIds(),b=0;b<p.length;b++){var m=o._howls[u]._soundById(p[b]);m&&m._node&&(m._node.muted=r?!0:m._muted)}return o},stop:function(){for(var r=this||e,o=0;o<r._howls.length;o++)r._howls[o].stop();return r},unload:function(){for(var r=this||e,o=r._howls.length-1;o>=0;o--)r._howls[o].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close!="undefined"&&(r.ctx.close(),r.ctx=null,v()),r},codecs:function(r){return(this||e)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||e;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio!="undefined")try{var o=new Audio;typeof o.oncanplaythrough=="undefined"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var o=new Audio;o.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||e,o=null;try{o=typeof Audio!="undefined"?new Audio:null}catch{return r}if(!o||typeof o.canPlayType!="function")return r;var u=o.canPlayType("audio/mpeg;").replace(/^no$/,""),p=r._navigator?r._navigator.userAgent:"",b=p.match(/OPR\/([0-6].)/g),m=b&&parseInt(b[0].split("/")[1],10)<33,d=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,h=p.match(/Version\/(.*?) /),A=d&&h&&parseInt(h[1],10)<15;return r._codecs={mp3:!!(!m&&(u||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!u,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!A&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!A&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||e;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var o=function(u){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,r._releaseHtml5Audio(p)}catch{r.noAudio=!0;break}for(var b=0;b<r._howls.length;b++)if(!r._howls[b]._webAudio)for(var m=r._howls[b]._getSoundIds(),d=0;d<m.length;d++){var h=r._howls[b]._soundById(m[d]);h&&h._node&&!h._node._unlocked&&(h._node._unlocked=!0,h._node.load())}r._autoResume();var A=r.ctx.createBufferSource();A.buffer=r._scratchBuffer,A.connect(r.ctx.destination),typeof A.start=="undefined"?A.noteOn(0):A.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),A.onended=function(){A.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var j=0;j<r._howls.length;j++)r._howls[j]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),r}},_obtainHtml5Audio:function(){var r=this||e;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise!="undefined"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var o=this||e;return r._unlocked&&o._html5AudioPool.push(r),o},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend=="undefined"||!e.usingWebAudio)){for(var o=0;o<r._howls.length;o++)if(r._howls[o]._webAudio){for(var u=0;u<r._howls[o]._sounds.length;u++)if(!r._howls[o]._sounds[u]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(!!r.autoSuspend){r._suspendTimer=null,r.state="suspending";var p=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(p,p)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume=="undefined"||!e.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var o=0;o<r._howls.length;o++)r._howls[o]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var e=new t,n=function(r){var o=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(r)};n.prototype={init:function(r){var o=this;return e.ctx||v(),o._autoplay=r.autoplay||!1,o._format=typeof r.format!="string"?r.format:[r.format],o._html5=r.html5||!1,o._muted=r.mute||!1,o._loop=r.loop||!1,o._pool=r.pool||5,o._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,o._rate=r.rate||1,o._sprite=r.sprite||{},o._src=typeof r.src!="string"?r.src:[r.src],o._volume=r.volume!==void 0?r.volume:1,o._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=r.onend?[{fn:r.onend}]:[],o._onfade=r.onfade?[{fn:r.onfade}]:[],o._onload=r.onload?[{fn:r.onload}]:[],o._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],o._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],o._onpause=r.onpause?[{fn:r.onpause}]:[],o._onplay=r.onplay?[{fn:r.onplay}]:[],o._onstop=r.onstop?[{fn:r.onstop}]:[],o._onmute=r.onmute?[{fn:r.onmute}]:[],o._onvolume=r.onvolume?[{fn:r.onvolume}]:[],o._onrate=r.onrate?[{fn:r.onrate}]:[],o._onseek=r.onseek?[{fn:r.onseek}]:[],o._onunlock=r.onunlock?[{fn:r.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx!="undefined"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var r=this,o=null;if(e.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var u=0;u<r._src.length;u++){var p,b;if(r._format&&r._format[u])p=r._format[u];else{if(b=r._src[u],typeof b!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(b),p||(p=/\.([^.]+)$/.exec(b.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&e.codecs(p)){o=r._src[u];break}}if(!o){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=o,r._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new i(r),r._webAudio&&s(r),r},play:function(r,o){var u=this,p=null;if(typeof r=="number")p=r,r=null;else{if(typeof r=="string"&&u._state==="loaded"&&!u._sprite[r])return null;if(typeof r=="undefined"&&(r="__default",!u._playLock)){for(var b=0,m=0;m<u._sounds.length;m++)u._sounds[m]._paused&&!u._sounds[m]._ended&&(b++,p=u._sounds[m]._id);b===1?r=null:p=null}}var d=p?u._soundById(p):u._inactiveSound();if(!d)return null;if(p&&!r&&(r=d._sprite||"__default"),u._state!=="loaded"){d._sprite=r,d._ended=!1;var h=d._id;return u._queue.push({event:"play",action:function(){u.play(h)}}),h}if(p&&!d._paused)return o||u._loadQueue("play"),d._id;u._webAudio&&e._autoResume();var A=Math.max(0,d._seek>0?d._seek:u._sprite[r][0]/1e3),j=Math.max(0,(u._sprite[r][0]+u._sprite[r][1])/1e3-A),w=j*1e3/Math.abs(d._rate),S=u._sprite[r][0]/1e3,M=(u._sprite[r][0]+u._sprite[r][1])/1e3;d._sprite=r,d._ended=!1;var oe=function(){d._paused=!1,d._seek=A,d._start=S,d._stop=M,d._loop=!!(d._loop||u._sprite[r][2])};if(A>=M){u._ended(d);return}var L=d._node;if(u._webAudio){var be=function(){u._playLock=!1,oe(),u._refreshBuffer(d);var de=d._muted||u._muted?0:d._volume;L.gain.setValueAtTime(de,e.ctx.currentTime),d._playStart=e.ctx.currentTime,typeof L.bufferSource.start=="undefined"?d._loop?L.bufferSource.noteGrainOn(0,A,86400):L.bufferSource.noteGrainOn(0,A,j):d._loop?L.bufferSource.start(0,A,86400):L.bufferSource.start(0,A,j),w!==1/0&&(u._endTimers[d._id]=setTimeout(u._ended.bind(u,d),w)),o||setTimeout(function(){u._emit("play",d._id),u._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?be():(u._playLock=!0,u.once("resume",be),u._clearTimer(d._id))}else{var ye=function(){L.currentTime=A,L.muted=d._muted||u._muted||e._muted||L.muted,L.volume=d._volume*e.volume(),L.playbackRate=d._rate;try{var de=L.play();if(de&&typeof Promise!="undefined"&&(de instanceof Promise||typeof de.then=="function")?(u._playLock=!0,oe(),de.then(function(){u._playLock=!1,L._unlocked=!0,o?u._loadQueue():u._emit("play",d._id)}).catch(function(){u._playLock=!1,u._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),d._ended=!0,d._paused=!0})):o||(u._playLock=!1,oe(),u._emit("play",d._id)),L.playbackRate=d._rate,L.paused){u._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||d._loop?u._endTimers[d._id]=setTimeout(u._ended.bind(u,d),w):(u._endTimers[d._id]=function(){u._ended(d),L.removeEventListener("ended",u._endTimers[d._id],!1)},L.addEventListener("ended",u._endTimers[d._id],!1))}catch(Bt){u._emit("playerror",d._id,Bt)}};L.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(L.src=u._src,L.load());var V=window&&window.ejecta||!L.readyState&&e._navigator.isCocoonJS;if(L.readyState>=3||V)ye();else{u._playLock=!0,u._state="loading";var re=function(){u._state="loaded",ye(),L.removeEventListener(e._canPlayEvent,re,!1)};L.addEventListener(e._canPlayEvent,re,!1),u._clearTimer(d._id)}}return d._id},pause:function(r){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(r)}}),o;for(var u=o._getSoundIds(r),p=0;p<u.length;p++){o._clearTimer(u[p]);var b=o._soundById(u[p]);if(b&&!b._paused&&(b._seek=o.seek(u[p]),b._rateSeek=0,b._paused=!0,o._stopFade(u[p]),b._node))if(o._webAudio){if(!b._node.bufferSource)continue;typeof b._node.bufferSource.stop=="undefined"?b._node.bufferSource.noteOff(0):b._node.bufferSource.stop(0),o._cleanBuffer(b._node)}else(!isNaN(b._node.duration)||b._node.duration===1/0)&&b._node.pause();arguments[1]||o._emit("pause",b?b._id:null)}return o},stop:function(r,o){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"stop",action:function(){u.stop(r)}}),u;for(var p=u._getSoundIds(r),b=0;b<p.length;b++){u._clearTimer(p[b]);var m=u._soundById(p[b]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,u._stopFade(p[b]),m._node&&(u._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop=="undefined"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),u._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&u._clearSound(m._node))),o||u._emit("stop",m._id))}return u},mute:function(r,o){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"mute",action:function(){u.mute(r,o)}}),u;if(typeof o=="undefined")if(typeof r=="boolean")u._muted=r;else return u._muted;for(var p=u._getSoundIds(o),b=0;b<p.length;b++){var m=u._soundById(p[b]);m&&(m._muted=r,m._interval&&u._stopFade(m._id),u._webAudio&&m._node?m._node.gain.setValueAtTime(r?0:m._volume,e.ctx.currentTime):m._node&&(m._node.muted=e._muted?!0:r),u._emit("mute",m._id))}return u},volume:function(){var r=this,o=arguments,u,p;if(o.length===0)return r._volume;if(o.length===1||o.length===2&&typeof o[1]=="undefined"){var b=r._getSoundIds(),m=b.indexOf(o[0]);m>=0?p=parseInt(o[0],10):u=parseFloat(o[0])}else o.length>=2&&(u=parseFloat(o[0]),p=parseInt(o[1],10));var d;if(typeof u!="undefined"&&u>=0&&u<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,o)}}),r;typeof p=="undefined"&&(r._volume=u),p=r._getSoundIds(p);for(var h=0;h<p.length;h++)d=r._soundById(p[h]),d&&(d._volume=u,o[2]||r._stopFade(p[h]),r._webAudio&&d._node&&!d._muted?d._node.gain.setValueAtTime(u,e.ctx.currentTime):d._node&&!d._muted&&(d._node.volume=u*e.volume()),r._emit("volume",d._id))}else return d=p?r._soundById(p):r._sounds[0],d?d._volume:0;return r},fade:function(r,o,u,p){var b=this;if(b._state!=="loaded"||b._playLock)return b._queue.push({event:"fade",action:function(){b.fade(r,o,u,p)}}),b;r=Math.min(Math.max(0,parseFloat(r)),1),o=Math.min(Math.max(0,parseFloat(o)),1),u=parseFloat(u),b.volume(r,p);for(var m=b._getSoundIds(p),d=0;d<m.length;d++){var h=b._soundById(m[d]);if(h){if(p||b._stopFade(m[d]),b._webAudio&&!h._muted){var A=e.ctx.currentTime,j=A+u/1e3;h._volume=r,h._node.gain.setValueAtTime(r,A),h._node.gain.linearRampToValueAtTime(o,j)}b._startFadeInterval(h,r,o,u,m[d],typeof p=="undefined")}}return b},_startFadeInterval:function(r,o,u,p,b,m){var d=this,h=o,A=u-o,j=Math.abs(A/.01),w=Math.max(4,j>0?p/j:p),S=Date.now();r._fadeTo=u,r._interval=setInterval(function(){var M=(Date.now()-S)/p;S=Date.now(),h+=A*M,h=Math.round(h*100)/100,A<0?h=Math.max(u,h):h=Math.min(u,h),d._webAudio?r._volume=h:d.volume(h,r._id,!0),m&&(d._volume=h),(u<o&&h<=u||u>o&&h>=u)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,d.volume(u,r._id),d._emit("fade",r._id))},w)},_stopFade:function(r){var o=this,u=o._soundById(r);return u&&u._interval&&(o._webAudio&&u._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(u._interval),u._interval=null,o.volume(u._fadeTo,r),u._fadeTo=null,o._emit("fade",r)),o},loop:function(){var r=this,o=arguments,u,p,b;if(o.length===0)return r._loop;if(o.length===1)if(typeof o[0]=="boolean")u=o[0],r._loop=u;else return b=r._soundById(parseInt(o[0],10)),b?b._loop:!1;else o.length===2&&(u=o[0],p=parseInt(o[1],10));for(var m=r._getSoundIds(p),d=0;d<m.length;d++)b=r._soundById(m[d]),b&&(b._loop=u,r._webAudio&&b._node&&b._node.bufferSource&&(b._node.bufferSource.loop=u,u&&(b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop,r.playing(m[d])&&(r.pause(m[d],!0),r.play(m[d],!0)))));return r},rate:function(){var r=this,o=arguments,u,p;if(o.length===0)p=r._sounds[0]._id;else if(o.length===1){var b=r._getSoundIds(),m=b.indexOf(o[0]);m>=0?p=parseInt(o[0],10):u=parseFloat(o[0])}else o.length===2&&(u=parseFloat(o[0]),p=parseInt(o[1],10));var d;if(typeof u=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,o)}}),r;typeof p=="undefined"&&(r._rate=u),p=r._getSoundIds(p);for(var h=0;h<p.length;h++)if(d=r._soundById(p[h]),d){r.playing(p[h])&&(d._rateSeek=r.seek(p[h]),d._playStart=r._webAudio?e.ctx.currentTime:d._playStart),d._rate=u,r._webAudio&&d._node&&d._node.bufferSource?d._node.bufferSource.playbackRate.setValueAtTime(u,e.ctx.currentTime):d._node&&(d._node.playbackRate=u);var A=r.seek(p[h]),j=(r._sprite[d._sprite][0]+r._sprite[d._sprite][1])/1e3-A,w=j*1e3/Math.abs(d._rate);(r._endTimers[p[h]]||!d._paused)&&(r._clearTimer(p[h]),r._endTimers[p[h]]=setTimeout(r._ended.bind(r,d),w)),r._emit("rate",d._id)}}else return d=r._soundById(p),d?d._rate:r._rate;return r},seek:function(){var r=this,o=arguments,u,p;if(o.length===0)r._sounds.length&&(p=r._sounds[0]._id);else if(o.length===1){var b=r._getSoundIds(),m=b.indexOf(o[0]);m>=0?p=parseInt(o[0],10):r._sounds.length&&(p=r._sounds[0]._id,u=parseFloat(o[0]))}else o.length===2&&(u=parseFloat(o[0]),p=parseInt(o[1],10));if(typeof p=="undefined")return 0;if(typeof u=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,o)}}),r;var d=r._soundById(p);if(d)if(typeof u=="number"&&u>=0){var h=r.playing(p);h&&r.pause(p,!0),d._seek=u,d._ended=!1,r._clearTimer(p),!r._webAudio&&d._node&&!isNaN(d._node.duration)&&(d._node.currentTime=u);var A=function(){h&&r.play(p,!0),r._emit("seek",p)};if(h&&!r._webAudio){var j=function(){r._playLock?setTimeout(j,0):A()};setTimeout(j,0)}else A()}else if(r._webAudio){var w=r.playing(p)?e.ctx.currentTime-d._playStart:0,S=d._rateSeek?d._rateSeek-d._seek:0;return d._seek+(S+w*Math.abs(d._rate))}else return d._node.currentTime;return r},playing:function(r){var o=this;if(typeof r=="number"){var u=o._soundById(r);return u?!u._paused:!1}for(var p=0;p<o._sounds.length;p++)if(!o._sounds[p]._paused)return!0;return!1},duration:function(r){var o=this,u=o._duration,p=o._soundById(r);return p&&(u=o._sprite[p._sprite][1]/1e3),u},state:function(){return this._state},unload:function(){for(var r=this,o=r._sounds,u=0;u<o.length;u++)o[u]._paused||r.stop(o[u]._id),r._webAudio||(r._clearSound(o[u]._node),o[u]._node.removeEventListener("error",o[u]._errorFn,!1),o[u]._node.removeEventListener(e._canPlayEvent,o[u]._loadFn,!1),o[u]._node.removeEventListener("ended",o[u]._endFn,!1),e._releaseHtml5Audio(o[u]._node)),delete o[u]._node,r._clearTimer(o[u]._id);var p=e._howls.indexOf(r);p>=0&&e._howls.splice(p,1);var b=!0;for(u=0;u<e._howls.length;u++)if(e._howls[u]._src===r._src||r._src.indexOf(e._howls[u]._src)>=0){b=!1;break}return a&&b&&delete a[r._src],e.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,o,u,p){var b=this,m=b["_on"+r];return typeof o=="function"&&m.push(p?{id:u,fn:o,once:p}:{id:u,fn:o}),b},off:function(r,o,u){var p=this,b=p["_on"+r],m=0;if(typeof o=="number"&&(u=o,o=null),o||u)for(m=0;m<b.length;m++){var d=u===b[m].id;if(o===b[m].fn&&d||!o&&d){b.splice(m,1);break}}else if(r)p["_on"+r]=[];else{var h=Object.keys(p);for(m=0;m<h.length;m++)h[m].indexOf("_on")===0&&Array.isArray(p[h[m]])&&(p[h[m]]=[])}return p},once:function(r,o,u){var p=this;return p.on(r,o,u,1),p},_emit:function(r,o,u){for(var p=this,b=p["_on"+r],m=b.length-1;m>=0;m--)(!b[m].id||b[m].id===o||r==="load")&&(setTimeout(function(d){d.call(this,o,u)}.bind(p,b[m].fn),0),b[m].once&&p.off(r,b[m].fn,b[m].id));return p._loadQueue(r),p},_loadQueue:function(r){var o=this;if(o._queue.length>0){var u=o._queue[0];u.event===r&&(o._queue.shift(),o._loadQueue()),r||u.action()}return o},_ended:function(r){var o=this,u=r._sprite;if(!o._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(o._ended.bind(o,r),100),o;var p=!!(r._loop||o._sprite[u][2]);if(o._emit("end",r._id),!o._webAudio&&p&&o.stop(r._id,!0).play(r._id),o._webAudio&&p){o._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=e.ctx.currentTime;var b=(r._stop-r._start)*1e3/Math.abs(r._rate);o._endTimers[r._id]=setTimeout(o._ended.bind(o,r),b)}return o._webAudio&&!p&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,o._clearTimer(r._id),o._cleanBuffer(r._node),e._autoSuspend()),!o._webAudio&&!p&&o.stop(r._id,!0),o},_clearTimer:function(r){var o=this;if(o._endTimers[r]){if(typeof o._endTimers[r]!="function")clearTimeout(o._endTimers[r]);else{var u=o._soundById(r);u&&u._node&&u._node.removeEventListener("ended",o._endTimers[r],!1)}delete o._endTimers[r]}return o},_soundById:function(r){for(var o=this,u=0;u<o._sounds.length;u++)if(r===o._sounds[u]._id)return o._sounds[u];return null},_inactiveSound:function(){var r=this;r._drain();for(var o=0;o<r._sounds.length;o++)if(r._sounds[o]._ended)return r._sounds[o].reset();return new i(r)},_drain:function(){var r=this,o=r._pool,u=0,p=0;if(!(r._sounds.length<o)){for(p=0;p<r._sounds.length;p++)r._sounds[p]._ended&&u++;for(p=r._sounds.length-1;p>=0;p--){if(u<=o)return;r._sounds[p]._ended&&(r._webAudio&&r._sounds[p]._node&&r._sounds[p]._node.disconnect(0),r._sounds.splice(p,1),u--)}}},_getSoundIds:function(r){var o=this;if(typeof r=="undefined"){for(var u=[],p=0;p<o._sounds.length;p++)u.push(o._sounds[p]._id);return u}else return[r]},_refreshBuffer:function(r){var o=this;return r._node.bufferSource=e.ctx.createBufferSource(),r._node.bufferSource.buffer=a[o._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,e.ctx.currentTime),o},_cleanBuffer:function(r){var o=this,u=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),u))try{r.bufferSource.buffer=e._scratchBuffer}catch{}return r.bufferSource=null,o},_clearSound:function(r){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(r){this._parent=r,this.init()};i.prototype={init:function(){var r=this,o=r._parent;return r._muted=o._muted,r._loop=o._loop,r._volume=o._volume,r._rate=o._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,o._sounds.push(r),r.create(),r},create:function(){var r=this,o=r._parent,u=e._muted||r._muted||r._parent._muted?0:r._volume;return o._webAudio?(r._node=typeof e.ctx.createGain=="undefined"?e.ctx.createGainNode():e.ctx.createGain(),r._node.gain.setValueAtTime(u,e.ctx.currentTime),r._node.paused=!0,r._node.connect(e.masterGain)):e.noAudio||(r._node=e._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(e._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=o._src,r._node.preload=o._preload===!0?"auto":o._preload,r._node.volume=u*e.volume(),r._node.load()),r},reset:function(){var r=this,o=r._parent;return r._muted=o._muted,r._loop=o._loop,r._volume=o._volume,r._rate=o._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,o=r._parent;o._duration=Math.ceil(r._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),r._node.removeEventListener(e._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,o=r._parent;o._duration===1/0&&(o._duration=Math.ceil(r._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var a={},s=function(r){var o=r._src;if(a[o]){r._duration=a[o].duration,_(r);return}if(/^data:[^;]+;base64,/.test(o)){for(var u=atob(o.split(",")[1]),p=new Uint8Array(u.length),b=0;b<u.length;++b)p[b]=u.charCodeAt(b);c(p.buffer,r)}else{var m=new XMLHttpRequest;m.open(r._xhr.method,o,!0),m.withCredentials=r._xhr.withCredentials,m.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(d){m.setRequestHeader(d,r._xhr.headers[d])}),m.onload=function(){var d=(m.status+"")[0];if(d!=="0"&&d!=="2"&&d!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}c(m.response,r)},m.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete a[o],r.load())},f(m)}},f=function(r){try{r.send()}catch{r.onerror()}},c=function(r,o){var u=function(){o._emit("loaderror",null,"Decoding audio data failed.")},p=function(b){b&&o._sounds.length>0?(a[o._src]=b,_(o,b)):u()};typeof Promise!="undefined"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(r).then(p).catch(u):e.ctx.decodeAudioData(r,p,u)},_=function(r,o){o&&!r._duration&&(r._duration=o.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},v=function(){if(!!e.usingWebAudio){try{typeof AudioContext!="undefined"?e.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),u=o?parseInt(o[1],10):null;if(r&&u&&u<9){var p=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!p&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain=="undefined"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};l.Howler=e,l.Howl=n,typeof he!="undefined"?(he.HowlerGlobal=t,he.Howler=e,he.Howl=n,he.Sound=i):typeof window!="undefined"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var i=n._howls.length-1;i>=0;i--)n._howls[i].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;if(n=typeof n!="number"?a._pos[1]:n,i=typeof i!="number"?a._pos[2]:i,typeof e=="number")a._pos=[e,n,i],typeof a.ctx.listener.positionX!="undefined"?(a.ctx.listener.positionX.setTargetAtTime(a._pos[0],Howler.ctx.currentTime,.1),a.ctx.listener.positionY.setTargetAtTime(a._pos[1],Howler.ctx.currentTime,.1),a.ctx.listener.positionZ.setTargetAtTime(a._pos[2],Howler.ctx.currentTime,.1)):a.ctx.listener.setPosition(a._pos[0],a._pos[1],a._pos[2]);else return a._pos;return a},HowlerGlobal.prototype.orientation=function(e,n,i,a,s,f){var c=this;if(!c.ctx||!c.ctx.listener)return c;var _=c._orientation;if(n=typeof n!="number"?_[1]:n,i=typeof i!="number"?_[2]:i,a=typeof a!="number"?_[3]:a,s=typeof s!="number"?_[4]:s,f=typeof f!="number"?_[5]:f,typeof e=="number")c._orientation=[e,n,i,a,s,f],typeof c.ctx.listener.forwardX!="undefined"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,n,i,a,s,f);else return _;return c},Howl.prototype.init=function(e){return function(n){var i=this;return i._orientation=n.orientation||[1,0,0],i._stereo=n.stereo||null,i._pos=n.pos||null,i._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle!="undefined"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle!="undefined"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain!="undefined"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel!="undefined"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance!="undefined"?n.maxDistance:1e4,panningModel:typeof n.panningModel!="undefined"?n.panningModel:"HRTF",refDistance:typeof n.refDistance!="undefined"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor!="undefined"?n.rolloffFactor:1},i._onstereo=n.onstereo?[{fn:n.onstereo}]:[],i._onpos=n.onpos?[{fn:n.onpos}]:[],i._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var a=typeof Howler.ctx.createStereoPanner=="undefined"?"spatial":"stereo";if(typeof n=="undefined")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var s=i._getSoundIds(n),f=0;f<s.length;f++){var c=i._soundById(s[f]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&t(c,a),a==="spatial"?typeof c._panner.positionX!="undefined"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",c._id);else return c._stereo}return i},Howl.prototype.pos=function(e,n,i,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(e,n,i,a)}}),s;if(n=typeof n!="number"?0:n,i=typeof i!="number"?-.5:i,typeof a=="undefined")if(typeof e=="number")s._pos=[e,n,i];else return s._pos;for(var f=s._getSoundIds(a),c=0;c<f.length;c++){var _=s._soundById(f[c]);if(_)if(typeof e=="number")_._pos=[e,n,i],_._node&&((!_._panner||_._panner.pan)&&t(_,"spatial"),typeof _._panner.positionX!="undefined"?(_._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),_._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),_._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):_._panner.setPosition(e,n,i)),s._emit("pos",_._id);else return _._pos}return s},Howl.prototype.orientation=function(e,n,i,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(e,n,i,a)}}),s;if(n=typeof n!="number"?s._orientation[1]:n,i=typeof i!="number"?s._orientation[2]:i,typeof a=="undefined")if(typeof e=="number")s._orientation=[e,n,i];else return s._orientation;for(var f=s._getSoundIds(a),c=0;c<f.length;c++){var _=s._soundById(f[c]);if(_)if(typeof e=="number")_._orientation=[e,n,i],_._node&&(_._panner||(_._pos||(_._pos=s._pos||[0,0,-.5]),t(_,"spatial")),typeof _._panner.orientationX!="undefined"?(_._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),_._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),_._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):_._panner.setOrientation(e,n,i)),s._emit("orientation",_._id);else return _._orientation}return s},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,i,a,s;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")i=n[0],typeof a=="undefined"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle!="undefined"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle!="undefined"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain!="undefined"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel!="undefined"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance!="undefined"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance!="undefined"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor!="undefined"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel!="undefined"?i.pannerAttr.panningModel:e._panningModel});else return s=e._soundById(parseInt(n[0],10)),s?s._pannerAttr:e._pannerAttr;else n.length===2&&(i=n[0],a=parseInt(n[1],10));for(var f=e._getSoundIds(a),c=0;c<f.length;c++)if(s=e._soundById(f[c]),s){var _=s._pannerAttr;_={coneInnerAngle:typeof i.coneInnerAngle!="undefined"?i.coneInnerAngle:_.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle!="undefined"?i.coneOuterAngle:_.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain!="undefined"?i.coneOuterGain:_.coneOuterGain,distanceModel:typeof i.distanceModel!="undefined"?i.distanceModel:_.distanceModel,maxDistance:typeof i.maxDistance!="undefined"?i.maxDistance:_.maxDistance,refDistance:typeof i.refDistance!="undefined"?i.refDistance:_.refDistance,rolloffFactor:typeof i.rolloffFactor!="undefined"?i.rolloffFactor:_.rolloffFactor,panningModel:typeof i.panningModel!="undefined"?i.panningModel:_.panningModel};var v=s._panner;v?(v.coneInnerAngle=_.coneInnerAngle,v.coneOuterAngle=_.coneOuterAngle,v.coneOuterGain=_.coneOuterGain,v.distanceModel=_.distanceModel,v.maxDistance=_.maxDistance,v.refDistance=_.refDistance,v.rolloffFactor=_.rolloffFactor,v.panningModel=_.panningModel):(s._pos||(s._pos=e._pos||[0,0,-.5]),t(s,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var n=this,i=n._parent;n._orientation=i._orientation,n._stereo=i._stereo,n._pos=i._pos,n._pannerAttr=i._pannerAttr,e.call(this),n._stereo?i.stereo(n._stereo):n._pos&&i.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,i=n._parent;return n._orientation=i._orientation,n._stereo=i._stereo,n._pos=i._pos,n._pannerAttr=i._pannerAttr,n._stereo?i.stereo(n._stereo):n._pos?i.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,i._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX!="undefined"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX!="undefined"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(Pt);function Oi(l,t,e){let{soundFile:n=!1}=t,i=!1,a={};const s=()=>{a&&a.playing&&(a.stop(),a.unload(),a={})};return It(async()=>{s()}),l.$$set=f=>{"soundFile"in f&&e(0,n=f.soundFile)},l.$$.update=()=>{l.$$.dirty&3&&n&&(e(1,i="https://cdn.sanity.io/files/58ueii0w/production/"+J(n,"asset._ref","").replace("file-","").replace("-mp3",".mp3")),s(),a=new Pt.Howl({src:[i],loop:!0,autoplay:!0}))},[n,i]}class Di extends Y{constructor(t){super(),W(this,t,Oi,null,Z,{soundFile:0})}}function tt(l){let t,e;return{c(){t=T("img"),this.h()},l(n){t=I(n,"IMG",{src:!0}),this.h()},h(){X(t.src,e=ce(l[0].iconImage).quality(100).height(100).url())||g(t,"src",e)},m(n,i){$(n,t,i)},p(n,i){i&1&&!X(t.src,e=ce(n[0].iconImage).quality(100).height(100).url())&&g(t,"src",e)},d(n){n&&y(t)}}}function ji(l){let t,e,n,i,a,s=l[0].iconImage&&tt(l);return{c(){t=T("div"),s&&s.c(),this.h()},l(f){t=I(f,"DIV",{class:!0,id:!0,alt:!0,style:!0});var c=D(t);s&&s.l(c),c.forEach(y),this.h()},h(){g(t,"class","portal svelte-1ulo7kp"),g(t,"id",e=l[0]._id),g(t,"alt",n=l[0].title),g(t,"style",l[2])},m(f,c){$(f,t,c),s&&s.m(t,null),l[5](t),a=!0},p(f,[c]){f[0].iconImage?s?s.p(f,c):(s=tt(f),s.c(),s.m(t,null)):s&&(s.d(1),s=null),(!a||c&1&&e!==(e=f[0]._id))&&g(t,"id",e),(!a||c&1&&n!==(n=f[0].title))&&g(t,"alt",n)},i(f){a||(le(()=>{i||(i=te(t,x,{},!0)),i.run(1)}),a=!0)},o(f){i||(i=te(t,x,{},!1)),i.run(0),a=!1},d(f){f&&y(t),s&&s.d(),l[5](null),f&&i&&i.end()}}}function Vi(l,t,e){let n;z(l,ge,r=>e(4,n=r));let{portal:i={}}=t,a={},s={},f=i.y*ee,c=i.x*ee;const _=`transform: translateY(${f}px) translateX(${c}px); width: ${ee}px; height: ${ee}px; background-color: ${J(i,"backgroundColor.hex","")}; background-image: url("${J(i,"bgImageUrl","")}");"`;me(async()=>{e(3,s=tippy(a,{content:"door to "+J(i,"targetArea.title",""),arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,sticky:!0,trigger:"manual",flip:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}))});function v(r){ve[r?"unshift":"push"](()=>{a=r,e(1,a)})}return l.$$set=r=>{"portal"in r&&e(0,i=r.portal)},l.$$.update=()=>{l.$$.dirty&24&&s.popper&&(n?s.show():s.hide())},[i,a,_,s,n,v]}class Mi extends Y{constructor(t){super(),W(this,t,Vi,ji,Z,{portal:0})}}function rt(l,t,e){const n=l.slice();return n[1]=t[e],n}function nt(l,t){let e,n,i;return n=new Mi({props:{portal:t[1]}}),{key:l,first:null,c(){e=P(),G(n.$$.fragment),this.h()},l(a){e=P(),R(n.$$.fragment,a),this.h()},h(){this.first=e},m(a,s){$(a,e,s),C(n,a,s),i=!0},p(a,s){t=a;const f={};s&1&&(f.portal=t[1]),n.$set(f)},i(a){i||(k(n.$$.fragment,a),i=!0)},o(a){O(n.$$.fragment,a),i=!1},d(a){a&&y(e),q(n,a)}}}function Pi(l){let t=[],e=new Map,n,i,a=l[0];const s=f=>f[1]._id;for(let f=0;f<a.length;f+=1){let c=rt(l,a,f),_=s(c);e.set(_,t[f]=nt(_,c))}return{c(){for(let f=0;f<t.length;f+=1)t[f].c();n=P()},l(f){for(let c=0;c<t.length;c+=1)t[c].l(f);n=P()},m(f,c){for(let _=0;_<t.length;_+=1)t[_].m(f,c);$(f,n,c),i=!0},p(f,[c]){c&1&&(a=f[0],N(),t=Ae(t,c,s,1,f,a,e,n.parentNode,ke,nt,n,rt),U())},i(f){if(!i){for(let c=0;c<a.length;c+=1)k(t[c]);i=!0}},o(f){for(let c=0;c<t.length;c+=1)O(t[c]);i=!1},d(f){for(let c=0;c<t.length;c+=1)t[c].d(f);f&&y(n)}}}function Bi(l,t,e){let{portals:n={}}=t;return l.$$set=i=>{"portals"in i&&e(0,n=i.portals)},[n]}class Fi extends Y{constructor(t){super(),W(this,t,Bi,Pi,Z,{portals:0})}}function Li(l){let t,e,n;return{c(){t=T("div"),e=T("iframe"),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);e=I(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,color:!0,allow:!0,sandbox:!0,class:!0}),D(e).forEach(y),a.forEach(y),this.h()},h(){g(e,"width","720"),g(e,"height","480"),X(e.src,n=l[0])||g(e,"src",n),g(e,"frameborder","no"),g(e,"color","#ffffff"),g(e,"allow","autoplay; fullscreen"),g(e,"sandbox","allow-same-origin allow-scripts allow-popups"),e.allowFullscreen=!0,g(e,"class","svelte-ldmhir"),g(t,"class","peertube-container svelte-ldmhir")},m(i,a){$(i,t,a),E(t,e)},p(i,a){a&1&&!X(e.src,n=i[0])&&g(e,"src",n)},d(i){i&&y(t)}}}function Hi(l){let t,e,n;return{c(){t=T("div"),e=T("iframe"),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);e=I(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,scrolling:!0,byline:!0,color:!0,allow:!0,class:!0}),D(e).forEach(y),a.forEach(y),this.h()},h(){g(e,"width","720"),g(e,"height","480"),X(e.src,n="https://player.vimeo.com/video/"+_e(l[0]).id+"?autoplay=1")||g(e,"src",n),g(e,"frameborder","no"),g(e,"scrolling","no"),g(e,"byline","false"),g(e,"color","#ffffff"),g(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,g(e,"class","svelte-ldmhir"),g(t,"class","vimeo-container svelte-ldmhir")},m(i,a){$(i,t,a),E(t,e)},p(i,a){a&1&&!X(e.src,n="https://player.vimeo.com/video/"+_e(i[0]).id+"?autoplay=1")&&g(e,"src",n)},d(i){i&&y(t)}}}function Gi(l){let t,e,n;return{c(){t=T("div"),e=T("iframe"),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);e=I(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,allow:!0,class:!0}),D(e).forEach(y),a.forEach(y),this.h()},h(){g(e,"width","1920"),g(e,"height","1280"),X(e.src,n="https://www.youtube.com/embed/"+_e(l[0]).id+"?autoplay=1&rel=0&color=white")||g(e,"src",n),g(e,"frameborder","no"),g(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,g(e,"class","svelte-ldmhir"),g(t,"class","youtube-container svelte-ldmhir")},m(i,a){$(i,t,a),E(t,e)},p(i,a){a&1&&!X(e.src,n="https://www.youtube.com/embed/"+_e(i[0]).id+"?autoplay=1&rel=0&color=white")&&g(e,"src",n)},d(i){i&&y(t)}}}function Ri(l){let t,e,n,i,a,s,f;function c(r,o){if(o&1&&(n=null),o&1&&(i=null),o&1&&(a=null),n==null&&(n=!!(r[0].includes("youtube")||r[0].includes("youtu.be"))),n)return Gi;if(i==null&&(i=!!r[0].includes("vimeo")),i)return Hi;if(a==null&&(a=!!r[0].includes("undersco.re")),a)return Li}let _=c(l,-1),v=_&&_(l);return{c(){t=T("div"),e=T("div"),v&&v.c(),this.h()},l(r){t=I(r,"DIV",{class:!0});var o=D(t);e=I(o,"DIV",{class:!0});var u=D(e);v&&v.l(u),u.forEach(y),o.forEach(y),this.h()},h(){g(e,"class","embed svelte-ldmhir"),g(t,"class","stream-container svelte-ldmhir")},m(r,o){$(r,t,o),E(t,e),v&&v.m(e,null),f=!0},p(r,[o]){l=r,_===(_=c(l,o))&&v?v.p(l,o):(v&&v.d(1),v=_&&_(l),v&&(v.c(),v.m(e,null)))},i(r){f||(le(()=>{s||(s=te(t,x,{duration:300,easing:$e},!0)),s.run(1)}),f=!0)},o(r){s||(s=te(t,x,{duration:300,easing:$e},!1)),s.run(0),f=!1},d(r){r&&y(t),v&&v.d(),r&&s&&s.end()}}}function Ci(l,t,e){let{streamUrl:n=""}=t;return l.$$set=i=>{"streamUrl"in i&&e(0,n=i.streamUrl)},[n]}class qi extends Y{constructor(t){super(),W(this,t,Ci,Ri,Z,{streamUrl:0})}}function Ni(l){let t,e,n;return{c(){t=T("div"),e=T("iframe"),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);e=I(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,color:!0,allow:!0,sandbox:!0,class:!0}),D(e).forEach(y),a.forEach(y),this.h()},h(){g(e,"width","720"),g(e,"height","480"),X(e.src,n=l[0])||g(e,"src",n),g(e,"frameborder","no"),g(e,"color","#ffffff"),g(e,"allow","autoplay; fullscreen"),g(e,"sandbox","allow-same-origin allow-scripts allow-popups"),e.allowFullscreen=!0,g(e,"class","svelte-174tb22"),g(t,"class","peertube-container svelte-174tb22")},m(i,a){$(i,t,a),E(t,e)},p(i,a){a&1&&!X(e.src,n=i[0])&&g(e,"src",n)},d(i){i&&y(t)}}}function Ui(l){let t,e,n;return{c(){t=T("div"),e=T("iframe"),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);e=I(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,scrolling:!0,byline:!0,color:!0,allow:!0,class:!0}),D(e).forEach(y),a.forEach(y),this.h()},h(){g(e,"width","720"),g(e,"height","480"),X(e.src,n="https://player.vimeo.com/video/"+_e(l[0]).id)||g(e,"src",n),g(e,"frameborder","no"),g(e,"scrolling","no"),g(e,"byline","false"),g(e,"color","#ffffff"),g(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,g(e,"class","svelte-174tb22"),g(t,"class","vimeo-container svelte-174tb22")},m(i,a){$(i,t,a),E(t,e)},p(i,a){a&1&&!X(e.src,n="https://player.vimeo.com/video/"+_e(i[0]).id)&&g(e,"src",n)},d(i){i&&y(t)}}}function Xi(l){let t,e,n;return{c(){t=T("div"),e=T("iframe"),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);e=I(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,allow:!0,class:!0}),D(e).forEach(y),a.forEach(y),this.h()},h(){g(e,"width","1920"),g(e,"height","1280"),X(e.src,n="https://www.youtube.com/embed/"+_e(l[0]).id+"?rel=0&color=white")||g(e,"src",n),g(e,"frameborder","no"),g(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,g(e,"class","svelte-174tb22"),g(t,"class","youtube-container svelte-174tb22")},m(i,a){$(i,t,a),E(t,e)},p(i,a){a&1&&!X(e.src,n="https://www.youtube.com/embed/"+_e(i[0]).id+"?rel=0&color=white")&&g(e,"src",n)},d(i){i&&y(t)}}}function Yi(l){let t,e,n,i,a,s;function f(v,r){if(r&1&&(n=null),r&1&&(i=null),r&1&&(a=null),n==null&&(n=!!(v[0].includes("youtube")||v[0].includes("youtu.be"))),n)return Xi;if(i==null&&(i=!!v[0].includes("vimeo")),i)return Ui;if(a==null&&(a=!!v[0].includes("undersco.re")),a)return Ni}let c=f(l,-1),_=c&&c(l);return{c(){t=T("div"),e=T("div"),_&&_.c(),this.h()},l(v){t=I(v,"DIV",{class:!0});var r=D(t);e=I(r,"DIV",{class:!0});var o=D(e);_&&_.l(o),o.forEach(y),r.forEach(y),this.h()},h(){g(e,"class","embed svelte-174tb22"),g(t,"class","stream-container svelte-174tb22")},m(v,r){$(v,t,r),E(t,e),_&&_.m(e,null)},p(v,[r]){l=v,c===(c=f(l,r))&&_?_.p(l,r):(_&&_.d(1),_=c&&c(l),_&&(_.c(),_.m(e,null)))},i(v){s||le(()=>{s=Te(t,x,{duration:300,easing:$e}),s.start()})},o:ae,d(v){v&&y(t),_&&_.d()}}}function Wi(l,t,e){let{streamUrl:n=""}=t;return l.$$set=i=>{"streamUrl"in i&&e(0,n=i.streamUrl)},[n]}class Zi extends Y{constructor(t){super(),W(this,t,Wi,Yi,Z,{streamUrl:0})}}function it(l){let t,e,n,i,a,s,f,c=He(l[1].startDate)+"",_,v,r,o=l[1].title+"",u,p,b=se(l[1],"content.content"),m,d=b&&at(l);return{c(){t=T("div"),e=T("img"),a=B(),s=T("div"),f=T("div"),_=K(c),v=B(),r=T("div"),u=K(o),p=B(),d&&d.c(),this.h()},l(h){t=I(h,"DIV",{class:!0});var A=D(t);e=I(A,"IMG",{class:!0,alt:!0,src:!0}),A.forEach(y),a=F(h),s=I(h,"DIV",{class:!0});var j=D(s);f=I(j,"DIV",{class:!0});var w=D(f);_=Q(w,c),w.forEach(y),v=F(j),r=I(j,"DIV",{class:!0});var S=D(r);u=Q(S,o),S.forEach(y),p=F(j),d&&d.l(j),j.forEach(y),this.h()},h(){g(e,"class","image svelte-1unfe15"),g(e,"alt",n=l[1].title),X(e.src,i=l[0].importEvent?Le(l[1].mainImage).quality(90).width(500).height(500).url():ce(l[1].mainImage).quality(90).width(500).height(500).url())||g(e,"src",i),g(t,"class","image-container svelte-1unfe15"),g(f,"class","date svelte-1unfe15"),g(r,"class","title svelte-1unfe15"),g(s,"class","text-container svelte-1unfe15")},m(h,A){$(h,t,A),E(t,e),$(h,a,A),$(h,s,A),E(s,f),E(f,_),E(s,v),E(s,r),E(r,u),E(s,p),d&&d.m(s,null),m=!0},p(h,A){(!m||A&2&&n!==(n=h[1].title))&&g(e,"alt",n),(!m||A&3&&!X(e.src,i=h[0].importEvent?Le(h[1].mainImage).quality(90).width(500).height(500).url():ce(h[1].mainImage).quality(90).width(500).height(500).url()))&&g(e,"src",i),(!m||A&2)&&c!==(c=He(h[1].startDate)+"")&&ue(_,c),(!m||A&2)&&o!==(o=h[1].title+"")&&ue(u,o),A&2&&(b=se(h[1],"content.content")),b?d?(d.p(h,A),A&2&&k(d,1)):(d=at(h),d.c(),k(d,1),d.m(s,null)):d&&(N(),O(d,1,1,()=>{d=null}),U())},i(h){m||(k(d),m=!0)},o(h){O(d),m=!1},d(h){h&&y(t),h&&y(a),h&&y(s),d&&d.d()}}}function at(l){let t,e,n;return e=new Ve({props:{blocks:l[1].content.content,mainSite:l[0].importEvent}}),{c(){t=T("div"),G(e.$$.fragment),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);R(e.$$.fragment,a),a.forEach(y),this.h()},h(){g(t,"class","description")},m(i,a){$(i,t,a),C(e,t,null),n=!0},p(i,a){const s={};a&2&&(s.blocks=i[1].content.content),a&1&&(s.mainSite=i[0].importEvent),e.$set(s)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){O(e.$$.fragment,i),n=!1},d(i){i&&y(t),q(e)}}}function Ki(l){let t,e,n=l[1]&&it(l);return{c(){t=T("div"),n&&n.c(),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);n&&n.l(a),a.forEach(y),this.h()},h(){g(t,"class","event svelte-1unfe15")},m(i,a){$(i,t,a),n&&n.m(t,null),e=!0},p(i,[a]){i[1]?n?(n.p(i,a),a&2&&k(n,1)):(n=it(i),n.c(),k(n,1),n.m(t,null)):n&&(N(),O(n,1,1,()=>{n=null}),U())},i(i){e||(k(n),e=!0)},o(i){O(n),e=!1},d(i){i&&y(t),n&&n.d()}}}function Qi(l,t,e){let{event:n={}}=t,i=!1;return me(async()=>{n.importEvent?e(1,i=await Dt("*[_id == '"+n.importedEvent+"'][0]")):e(1,i=n)}),l.$$set=a=>{"event"in a&&e(0,n=a.event)},[n,i]}class xi extends Y{constructor(t){super(),W(this,t,Qi,Ki,Z,{event:0})}}function ot(l,t,e){const n=l.slice();return n[7]=t[e],n}function lt(l){let t,e;return{c(){t=T("div"),e=K(l[1]),this.h()},l(n){t=I(n,"DIV",{class:!0});var i=D(t);e=Q(i,l[1]),i.forEach(y),this.h()},h(){g(t,"class","viewer-count svelte-1ncn684")},m(n,i){$(n,t,i),E(t,e)},p(n,i){i&2&&ue(e,n[1])},d(n){n&&y(t)}}}function zi(l){let t,e,n,i,a,s,f,c,_,v,r,o,u=l[0].events,p=[];for(let m=0;m<u.length;m+=1)p[m]=st(ot(l,u,m));const b=m=>O(p[m],1,1,()=>{p[m]=null});return{c(){t=T("div"),e=T("div"),n=T("h1"),i=K("Welcome to the Bulletin Board"),a=B(),s=T("div"),f=T("div"),c=K("Subscribe to Calendar"),_=B(),v=T("div");for(let m=0;m<p.length;m+=1)p[m].c();this.h()},l(m){t=I(m,"DIV",{class:!0});var d=D(t);e=I(d,"DIV",{class:!0});var h=D(e);n=I(h,"H1",{});var A=D(n);i=Q(A,"Welcome to the Bulletin Board"),A.forEach(y),a=F(h),s=I(h,"DIV",{class:!0});var j=D(s);f=I(j,"DIV",{class:!0});var w=D(f);c=Q(w,"Subscribe to Calendar"),w.forEach(y),j.forEach(y),_=F(h),v=I(h,"DIV",{class:!0});var S=D(v);for(let M=0;M<p.length;M+=1)p[M].l(S);S.forEach(y),h.forEach(y),d.forEach(y),this.h()},h(){g(f,"class","action svelte-1ncn684"),g(s,"class","bulletin-board-actions svelte-1ncn684"),g(v,"class","bulletin-board-events"),g(e,"class","inner svelte-1ncn684"),g(t,"class","bulletin-board svelte-1ncn684"),ie(t,"pushed",l[3])},m(m,d){$(m,t,d),E(t,e),E(e,n),E(n,i),E(e,a),E(e,s),E(s,f),E(f,c),E(e,_),E(e,v);for(let h=0;h<p.length;h+=1)p[h].m(v,null);o=!0},p(m,d){if(d&1){u=m[0].events;let h;for(h=0;h<u.length;h+=1){const A=ot(m,u,h);p[h]?(p[h].p(A,d),k(p[h],1)):(p[h]=st(A),p[h].c(),k(p[h],1),p[h].m(v,null))}for(N(),h=u.length;h<p.length;h+=1)b(h);U()}d&8&&ie(t,"pushed",m[3])},i(m){if(!o){for(let d=0;d<u.length;d+=1)k(p[d]);le(()=>{r||(r=te(t,x,{},!0)),r.run(1)}),o=!0}},o(m){p=p.filter(Boolean);for(let d=0;d<p.length;d+=1)O(p[d]);r||(r=te(t,x,{},!1)),r.run(0),o=!1},d(m){m&&y(t),$t(p,m),m&&r&&r.end()}}}function Ji(l){let t,e,n,i,a=l[2]&&l[2].title&&ft(l);return{c(){t=T("div"),e=T("div"),a&&a.c(),this.h()},l(s){t=I(s,"DIV",{class:!0});var f=D(t);e=I(f,"DIV",{class:!0});var c=D(e);a&&a.l(c),c.forEach(y),f.forEach(y),this.h()},h(){g(e,"class","inner svelte-1ncn684"),g(t,"class","article svelte-1ncn684"),ie(t,"pushed",l[3])},m(s,f){$(s,t,f),E(t,e),a&&a.m(e,null),i=!0},p(s,f){s[2]&&s[2].title?a?(a.p(s,f),f&4&&k(a,1)):(a=ft(s),a.c(),k(a,1),a.m(e,null)):a&&(N(),O(a,1,1,()=>{a=null}),U()),f&8&&ie(t,"pushed",s[3])},i(s){i||(k(a),le(()=>{n||(n=te(t,x,{},!0)),n.run(1)}),i=!0)},o(s){O(a),n||(n=te(t,x,{},!1)),n.run(0),i=!1},d(s){s&&y(t),a&&a.d(),s&&n&&n.end()}}}function ea(l){let t=se(l[0],"content.content"),e,n,i=t&&ct(l);return{c(){i&&i.c(),e=P()},l(a){i&&i.l(a),e=P()},m(a,s){i&&i.m(a,s),$(a,e,s),n=!0},p(a,s){s&1&&(t=se(a[0],"content.content")),t?i?(i.p(a,s),s&1&&k(i,1)):(i=ct(a),i.c(),k(i,1),i.m(e.parentNode,e)):i&&(N(),O(i,1,1,()=>{i=null}),U())},i(a){n||(k(i),n=!0)},o(a){O(i),n=!1},d(a){i&&i.d(a),a&&y(e)}}}function ta(l){let t,e,n,i;return e=new Zi({props:{streamUrl:l[0].videoUrl}}),{c(){t=T("div"),G(e.$$.fragment),this.h()},l(a){t=I(a,"DIV",{class:!0});var s=D(t);R(e.$$.fragment,s),s.forEach(y),this.h()},h(){g(t,"class","video svelte-1ncn684"),ie(t,"pushed",l[3])},m(a,s){$(a,t,s),C(e,t,null),i=!0},p(a,s){const f={};s&1&&(f.streamUrl=a[0].videoUrl),e.$set(f),s&8&&ie(t,"pushed",a[3])},i(a){i||(k(e.$$.fragment,a),le(()=>{n||(n=te(t,x,{},!0)),n.run(1)}),i=!0)},o(a){O(e.$$.fragment,a),n||(n=te(t,x,{},!1)),n.run(0),i=!1},d(a){a&&y(t),q(e),a&&n&&n.end()}}}function st(l){let t,e;return t=new xi({props:{event:l[7]}}),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&1&&(a.event=n[7]),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function ft(l){let t=l[2].title+"",e,n,i=se(l[2],"content.content"),a,s,f=i&&ut(l);return{c(){e=K(t),n=B(),f&&f.c(),a=P()},l(c){e=Q(c,t),n=F(c),f&&f.l(c),a=P()},m(c,_){$(c,e,_),$(c,n,_),f&&f.m(c,_),$(c,a,_),s=!0},p(c,_){(!s||_&4)&&t!==(t=c[2].title+"")&&ue(e,t),_&4&&(i=se(c[2],"content.content")),i?f?(f.p(c,_),_&4&&k(f,1)):(f=ut(c),f.c(),k(f,1),f.m(a.parentNode,a)):f&&(N(),O(f,1,1,()=>{f=null}),U())},i(c){s||(k(f),s=!0)},o(c){O(f),s=!1},d(c){c&&y(e),c&&y(n),f&&f.d(c),c&&y(a)}}}function ut(l){let t,e;return t=new Ve({props:{blocks:l[2].content.content,mainSite:!0}}),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&4&&(a.blocks=n[2].content.content),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function ct(l){let t,e,n,i,a;return n=new Ve({props:{blocks:l[0].content.content}}),{c(){t=T("div"),e=T("div"),G(n.$$.fragment),this.h()},l(s){t=I(s,"DIV",{class:!0});var f=D(t);e=I(f,"DIV",{class:!0});var c=D(e);R(n.$$.fragment,c),c.forEach(y),f.forEach(y),this.h()},h(){g(e,"class","inner svelte-1ncn684"),g(t,"class","article svelte-1ncn684"),ie(t,"pushed",l[3])},m(s,f){$(s,t,f),E(t,e),C(n,e,null),a=!0},p(s,f){const c={};f&1&&(c.blocks=s[0].content.content),n.$set(c),f&8&&ie(t,"pushed",s[3])},i(s){a||(k(n.$$.fragment,s),le(()=>{i||(i=te(t,x,{},!0)),i.run(1)}),a=!0)},o(s){O(n.$$.fragment,s),i||(i=te(t,x,{},!1)),i.run(0),a=!1},d(s){s&&y(t),q(n),s&&i&&i.end()}}}function _t(l){let t,e=l[0].infoText+"",n;return{c(){t=T("div"),n=K(e),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);n=Q(a,e),a.forEach(y),this.h()},h(){g(t,"class","info-text svelte-1ncn684")},m(i,a){$(i,t,a),E(t,n)},p(i,a){a&1&&e!==(e=i[0].infoText+"")&&ue(n,e)},d(i){i&&y(t)}}}function ra(l){let t,e,n,i,a,s,f,c,_,v,r,o=l[0].contentType==="video"&&lt(l);const u=[ta,ea,Ji,zi],p=[];function b(d,h){return d[0].contentType==="video"?0:d[0].contentType==="text"?1:d[0].contentType==="importedPost"?2:d[0].isBulletinBoard?3:-1}~(a=b(l))&&(s=p[a]=u[a](l));let m=l[0].infoText&&_t(l);return{c(){o&&o.c(),t=B(),e=T("div"),n=K("Return"),i=B(),s&&s.c(),f=B(),m&&m.c(),c=P(),this.h()},l(d){o&&o.l(d),t=F(d),e=I(d,"DIV",{class:!0});var h=D(e);n=Q(h,"Return"),h.forEach(y),i=F(d),s&&s.l(d),f=F(d),m&&m.l(d),c=P(),this.h()},h(){g(e,"class","return-button svelte-1ncn684")},m(d,h){o&&o.m(d,h),$(d,t,h),$(d,e,h),E(e,n),$(d,i,h),~a&&p[a].m(d,h),$(d,f,h),m&&m.m(d,h),$(d,c,h),_=!0,v||(r=ne(e,"click",l[6]),v=!0)},p(d,[h]){d[0].contentType==="video"?o?o.p(d,h):(o=lt(d),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null);let A=a;a=b(d),a===A?~a&&p[a].p(d,h):(s&&(N(),O(p[A],1,1,()=>{p[A]=null}),U()),~a?(s=p[a],s?s.p(d,h):(s=p[a]=u[a](d),s.c()),k(s,1),s.m(f.parentNode,f)):s=null),d[0].infoText?m?m.p(d,h):(m=_t(d),m.c(),m.m(c.parentNode,c)):m&&(m.d(1),m=null)},i(d){_||(k(s),_=!0)},o(d){O(s),_=!1},d(d){o&&o.d(d),d&&y(t),d&&y(e),d&&y(i),~a&&p[a].d(d),d&&y(f),m&&m.d(d),d&&y(c),v=!1,r()}}}function na(l,t,e){let n,i;z(l,jt,v=>e(5,n=v)),z(l,Vt,v=>e(3,i=v));let{article:a={}}=t,s=0,f="",c;me(async()=>{Qt(a),a.contentType==="importedPost"&&a.importedPost&&e(2,c=await Dt("*[_id == '"+a.importedPost+"'][0]"))}),It(async()=>{xt()});const _=()=>{Ee.set(!1)};return l.$$set=v=>{"article"in v&&e(0,a=v.article)},l.$$.update=()=>{if(l.$$.dirty&49){e(4,s=0);for(const[v,r]of Object.entries(n))r.viewing===a._id&&e(4,s++,s)}l.$$.dirty&16&&e(1,f=s===1?"You are the only one here.":`${s} people are here.`)},[a,f,c,i,s,n,_]}class ia extends Y{constructor(t){super(),W(this,t,na,ra,Z,{article:0})}}function aa(l){let t,e,n,i,a,s,f,c,_,v,r,o,u,p,b,m;return{c(){t=T("div"),e=T("div"),n=K(l[0]),i=B(),a=T("div"),s=T("div"),f=T("div"),c=K("\u25B8"),_=K(`
      Yes`),v=B(),r=T("div"),o=T("div"),u=K("\u25B8"),p=K(`
      No`),this.h()},l(d){t=I(d,"DIV",{class:!0});var h=D(t);e=I(h,"DIV",{});var A=D(e);n=Q(A,l[0]),A.forEach(y),i=F(h),a=I(h,"DIV",{class:!0});var j=D(a);s=I(j,"DIV",{class:!0,tabindex:!0,autofocus:!0});var w=D(s);f=I(w,"DIV",{class:!0});var S=D(f);c=Q(S,"\u25B8"),S.forEach(y),_=Q(w,`
      Yes`),w.forEach(y),v=F(j),r=I(j,"DIV",{class:!0,tabindex:!0});var M=D(r);o=I(M,"DIV",{class:!0});var oe=D(o);u=Q(oe,"\u25B8"),oe.forEach(y),p=Q(M,`
      No`),M.forEach(y),j.forEach(y),h.forEach(y),this.h()},h(){g(f,"class","marker svelte-pi72xu"),g(s,"class","choice svelte-pi72xu"),g(s,"tabindex","0"),g(s,"autofocus",""),g(o,"class","marker svelte-pi72xu"),g(r,"class","choice svelte-pi72xu"),g(r,"tabindex","0"),g(a,"class","multiple-choice"),g(t,"class","room-dialog-box svelte-pi72xu")},m(d,h){$(d,t,h),E(t,e),E(e,n),E(t,i),E(t,a),E(a,s),E(s,f),E(f,c),E(s,_),E(a,v),E(a,r),E(r,o),E(o,u),E(r,p),s.focus(),b||(m=[ne(s,"click",l[3]),ne(s,"keydown",l[4]),ne(r,"click",l[5]),ne(r,"keydown",l[6])],b=!0)},p(d,[h]){h&1&&ue(n,d[0])},i:ae,o:ae,d(d){d&&y(t),b=!1,je(m)}}}function oa(l,t,e){const n=pe();let{text:i=""}=t,{roomId:a=""}=t;const s=v=>{n("room",{roomId:a})},f=v=>{v.code==="Enter"&&n("room",{roomId:a})},c=v=>{n("room",{roomId:!1})},_=v=>{v.code==="Enter"&&n("room",{roomId:!1})};return l.$$set=v=>{"text"in v&&e(0,i=v.text),"roomId"in v&&e(1,a=v.roomId)},[i,a,n,s,f,c,_]}class la extends Y{constructor(t){super(),W(this,t,oa,aa,Z,{text:0,roomId:1})}}function sa(l){let t,e,n,i;return e=new la({props:{text:`Go to ${l[1]}?`,roomId:l[0]}}),e.$on("room",l[3]),{c(){t=T("div"),G(e.$$.fragment),this.h()},l(a){t=I(a,"DIV",{class:!0});var s=D(t);R(e.$$.fragment,s),s.forEach(y),this.h()},h(){g(t,"class","caption-container svelte-ukizaq")},m(a,s){$(a,t,s),C(e,t,null),i=!0},p(a,[s]){const f={};s&2&&(f.text=`Go to ${a[1]}?`),s&1&&(f.roomId=a[0]),e.$set(f)},i(a){i||(k(e.$$.fragment,a),n||le(()=>{n=Te(t,x,{}),n.start()}),i=!0)},o(a){O(e.$$.fragment,a),i=!1},d(a){a&&y(t),q(e)}}}function fa(l,t,e){const n=pe();let{roomIntent:i=""}=t,{roomTitle:a=""}=t;const s=f=>{console.log(f),n("room",{roomId:f.detail.roomId})};return l.$$set=f=>{"roomIntent"in f&&e(0,i=f.roomIntent),"roomTitle"in f&&e(1,a=f.roomTitle)},[i,a,n,s]}class ua extends Y{constructor(t){super(),W(this,t,fa,sa,Z,{roomIntent:0,roomTitle:1})}}function ca(l){let t,e,n,i,a,s,f,c,_,v,r,o,u,p,b,m;return{c(){t=T("div"),e=T("div"),n=K(l[0]),i=B(),a=T("div"),s=T("div"),f=T("div"),c=K("\u25B8"),_=K(`
      Yes`),v=B(),r=T("div"),o=T("div"),u=K("\u25B8"),p=K(`
      No`),this.h()},l(d){t=I(d,"DIV",{class:!0});var h=D(t);e=I(h,"DIV",{});var A=D(e);n=Q(A,l[0]),A.forEach(y),i=F(h),a=I(h,"DIV",{class:!0});var j=D(a);s=I(j,"DIV",{class:!0,tabindex:!0,autofocus:!0});var w=D(s);f=I(w,"DIV",{class:!0});var S=D(f);c=Q(S,"\u25B8"),S.forEach(y),_=Q(w,`
      Yes`),w.forEach(y),v=F(j),r=I(j,"DIV",{class:!0,tabindex:!0});var M=D(r);o=I(M,"DIV",{class:!0});var oe=D(o);u=Q(oe,"\u25B8"),oe.forEach(y),p=Q(M,`
      No`),M.forEach(y),j.forEach(y),h.forEach(y),this.h()},h(){g(f,"class","marker svelte-13prx36"),g(s,"class","choice svelte-13prx36"),g(s,"tabindex","0"),g(s,"autofocus",""),g(o,"class","marker svelte-13prx36"),g(r,"class","choice svelte-13prx36"),g(r,"tabindex","0"),g(a,"class","multiple-choice"),g(t,"class","object-dialog-box svelte-13prx36")},m(d,h){$(d,t,h),E(t,e),E(e,n),E(t,i),E(t,a),E(a,s),E(s,f),E(f,c),E(s,_),E(a,v),E(a,r),E(r,o),E(o,u),E(r,p),s.focus(),b||(m=[ne(s,"click",l[3]),ne(s,"keydown",l[4]),ne(r,"click",l[5]),ne(r,"keydown",l[6])],b=!0)},p(d,[h]){h&1&&ue(n,d[0])},i:ae,o:ae,d(d){d&&y(t),b=!1,je(m)}}}function _a(l,t,e){const n=pe();let{text:i=""}=t,{objectId:a=""}=t;const s=v=>{n("object",{objectId:a})},f=v=>{v.code==="Enter"&&n("object",{objectId:a})},c=v=>{n("object",{objectId:!1})},_=v=>{v.code==="Enter"&&n("object",{objectId:!1})};return l.$$set=v=>{"text"in v&&e(0,i=v.text),"objectId"in v&&e(1,a=v.objectId)},[i,a,n,s,f,c,_]}class da extends Y{constructor(t){super(),W(this,t,_a,ca,Z,{text:0,objectId:1})}}function pa(l){let t,e,n,i,a,s;return i=new da({props:{text:`Look at ${l[1]}?`,objectId:l[0]}}),i.$on("object",l[3]),{c(){t=T("div"),e=K(l[1]),n=B(),G(i.$$.fragment),this.h()},l(f){t=I(f,"DIV",{class:!0});var c=D(t);e=Q(c,l[1]),n=F(c),R(i.$$.fragment,c),c.forEach(y),this.h()},h(){g(t,"class","caption-container svelte-ukizaq")},m(f,c){$(f,t,c),E(t,e),E(t,n),C(i,t,null),s=!0},p(f,[c]){(!s||c&2)&&ue(e,f[1]);const _={};c&2&&(_.text=`Look at ${f[1]}?`),c&1&&(_.objectId=f[0]),i.$set(_)},i(f){s||(k(i.$$.fragment,f),a||le(()=>{a=Te(t,x,{}),a.start()}),s=!0)},o(f){O(i.$$.fragment,f),s=!1},d(f){f&&y(t),q(i)}}}function ma(l,t,e){const n=pe();let{objectIntent:i=""}=t,{objectTitle:a=""}=t;const s=f=>{n("object",{objectId:f.detail.objectId})};return l.$$set=f=>{"objectIntent"in f&&e(0,i=f.objectIntent),"objectTitle"in f&&e(1,a=f.objectTitle)},[i,a,n,s]}class va extends Y{constructor(t){super(),W(this,t,ma,pa,Z,{objectIntent:0,objectTitle:1})}}function ha(l){let t,e;return{c(){t=Me("svg"),e=Me("path"),this.h()},l(n){t=Pe(n,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0,class:!0});var i=D(t);e=Pe(i,"path",{d:!0,class:!0}),D(e).forEach(y),i.forEach(y),this.h()},h(){g(e,"d","M4.8474 7.78418L0.703963 0.607532L8.99084 0.607531L4.8474 7.78418Z"),g(e,"class","svelte-fiesz8"),g(t,"width","9"),g(t,"height","8"),g(t,"viewBox","0 0 9 8"),g(t,"fill","none"),g(t,"xmlns","http://www.w3.org/2000/svg"),g(t,"class","svelte-fiesz8")},m(n,i){$(n,t,i),E(t,e)},p:ae,i:ae,o:ae,d(n){n&&y(t)}}}class ga extends Y{constructor(t){super(),W(this,t,null,ha,Z,{})}}function dt(l){let t,e,n,i,a;return e=new ga({}),{c(){t=T("div"),G(e.$$.fragment),this.h()},l(s){t=I(s,"DIV",{class:!0});var f=D(t);R(e.$$.fragment,f),f.forEach(y),this.h()},h(){g(t,"class","next-caption svelte-10yrac0")},m(s,f){$(s,t,f),C(e,t,null),n=!0,i||(a=ne(t,"click",l[6]),i=!0)},p:ae,i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){O(e.$$.fragment,s),n=!1},d(s){s&&y(t),q(e),i=!1,a()}}}function ba(l){let t,e,n=Ge(l[2].text.content)+"",i,a,s,f,c,_,v=l[1]<l[0].length-1&&dt(l);return{c(){t=T("div"),e=T("div"),s=B(),v&&v.c(),this.h()},l(r){t=I(r,"DIV",{class:!0});var o=D(t);e=I(o,"DIV",{class:!0});var u=D(e);u.forEach(y),s=F(o),v&&v.l(o),o.forEach(y),this.h()},h(){g(e,"class","caption-box svelte-10yrac0"),g(t,"class","caption-container svelte-10yrac0")},m(r,o){$(r,t,o),E(t,e),e.innerHTML=n,E(t,s),v&&v.m(t,null),f=!0,c||(_=ne(e,"click",l[5]),c=!0)},p(r,[o]){l=r,(!f||o&4)&&n!==(n=Ge(l[2].text.content)+"")&&(e.innerHTML=n),l[1]<l[0].length-1?v?(v.p(l,o),o&3&&k(v,1)):(v=dt(l),v.c(),k(v,1),v.m(t,null)):v&&(N(),O(v,1,1,()=>{v=null}),U())},i(r){f||(le(()=>{a&&a.end(1),i=Te(e,x,l[4]),i.start()}),k(v),f=!0)},o(r){i&&i.invalidate(),a=Rt(e,x,{duration:100}),O(v),f=!1},d(r){r&&y(t),r&&a&&a.end(),v&&v.d(),c=!1,_()}}}function ya(l,t,e){const n=pe(),i={duration:500};let{text:a=[]}=t,s=0,f=!1;a.length>0&&(f=a[s]);const c=v=>{s<a.length-1?(e(1,s++,s),e(2,f=a[s])):n("close")},_=v=>{e(1,s++,s),e(2,f=a[s])};return l.$$set=v=>{"text"in v&&e(0,a=v.text)},[a,s,f,n,i,c,_]}class wa extends Y{constructor(t){super(),W(this,t,ya,ba,Z,{text:0})}}function Aa(l){let t,e,n,i,a,s,f,c;return{c(){t=T("div"),e=T("div"),n=T("input"),i=B(),a=T("button"),s=K("Send"),this.h()},l(_){t=I(_,"DIV",{class:!0});var v=D(t);e=I(v,"DIV",{class:!0});var r=D(e);n=I(r,"INPUT",{placeholder:!0,type:!0,maxlength:!0,class:!0}),i=F(r),a=I(r,"BUTTON",{class:!0});var o=D(a);s=Q(o,"Send"),o.forEach(y),r.forEach(y),v.forEach(y),this.h()},h(){g(n,"placeholder","Write a message..."),g(n,"type","[text]"),g(n,"maxlength","600"),g(n,"class","svelte-oqrtp3"),g(a,"class","svelte-oqrtp3"),g(e,"class","chat-input svelte-oqrtp3"),g(t,"class","chat-container svelte-oqrtp3")},m(_,v){$(_,t,v),E(t,e),E(e,n),Be(n,l[0]),E(e,i),E(e,a),E(a,s),f||(c=[ne(n,"input",l[3]),ne(n,"keydown",l[4]),ne(a,"click",l[1])],f=!0)},p(_,[v]){v&1&&Be(n,_[0])},i:ae,o:ae,d(_){_&&y(t),f=!1,je(c)}}}function ka(l,t,e){const n=pe();let i="";const a=()=>{n("submit",{text:i}),e(0,i="")};let{chatMessages:s=[]}=t;function f(){i=this.value,e(0,i)}const c=_=>{_.keyCode==13&&a()};return l.$$set=_=>{"chatMessages"in _&&e(2,s=_.chatMessages)},[i,a,s,f,c]}class Ta extends Y{constructor(t){super(),W(this,t,ka,Aa,Z,{chatMessages:2})}}function pt(l,t,e){const n=l.slice();return n[25]=t[e],n}function mt(l){let t,e,n;return e=new fi({props:{room:l[7],x:J(l[1][l[0].uuid],"x",100),y:J(l[1][l[0].uuid],"y",100),$$slots:{default:[Ia]},$$scope:{ctx:l}}}),e.$on("move",l[16]),{c(){t=T("div"),G(e.$$.fragment),this.h()},l(i){t=I(i,"DIV",{class:!0});var a=D(t);R(e.$$.fragment,a),a.forEach(y),this.h()},h(){g(t,"class","viewport"),ie(t,"pushed",l[9])},m(i,a){$(i,t,a),C(e,t,null),l[17](t),n=!0},p(i,a){const s={};a&128&&(s.room=i[7]),a&3&&(s.x=J(i[1][i[0].uuid],"x",100)),a&3&&(s.y=J(i[1][i[0].uuid],"y",100)),a&268435618&&(s.$$scope={dirty:a,ctx:i}),e.$set(s),a&512&&ie(t,"pushed",i[9])},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){O(e.$$.fragment,i),n=!1},d(i){i&&y(t),q(e),l[17](null)}}}function Ia(l){let t,e,n,i,a,s,f,c;return t=new mi({props:{players:l[1],currentRoomId:l[7]._id,avatars:l[5]}}),n=new Ai({props:{objects:J(l[7],"objects",[])}}),a=new Si({props:{zones:J(l[7],"zones",[])}}),f=new Fi({props:{portals:J(l[7],"portals",[])}}),{c(){G(t.$$.fragment),e=B(),G(n.$$.fragment),i=B(),G(a.$$.fragment),s=B(),G(f.$$.fragment)},l(_){R(t.$$.fragment,_),e=F(_),R(n.$$.fragment,_),i=F(_),R(a.$$.fragment,_),s=F(_),R(f.$$.fragment,_)},m(_,v){C(t,_,v),$(_,e,v),C(n,_,v),$(_,i,v),C(a,_,v),$(_,s,v),C(f,_,v),c=!0},p(_,v){const r={};v&2&&(r.players=_[1]),v&128&&(r.currentRoomId=_[7]._id),v&32&&(r.avatars=_[5]),t.$set(r);const o={};v&128&&(o.objects=J(_[7],"objects",[])),n.$set(o);const u={};v&128&&(u.zones=J(_[7],"zones",[])),a.$set(u);const p={};v&128&&(p.portals=J(_[7],"portals",[])),f.$set(p)},i(_){c||(k(t.$$.fragment,_),k(n.$$.fragment,_),k(a.$$.fragment,_),k(f.$$.fragment,_),c=!0)},o(_){O(t.$$.fragment,_),O(n.$$.fragment,_),O(a.$$.fragment,_),O(f.$$.fragment,_),c=!1},d(_){q(t,_),_&&y(e),q(n,_),_&&y(i),q(a,_),_&&y(s),q(f,_)}}}function vt(l){let t,e;return t=new Di({props:{soundFile:l[7].backgroundSound}}),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&128&&(a.soundFile=n[7].backgroundSound),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function ht(l){let t,e;return t=new qi({props:{streamUrl:l[25].videoUrl}}),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&2048&&(a.streamUrl=n[25].videoUrl),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function gt(l){let t,e,n=(l[7]._id==l[25].parentArea._ref||l[12]._id==l[25].parentArea._ref)&&ht(l);return{c(){n&&n.c(),t=P()},l(i){n&&n.l(i),t=P()},m(i,a){n&&n.m(i,a),$(i,t,a),e=!0},p(i,a){i[7]._id==i[25].parentArea._ref||i[12]._id==i[25].parentArea._ref?n?(n.p(i,a),a&6272&&k(n,1)):(n=ht(i),n.c(),k(n,1),n.m(t.parentNode,t)):n&&(N(),O(n,1,1,()=>{n=null}),U())},i(i){e||(k(n),e=!0)},o(i){O(n),e=!1},d(i){n&&n.d(i),i&&y(t)}}}function bt(l){let t,e;return t=new ua({props:{roomIntent:l[3],roomTitle:l[8][l[3]].title}}),t.$on("room",l[18]),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&8&&(a.roomIntent=n[3]),i&264&&(a.roomTitle=n[8][n[3]].title),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function yt(l){let t,e;return t=new va({props:{objectIntent:l[2],objectTitle:l[7].objects.find(l[19]).title}}),t.$on("object",l[20]),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&4&&(a.objectIntent=n[2]),i&132&&(a.objectTitle=n[7].objects.find(n[19]).title),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function wt(l){let t,e,n=l[6]&&At(l);return{c(){n&&n.c(),t=P()},l(i){n&&n.l(i),t=P()},m(i,a){n&&n.m(i,a),$(i,t,a),e=!0},p(i,a){i[6]?n?(n.p(i,a),a&64&&k(n,1)):(n=At(i),n.c(),k(n,1),n.m(t.parentNode,t)):n&&(N(),O(n,1,1,()=>{n=null}),U())},i(i){e||(k(n),e=!0)},o(i){O(n),e=!1},d(i){n&&n.d(i),i&&y(t)}}}function At(l){let t,e;return t=new wa({props:{text:l[6]}}),t.$on("close",l[21]),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&64&&(a.text=n[6]),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function kt(l){let t,e;return t=new ia({props:{article:l[13]}}),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&8192&&(a.article=n[13]),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function Tt(l){let t,e;return t=new Ta({props:{chatMessages:l[14].filter(l[22])}}),t.$on("submit",l[23]),{c(){G(t.$$.fragment)},l(n){R(t.$$.fragment,n)},m(n,i){C(t,n,i),e=!0},p(n,i){const a={};i&16512&&(a.chatMessages=n[14].filter(n[22])),t.$set(a)},i(n){e||(k(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){q(t,n)}}}function $a(l){let t,e=se(l[7],"backgroundSound.asset")&&l[10],n,i,a,s,f,c,_,v,r=l[7]&&mt(l),o=e&&vt(l),u=l[11],p=[];for(let w=0;w<u.length;w+=1)p[w]=gt(pt(l,u,w));const b=w=>O(p[w],1,1,()=>{p[w]=null});let m=l[3]&&bt(l),d=l[2]&&yt(l),h=!l[9]&&!l[13]&&!l[3]&&!l[2]&&wt(l),A=l[13]&&kt(l),j=!l[9]&&!l[13]&&Tt(l);return{c(){r&&r.c(),t=B(),o&&o.c(),n=B();for(let w=0;w<p.length;w+=1)p[w].c();i=B(),m&&m.c(),a=B(),d&&d.c(),s=B(),h&&h.c(),f=B(),A&&A.c(),c=B(),j&&j.c(),_=P()},l(w){r&&r.l(w),t=F(w),o&&o.l(w),n=F(w);for(let S=0;S<p.length;S+=1)p[S].l(w);i=F(w),m&&m.l(w),a=F(w),d&&d.l(w),s=F(w),h&&h.l(w),f=F(w),A&&A.l(w),c=F(w),j&&j.l(w),_=P()},m(w,S){r&&r.m(w,S),$(w,t,S),o&&o.m(w,S),$(w,n,S);for(let M=0;M<p.length;M+=1)p[M].m(w,S);$(w,i,S),m&&m.m(w,S),$(w,a,S),d&&d.m(w,S),$(w,s,S),h&&h.m(w,S),$(w,f,S),A&&A.m(w,S),$(w,c,S),j&&j.m(w,S),$(w,_,S),v=!0},p(w,[S]){if(w[7]?r?(r.p(w,S),S&128&&k(r,1)):(r=mt(w),r.c(),k(r,1),r.m(t.parentNode,t)):r&&(N(),O(r,1,1,()=>{r=null}),U()),S&1152&&(e=se(w[7],"backgroundSound.asset")&&w[10]),e?o?(o.p(w,S),S&1152&&k(o,1)):(o=vt(w),o.c(),k(o,1),o.m(n.parentNode,n)):o&&(N(),O(o,1,1,()=>{o=null}),U()),S&6272){u=w[11];let M;for(M=0;M<u.length;M+=1){const oe=pt(w,u,M);p[M]?(p[M].p(oe,S),k(p[M],1)):(p[M]=gt(oe),p[M].c(),k(p[M],1),p[M].m(i.parentNode,i))}for(N(),M=u.length;M<p.length;M+=1)b(M);U()}w[3]?m?(m.p(w,S),S&8&&k(m,1)):(m=bt(w),m.c(),k(m,1),m.m(a.parentNode,a)):m&&(N(),O(m,1,1,()=>{m=null}),U()),w[2]?d?(d.p(w,S),S&4&&k(d,1)):(d=yt(w),d.c(),k(d,1),d.m(s.parentNode,s)):d&&(N(),O(d,1,1,()=>{d=null}),U()),!w[9]&&!w[13]&&!w[3]&&!w[2]?h?(h.p(w,S),S&8716&&k(h,1)):(h=wt(w),h.c(),k(h,1),h.m(f.parentNode,f)):h&&(N(),O(h,1,1,()=>{h=null}),U()),w[13]?A?(A.p(w,S),S&8192&&k(A,1)):(A=kt(w),A.c(),k(A,1),A.m(c.parentNode,c)):A&&(N(),O(A,1,1,()=>{A=null}),U()),!w[9]&&!w[13]?j?(j.p(w,S),S&8704&&k(j,1)):(j=Tt(w),j.c(),k(j,1),j.m(_.parentNode,_)):j&&(N(),O(j,1,1,()=>{j=null}),U())},i(w){if(!v){k(r),k(o);for(let S=0;S<u.length;S+=1)k(p[S]);k(m),k(d),k(h),k(A),k(j),v=!0}},o(w){O(r),O(o),p=p.filter(Boolean);for(let S=0;S<p.length;S+=1)O(p[S]);O(m),O(d),O(h),O(A),O(j),v=!1},d(w){r&&r.d(w),w&&y(t),o&&o.d(w),w&&y(n),$t(p,w),w&&y(i),m&&m.d(w),w&&y(a),d&&d.d(w),w&&y(s),h&&h.d(w),w&&y(f),A&&A.d(w),w&&y(c),j&&j.d(w),w&&y(_)}}}function Ea(l,t,e){let n,i,a,s,f,c,_,v,r,o,u,p,b;z(l,Ie,V=>e(7,n=V)),z(l,dr,V=>e(24,i=V)),z(l,Re,V=>e(0,a=V)),z(l,pr,V=>e(8,s=V)),z(l,jt,V=>e(1,f=V)),z(l,qe,V=>e(2,c=V)),z(l,Ce,V=>e(3,_=V)),z(l,Vt,V=>e(9,v=V)),z(l,mr,V=>e(10,r=V)),z(l,vr,V=>e(11,o=V)),z(l,hr,V=>e(12,u=V)),z(l,Ee,V=>e(13,p=V)),z(l,Ot,V=>e(14,b=V));let m={},d=[],h=!1;const A=async V=>{let re=s[V];ge.set(!1),await sr(m),Ie.set(re),fr({id:re._id,x:we(4,6),y:we(4,6)}),await ur(m),ge.set(!0),se(re,"introductionTexts")?e(6,h=re.introductionTexts):e(6,h=!1)};me(async()=>{fe("__ => App starting...");try{await zt()}catch(re){Jt("Error in authentication:",re)}fe("\u2713 (1) Auth client configured "),await er(),fe("\u2713 (2) World built");for(const[re,de]of Object.entries(s))if(s[re].mainArea){Ie.set(s[re]);break}e(5,d=await tr()),fe("\u2713 (3) Avatars loaded"),Re.update(re=>(re.uuid=rr(),re));let V={uuid:a.uuid,name:i&&i.name?i.name:"Test player",shape:se(i,"avatar._ref")?i.avatar._ref:De(d)._id,onboarded:!0,room:n._id,x:we(10,30),y:we(5,15)};await nr(V),fe("\u2713 (4) Game server connected"),await ir(),fe("\u2713 (5) Keyboard initialized"),ar(),fe("\u2713 (6) Stream listener initialized"),se(n,"introductionTexts")&&e(6,h=n.introductionTexts),fe("\u2713 (7) Show main room introduction"),fe("__ => App loaded"),or.set(lr.READY)});const j=V=>{cr(V.detail.x,V.detail.y,!1)};function w(V){ve[V?"unshift":"push"](()=>{m=V,e(4,m)})}const S=V=>{V.detail.roomId&&A(_),Ce.set(!1)},M=V=>V._id==c,oe=V=>{V.detail.objectId&&Ee.set(n.objects.find(re=>re._id==c)),qe.set(!1)},L=V=>{e(6,h=!1)},be=V=>V.room===n._id,ye=V=>{_r(V,n)};return l.$$.update=()=>{l.$$.dirty&4&&console.log("$objectIntent",c),l.$$.dirty&12&&(_||c)&&e(6,h=!1),l.$$.dirty&3&&f[a.uuid]&&(f[a.uuid].x||f[a.uuid].x)&&(gr(),br(),yr())},[a,f,c,_,m,d,h,n,s,v,r,o,u,p,b,A,j,w,S,M,oe,L,be,ye]}class ja extends Y{constructor(t){super(),W(this,t,Ea,$a,Z,{})}}export{ja as default};
