import{S as K,i as Q,s as z,E as le,T as Jt,e as E,k as H,t as ae,c as S,a as $,m as C,d as w,h as oe,b,g as T,I as D,O as fe,U as er,V as tr,W as rr,q as A,o as I,M as J,a1 as Te,a2 as be,Y as F,$ as Z,H as ie,J as ce,K as ne,v as ve,l as V,w as N,x as U,y as X,B as W,n as x,p as q,a3 as Oe,a4 as De,a5 as Ft,L as He,j as ge,R as Lt,Q as jt,F as qe,G as Ne,a6 as nr,a7 as Ue}from"../chunks/index-a7942797.js";import{_ as ir,k as Ht,m as ar,n as Ct,o as or,q as lr,r as sr,v as ur,w as Gt,x as fr,y as pe,h as ue,z as te,C as cr,D as Rt,E as Xe,F as me,f as re,s as ke,j as Ce,G as ye,H as Ve,I as he,J as We,K as Ye,l as xt,B as Ge,t as qt,L as Ze,M as Nt,N as dr,g as Ae,O as _r,P as _e,Q as pr,R as mr,T as $e,u as hr,S as vr,p as gr,e as br,i as Ke}from"../chunks/authentication-8640a51f.js";import{w as de}from"../chunks/index-2a8d61f9.js";var yr=Math.floor,wr=Math.random;function Ar(l,r){return l+yr(wr()*(r-l+1))}var kr=Ar,Tr=kr;function Ir(l){var r=l.length;return r?l[Tr(0,r-1)]:void 0}var Ut=Ir,Er=ir;function Sr(l,r){return Er(r,function(e){return l[e]})}var $r=Sr;function Or(l,r){for(var e=-1,t=Array(l);++e<l;)t[e]=r(e);return t}var Dr=Or,Be={exports:{}};function Mr(){return!1}var Pr=Mr;(function(l,r){var e=Ht,t=Pr,i=r&&!r.nodeType&&r,a=i&&!0&&l&&!l.nodeType&&l,s=a&&a.exports===i,u=s?e.Buffer:void 0,c=u?u.isBuffer:void 0,d=c||t;l.exports=d})(Be,Be.exports);var Vr=ar,Br=Ct,Fr=or,Lr="[object Arguments]",jr="[object Array]",Hr="[object Boolean]",Cr="[object Date]",Gr="[object Error]",Rr="[object Function]",xr="[object Map]",qr="[object Number]",Nr="[object Object]",Ur="[object RegExp]",Xr="[object Set]",Wr="[object String]",Yr="[object WeakMap]",Zr="[object ArrayBuffer]",Kr="[object DataView]",Qr="[object Float32Array]",zr="[object Float64Array]",Jr="[object Int8Array]",en="[object Int16Array]",tn="[object Int32Array]",rn="[object Uint8Array]",nn="[object Uint8ClampedArray]",an="[object Uint16Array]",on="[object Uint32Array]",j={};j[Qr]=j[zr]=j[Jr]=j[en]=j[tn]=j[rn]=j[nn]=j[an]=j[on]=!0;j[Lr]=j[jr]=j[Zr]=j[Hr]=j[Kr]=j[Cr]=j[Gr]=j[Rr]=j[xr]=j[qr]=j[Nr]=j[Ur]=j[Xr]=j[Wr]=j[Yr]=!1;function ln(l){return Fr(l)&&Br(l.length)&&!!j[Vr(l)]}var sn=ln;function un(l){return function(r){return l(r)}}var fn=un,Fe={exports:{}};(function(l,r){var e=lr,t=r&&!r.nodeType&&r,i=t&&!0&&l&&!l.nodeType&&l,a=i&&i.exports===t,s=a&&e.process,u=function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();l.exports=u})(Fe,Fe.exports);var cn=sn,dn=fn,Qe=Fe.exports,ze=Qe&&Qe.isTypedArray,_n=ze?dn(ze):cn,pn=_n,mn=Dr,hn=sr,vn=Gt,gn=Be.exports,bn=ur,yn=pn,wn=Object.prototype,An=wn.hasOwnProperty;function kn(l,r){var e=vn(l),t=!e&&hn(l),i=!e&&!t&&gn(l),a=!e&&!t&&!i&&yn(l),s=e||t||i||a,u=s?mn(l.length,String):[],c=u.length;for(var d in l)(r||An.call(l,d))&&!(s&&(d=="length"||i&&(d=="offset"||d=="parent")||a&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||bn(d,c)))&&u.push(d);return u}var Tn=kn,In=Object.prototype;function En(l){var r=l&&l.constructor,e=typeof r=="function"&&r.prototype||In;return l===e}var Sn=En;function $n(l,r){return function(e){return l(r(e))}}var On=$n,Dn=On,Mn=Dn(Object.keys,Object),Pn=Mn,Vn=Sn,Bn=Pn,Fn=Object.prototype,Ln=Fn.hasOwnProperty;function jn(l){if(!Vn(l))return Bn(l);var r=[];for(var e in Object(l))Ln.call(l,e)&&e!="constructor"&&r.push(e);return r}var Hn=jn,Cn=fr,Gn=Ct;function Rn(l){return l!=null&&Gn(l.length)&&!Cn(l)}var xn=Rn,qn=Tn,Nn=Hn,Un=xn;function Xn(l){return Un(l)?qn(l):Nn(l)}var Wn=Xn,Yn=$r,Zn=Wn;function Kn(l){return l==null?[]:Yn(l,Zn(l))}var Qn=Kn,zn=Ut,Jn=Qn;function ei(l){return zn(Jn(l))}var ti=ei,ri=Ut,ni=ti,ii=Gt;function ai(l){var r=ii(l)?ri:ni;return r(l)}var Le=ai;const oi=de({});let Xt=de({});const R=32,li=()=>new Promise(async(l,r)=>{const e=await pe('*[_type == "room"]{..., "bgImageUrl": backgroundImage.asset->url}'),t=await pe('*[_type == "zone"]{..., "bgImageUrl": backgroundImage.asset->url}'),i=await pe('*[_type == "exob"]'),a=await pe('*[_type == "portal"]{..., targetArea->{...}, "bgImageUrl": backgroundImage.asset->url}'),s=await pe('*[_type == "event"]'),u=await pe('*[_id == "bulletin-board-settings"][0]');let c={};e.forEach(d=>c[d._id]=d);for(const[d,h]of Object.entries(c))c[d].objects=[],c[d].zones=[],c[d].portals=[],c[d].inlineStyles=ui(h);i.forEach(d=>{ue(d,"parentArea._ref")&&c[d.parentArea._ref].objects.push(d)}),u&&(u.isBulletinBoard=!0,u.title="Bulletin Board",u.events=s,c[u.parentArea._ref].objects.push(u)),t.forEach(d=>{ue(d,"parentArea._ref")&&c[d.parentArea._ref].zones.push(d)}),a.forEach(d=>{ue(d,"parentArea._ref")&&c[d.parentArea._ref].portals.push(d)}),Xt.set(c),l()}),si=()=>new Promise(async(l,r)=>{const e=await pe('*[_type == "avatar"]{..., "imageUrl": image.asset->url}');l(e)}),ui=l=>{let r="width: "+te(l,"dimensions.width",0)*R+"px;",e="height: "+te(l,"dimensions.height",0)*R+"px;",t="background-image: url("+l.bgImageUrl+");";return r+e+t};pe('*[_id == "global-settings"]').then(l=>{oi.set(l)}).catch(l=>{console.log(l)});function Je(l){return{c:le,l:le,m:le,d:le}}function fi(l){let r,e,t,i,a,s,u,c,d=l[2]&&Je();const h=l[8].default,n=Jt(h,l,l[7],null);return{c(){r=E("div"),d&&d.c(),e=H(),n&&n.c(),t=H(),i=E("div"),a=ae("CENTER VIEW (DEBUG)"),this.h()},l(o){r=S(o,"DIV",{class:!0,id:!0,style:!0});var f=$(r);d&&d.l(f),e=C(f),n&&n.l(f),f.forEach(w),t=C(o),i=S(o,"DIV",{class:!0});var p=$(i);a=oe(p,"CENTER VIEW (DEBUG)"),p.forEach(w),this.h()},h(){b(r,"class","room svelte-ib3ibm"),b(r,"id","room"),b(r,"style",l[1]),b(i,"class","center-view svelte-ib3ibm")},m(o,f){T(o,r,f),d&&d.m(r,null),D(r,e),n&&n.m(r,null),l[9](r),T(o,t,f),T(o,i,f),D(i,a),s=!0,u||(c=fe(i,"click",l[3]),u=!0)},p(o,[f]){o[2]?d||(d=Je(),d.c(),d.m(r,e)):d&&(d.d(1),d=null),n&&n.p&&(!s||f&128)&&er(n,h,o,o[7],s?rr(h,o[7],f,null):tr(o[7]),null),(!s||f&2)&&b(r,"style",o[1])},i(o){s||(A(n,o),s=!0)},o(o){I(n,o),s=!1},d(o){o&&w(r),d&&d.d(),n&&n.d(o),l[9](null),o&&w(t),o&&w(i),u=!1,c()}}}function ci(l,r,e){let t;J(l,cr,f=>e(2,t=f));let{$$slots:i={},$$scope:a}=r;Te();let{room:s={}}=r,{x:u=0}=r,{y:c=0}=r,d={},h="";const n=(f,p)=>{e(1,h=`${s.inlineStyles} transform: translateX(-${f*R}px) translateY(-${p*R}px);`)};function o(f){be[f?"unshift":"push"](()=>{d=f,e(0,d)})}return l.$$set=f=>{"room"in f&&e(4,s=f.room),"x"in f&&e(5,u=f.x),"y"in f&&e(6,c=f.y),"$$scope"in f&&e(7,a=f.$$scope)},l.$$.update=()=>{l.$$.dirty&96&&n(u,c),l.$$.dirty&16&&e(1,h=`${s.inlineStyles} transform: translateX(-50%) translateY(-50%);`)},[d,h,t,n,s,u,c,a,i,o]}class di extends K{constructor(r){super(),Q(this,r,ci,fi,z,{room:4,x:5,y:6})}}const ee=de({uuid:"",sessionId:"",name:"",profile:{}}),Y=de({}),Re=de([]),Wt=de(!1),_i=de(0),pi=de(0),mi="wss://open.eyebeam.dev";let xe={},Yt={},Zt={},Kt={},Qt={},et={};const hi=l=>(et=new Colyseus.Client(mi),new Promise((r,e)=>{et.joinOrCreate("game",l).then(t=>{t.state.players.onRemove=(i,a)=>{Y.update(s=>(delete s[i.uuid],s))},t.state.players.onAdd=(i,a)=>{Y.update(s=>(s[i.uuid]={name:i.name,x:i.x,y:i.y,room:i.room,npc:i.npc,inTransit:!1,self:i.uuid===F(ee).uuid},s)),i.uuid===F(ee).uuid&&ee.update(s=>(s.sessionId=a,s.name=i.name,s)),i.onChange=s=>{F(Y)[i.uuid].room!==i.room?(Y.update(u=>(u[i.uuid].name=i.name,u[i.uuid].shape=i.shape,u[i.uuid].room=i.room,u[i.uuid].inTransit=!0,u[i.uuid].viewing=i.viewing,u)),setTimeout(()=>{Y.update(u=>(u[i.uuid].inTransit=!1,u))},1e3)):Y.update(u=>(u[i.uuid].name=i.name,u[i.uuid].shape=i.shape,u[i.uuid].viewing=i.viewing,u)),!(i.uuid===F(ee).uuid&&i.path.keyboardNavigation)&&Y.update(u=>(u[i.uuid].x=i.x,u[i.uuid].y=i.y,u))}},t.onMessage("banned",i=>{}),xe=(i,a,s)=>{Wt.set(!1),s?t.send("go",{x:i,y:a,keyboardNavigation:!0}):t.send("go",{x:i,y:a,originX:F(Y)[F(ee).uuid].x,originY:F(Y)[F(ee).uuid].y,keyboardNavigation:!1})},Yt=i=>{t.send("changeRoom",{id:i.id,x:i.x,y:i.y})},Zt=i=>{t.send("enterArticle",{id:i._id})},Kt=()=>{t.send("leaveArticle")},t.state.messages.onAdd=i=>{Re.update(a=>(a.push(i),a))},Qt=(i,a)=>{try{t.send("submitChatMessage",{msgId:Rt(),uuid:F(ee).uuid,name:F(Y)[F(ee).uuid].name,text:i.detail.text,room:a._id})}catch(s){console.dir(s)}},t.onLeave(i=>{const a="Disconnected from server. Code: "+i;console.log(a)}),t.onError((i,a)=>{console.error("Gameserver error:",a)}),r()}).catch(t=>{console.dir(t),t.code==4215,e(t)})}));function vi(l){let r,e,t,i,a,s,u;return{c(){r=E("div"),e=E("img"),this.h()},l(c){r=S(c,"DIV",{class:!0,id:!0,alt:!0,style:!0});var d=$(r);e=S(d,"IMG",{src:!0,class:!0}),d.forEach(w),this.h()},h(){Z(e.src,t=l[6]&&l[6].imageUrl?l[6].imageUrl:Le(l[1]).imageUrl)||b(e,"src",t),b(e,"class","svelte-zqf5vo"),b(r,"class","avatar svelte-zqf5vo"),b(r,"id",l[2]),b(r,"alt",i=l[0].name),b(r,"style",a="transform: translateY("+l[4]+"px) translateX("+l[5]+"px)"),ie(r,"self",l[0].self)},m(c,d){T(c,r,d),D(r,e),l[8](r),u=!0},p(c,[d]){(!u||d&2&&!Z(e.src,t=c[6]&&c[6].imageUrl?c[6].imageUrl:Le(c[1]).imageUrl))&&b(e,"src",t),(!u||d&4)&&b(r,"id",c[2]),(!u||d&1&&i!==(i=c[0].name))&&b(r,"alt",i),(!u||d&48&&a!==(a="transform: translateY("+c[4]+"px) translateX("+c[5]+"px)"))&&b(r,"style",a),d&1&&ie(r,"self",c[0].self)},i(c){u||(ce(()=>{s||(s=ne(r,Xe,{},!0)),s.run(1)}),u=!0)},o(c){s||(s=ne(r,Xe,{},!1)),s.run(0),u=!1},d(c){c&&w(r),l[8](null),c&&s&&s.end()}}}function gi(l,r,e){let t;J(l,Re,v=>e(7,t=v));let i={},a={};const s=v=>{i.popper&&(i.hide(),i.destroy(),clearTimeout(a)),h&&h.nodeName&&(i=tippy(h,{content:v.text,arrow:!1,offset:[0,5],sticky:!0,animation:"fade",inertia:!0,theme:"chat",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}),i.show(),a=setTimeout(()=>{i.hide(),setTimeout(()=>{i.destroy()},500)},4e3))};let{player:u={}}=r,{avatars:c=[]}=r,{key:d=""}=r,h={},n=c.find(v=>v._id===u.shape),o=u.y*R,f=u.x*R;ve(async()=>{u.self||tippy(h,{content:u.name,arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}})});function p(v){be[v?"unshift":"push"](()=>{h=v,e(3,h)})}return l.$$set=v=>{"player"in v&&e(0,u=v.player),"avatars"in v&&e(1,c=v.avatars),"key"in v&&e(2,d=v.key)},l.$$.update=()=>{if(l.$$.dirty&132){let v=t[t.length-1];v&&v.uuid==d&&Date.now()-v.timestamp<5e3&&s(v)}l.$$.dirty&1&&(e(4,o=u.y*R),e(5,f=u.x*R))},[u,c,d,h,o,f,n,t,p]}class bi extends K{constructor(r){super(),Q(this,r,gi,vi,z,{player:0,avatars:1,key:2})}}function tt(l,r,e){const t=l.slice();return t[3]=r[e][0],t[4]=r[e][1],t}function rt(l){let r,e;return r=new bi({props:{player:l[4],key:l[3],avatars:l[2]}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&1&&(a.player=t[4]),i&1&&(a.key=t[3]),i&4&&(a.avatars=t[2]),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function nt(l,r){let e,t,i,a=r[4].room===r[1]&&!r[4].inTransit&&rt(r);return{key:l,first:null,c(){e=V(),a&&a.c(),t=V(),this.h()},l(s){e=V(),a&&a.l(s),t=V(),this.h()},h(){this.first=e},m(s,u){T(s,e,u),a&&a.m(s,u),T(s,t,u),i=!0},p(s,u){r=s,r[4].room===r[1]&&!r[4].inTransit?a?(a.p(r,u),u&3&&A(a,1)):(a=rt(r),a.c(),A(a,1),a.m(t.parentNode,t)):a&&(x(),I(a,1,1,()=>{a=null}),q())},i(s){i||(A(a),i=!0)},o(s){I(a),i=!1},d(s){s&&w(e),a&&a.d(s),s&&w(t)}}}function yi(l){let r=[],e=new Map,t,i,a=Object.entries(l[0]);const s=u=>u[3];for(let u=0;u<a.length;u+=1){let c=tt(l,a,u),d=s(c);e.set(d,r[u]=nt(d,c))}return{c(){for(let u=0;u<r.length;u+=1)r[u].c();t=V()},l(u){for(let c=0;c<r.length;c+=1)r[c].l(u);t=V()},m(u,c){for(let d=0;d<r.length;d+=1)r[d].m(u,c);T(u,t,c),i=!0},p(u,[c]){c&7&&(a=Object.entries(u[0]),x(),r=Oe(r,c,s,1,u,a,e,t.parentNode,De,nt,t,tt),q())},i(u){if(!i){for(let c=0;c<a.length;c+=1)A(r[c]);i=!0}},o(u){for(let c=0;c<r.length;c+=1)I(r[c]);i=!1},d(u){for(let c=0;c<r.length;c+=1)r[c].d(u);u&&w(t)}}}function wi(l,r,e){let{players:t={}}=r,{currentRoomId:i=""}=r,{avatars:a=[]}=r;return l.$$set=s=>{"players"in s&&e(0,t=s.players),"currentRoomId"in s&&e(1,i=s.currentRoomId),"avatars"in s&&e(2,a=s.avatars)},[t,i,a]}class Ai extends K{constructor(r){super(),Q(this,r,wi,yi,z,{players:0,currentRoomId:1,avatars:2})}}function it(l){let r,e;return{c(){r=E("img"),this.h()},l(t){r=S(t,"IMG",{src:!0,class:!0}),this.h()},h(){Z(r.src,e=me(l[0].iconImage).quality(100).height(300).url())||b(r,"src",e),b(r,"class","svelte-1qmh4za")},m(t,i){T(t,r,i)},p(t,i){i&1&&!Z(r.src,e=me(t[0].iconImage).quality(100).height(300).url())&&b(r,"src",e)},d(t){t&&w(r)}}}function ki(l){let r,e,t,i,a,s,u,c=l[0].iconImage&&it(l);return{c(){r=E("div"),c&&c.c(),this.h()},l(d){r=S(d,"DIV",{class:!0,id:!0,alt:!0,style:!0});var h=$(r);c&&c.l(h),h.forEach(w),this.h()},h(){b(r,"class","object svelte-1qmh4za"),b(r,"id",e=l[0]._id),b(r,"alt",t=l[0].title),b(r,"style",l[2]),ie(r,"static",l[0].static),ie(r,"image",l[0].iconImage)},m(d,h){T(d,r,h),c&&c.m(r,null),l[5](r),a=!0,s||(u=fe(r,"click",l[6]),s=!0)},p(d,[h]){d[0].iconImage?c?c.p(d,h):(c=it(d),c.c(),c.m(r,null)):c&&(c.d(1),c=null),(!a||h&1&&e!==(e=d[0]._id))&&b(r,"id",e),(!a||h&1&&t!==(t=d[0].title))&&b(r,"alt",t),h&1&&ie(r,"static",d[0].static),h&1&&ie(r,"image",d[0].iconImage)},i(d){a||(ce(()=>{i||(i=ne(r,re,{},!0)),i.run(1)}),a=!0)},o(d){i||(i=ne(r,re,{},!1)),i.run(0),a=!1},d(d){d&&w(r),c&&c.d(),l[5](null),d&&i&&i.end(),s=!1,u()}}}function Ti(l,r,e){let t;J(l,ke,p=>e(4,t=p));let{object:i={}}=r,a={},s={},u=i.y*R,c=i.x*R,d=te(i,"dimensions.width",1)*R,h=te(i,"dimensions.height",1)*R;const n=`transform: translateY(${u}px) translateX(${c}px); width: ${d}px; height: ${h}px;`;ve(async()=>{e(3,s=tippy(a,{content:i.title,arrow:!1,offset:[0,5],theme:i.static?"static":"name",hideOnClick:!1,sticky:!0,trigger:"manual",flip:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}))});function o(p){be[p?"unshift":"push"](()=>{a=p,e(1,a)})}const f=()=>{Ce.set(i)};return l.$$set=p=>{"object"in p&&e(0,i=p.object)},l.$$.update=()=>{l.$$.dirty&24&&s.popper&&(t?s.show():s.hide())},[i,a,n,s,t,o,f]}class Ii extends K{constructor(r){super(),Q(this,r,Ti,ki,z,{object:0})}}function at(l,r,e){const t=l.slice();return t[1]=r[e],t}function ot(l,r){let e,t,i;return t=new Ii({props:{object:r[1]}}),{key:l,first:null,c(){e=V(),N(t.$$.fragment),this.h()},l(a){e=V(),U(t.$$.fragment,a),this.h()},h(){this.first=e},m(a,s){T(a,e,s),X(t,a,s),i=!0},p(a,s){r=a;const u={};s&1&&(u.object=r[1]),t.$set(u)},i(a){i||(A(t.$$.fragment,a),i=!0)},o(a){I(t.$$.fragment,a),i=!1},d(a){a&&w(e),W(t,a)}}}function Ei(l){let r=[],e=new Map,t,i,a=l[0];const s=u=>u[1]._id;for(let u=0;u<a.length;u+=1){let c=at(l,a,u),d=s(c);e.set(d,r[u]=ot(d,c))}return{c(){for(let u=0;u<r.length;u+=1)r[u].c();t=V()},l(u){for(let c=0;c<r.length;c+=1)r[c].l(u);t=V()},m(u,c){for(let d=0;d<r.length;d+=1)r[d].m(u,c);T(u,t,c),i=!0},p(u,[c]){c&1&&(a=u[0],x(),r=Oe(r,c,s,1,u,a,e,t.parentNode,De,ot,t,at),q())},i(u){if(!i){for(let c=0;c<a.length;c+=1)A(r[c]);i=!0}},o(u){for(let c=0;c<r.length;c+=1)I(r[c]);i=!1},d(u){for(let c=0;c<r.length;c+=1)r[c].d(u);u&&w(t)}}}function Si(l,r,e){let{objects:t={}}=r;return l.$$set=i=>{"objects"in i&&e(0,t=i.objects)},[t]}class $i extends K{constructor(r){super(),Q(this,r,Si,Ei,z,{objects:0})}}function lt(l){let r,e;return{c(){r=E("img"),this.h()},l(t){r=S(t,"IMG",{src:!0}),this.h()},h(){Z(r.src,e=me(l[0].backgroundImage).quality(100).url())||b(r,"src",e)},m(t,i){T(t,r,i)},p(t,i){i&1&&!Z(r.src,e=me(t[0].backgroundImage).quality(100).url())&&b(r,"src",e)},d(t){t&&w(r)}}}function Oi(l){let r,e,t,i,a,s=l[0].backgroundImage&&lt(l);return{c(){r=E("div"),s&&s.c(),this.h()},l(u){r=S(u,"DIV",{class:!0,id:!0,alt:!0,style:!0});var c=$(r);s&&s.l(c),c.forEach(w),this.h()},h(){b(r,"class","zone svelte-1sqo6n0"),b(r,"id",e=l[0]._id),b(r,"alt",t=l[0].title),b(r,"style",l[2])},m(u,c){T(u,r,c),s&&s.m(r,null),l[5](r),a=!0},p(u,[c]){u[0].backgroundImage?s?s.p(u,c):(s=lt(u),s.c(),s.m(r,null)):s&&(s.d(1),s=null),(!a||c&1&&e!==(e=u[0]._id))&&b(r,"id",e),(!a||c&1&&t!==(t=u[0].title))&&b(r,"alt",t)},i(u){a||(ce(()=>{i||(i=ne(r,re,{},!0)),i.run(1)}),a=!0)},o(u){i||(i=ne(r,re,{},!1)),i.run(0),a=!1},d(u){u&&w(r),s&&s.d(),l[5](null),u&&i&&i.end()}}}function Di(l,r,e){let t;J(l,ke,f=>e(4,t=f));let{zone:i={}}=r,a={},s={},u=i.y*R,c=i.x*R,d=te(i,"dimensions.width",1)*R,h=te(i,"dimensions.height",1)*R;const n=`transform: translateY(${u}px) translateX(${c}px); width: ${d}px; height: ${h}px;};`;ve(async()=>{e(3,s=tippy(a,{content:i.title,arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,sticky:!0,trigger:"manual",flip:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}))});function o(f){be[f?"unshift":"push"](()=>{a=f,e(1,a)})}return l.$$set=f=>{"zone"in f&&e(0,i=f.zone)},l.$$.update=()=>{l.$$.dirty&24&&s.popper&&(t?s.show():s.hide())},[i,a,n,s,t,o]}class Mi extends K{constructor(r){super(),Q(this,r,Di,Oi,z,{zone:0})}}function st(l,r,e){const t=l.slice();return t[1]=r[e],t}function ut(l,r){let e,t,i;return t=new Mi({props:{zone:r[1]}}),{key:l,first:null,c(){e=V(),N(t.$$.fragment),this.h()},l(a){e=V(),U(t.$$.fragment,a),this.h()},h(){this.first=e},m(a,s){T(a,e,s),X(t,a,s),i=!0},p(a,s){r=a;const u={};s&1&&(u.zone=r[1]),t.$set(u)},i(a){i||(A(t.$$.fragment,a),i=!0)},o(a){I(t.$$.fragment,a),i=!1},d(a){a&&w(e),W(t,a)}}}function Pi(l){let r=[],e=new Map,t,i,a=l[0];const s=u=>u[1]._id;for(let u=0;u<a.length;u+=1){let c=st(l,a,u),d=s(c);e.set(d,r[u]=ut(d,c))}return{c(){for(let u=0;u<r.length;u+=1)r[u].c();t=V()},l(u){for(let c=0;c<r.length;c+=1)r[c].l(u);t=V()},m(u,c){for(let d=0;d<r.length;d+=1)r[d].m(u,c);T(u,t,c),i=!0},p(u,[c]){c&1&&(a=u[0],x(),r=Oe(r,c,s,1,u,a,e,t.parentNode,De,ut,t,st),q())},i(u){if(!i){for(let c=0;c<a.length;c+=1)A(r[c]);i=!0}},o(u){for(let c=0;c<r.length;c+=1)I(r[c]);i=!1},d(u){for(let c=0;c<r.length;c+=1)r[c].d(u);u&&w(t)}}}function Vi(l,r,e){let{zones:t={}}=r;return l.$$set=i=>{"zones"in i&&e(0,t=i.zones)},[t]}class Bi extends K{constructor(r){super(),Q(this,r,Vi,Pi,z,{zones:0})}}var zt={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(l){(function(){var r=function(){this.init()};r.prototype={init:function(){var n=this||e;return n._counter=1e3,n._html5AudioPool=[],n.html5PoolSize=10,n._codecs={},n._howls=[],n._muted=!1,n._volume=1,n._canPlayEvent="canplaythrough",n._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,n.masterGain=null,n.noAudio=!1,n.usingWebAudio=!0,n.autoSuspend=!0,n.ctx=null,n.autoUnlock=!0,n._setup(),n},volume:function(n){var o=this||e;if(n=parseFloat(n),o.ctx||h(),typeof n!="undefined"&&n>=0&&n<=1){if(o._volume=n,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(n,e.ctx.currentTime);for(var f=0;f<o._howls.length;f++)if(!o._howls[f]._webAudio)for(var p=o._howls[f]._getSoundIds(),v=0;v<p.length;v++){var m=o._howls[f]._soundById(p[v]);m&&m._node&&(m._node.volume=m._volume*n)}return o}return o._volume},mute:function(n){var o=this||e;o.ctx||h(),o._muted=n,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(n?0:o._volume,e.ctx.currentTime);for(var f=0;f<o._howls.length;f++)if(!o._howls[f]._webAudio)for(var p=o._howls[f]._getSoundIds(),v=0;v<p.length;v++){var m=o._howls[f]._soundById(p[v]);m&&m._node&&(m._node.muted=n?!0:m._muted)}return o},stop:function(){for(var n=this||e,o=0;o<n._howls.length;o++)n._howls[o].stop();return n},unload:function(){for(var n=this||e,o=n._howls.length-1;o>=0;o--)n._howls[o].unload();return n.usingWebAudio&&n.ctx&&typeof n.ctx.close!="undefined"&&(n.ctx.close(),n.ctx=null,h()),n},codecs:function(n){return(this||e)._codecs[n.replace(/^x-/,"")]},_setup:function(){var n=this||e;if(n.state=n.ctx&&n.ctx.state||"suspended",n._autoSuspend(),!n.usingWebAudio)if(typeof Audio!="undefined")try{var o=new Audio;typeof o.oncanplaythrough=="undefined"&&(n._canPlayEvent="canplay")}catch{n.noAudio=!0}else n.noAudio=!0;try{var o=new Audio;o.muted&&(n.noAudio=!0)}catch{}return n.noAudio||n._setupCodecs(),n},_setupCodecs:function(){var n=this||e,o=null;try{o=typeof Audio!="undefined"?new Audio:null}catch{return n}if(!o||typeof o.canPlayType!="function")return n;var f=o.canPlayType("audio/mpeg;").replace(/^no$/,""),p=n._navigator?n._navigator.userAgent:"",v=p.match(/OPR\/([0-6].)/g),m=v&&parseInt(v[0].split("/")[1],10)<33,_=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,g=p.match(/Version\/(.*?) /),y=_&&g&&parseInt(g[1],10)<15;return n._codecs={mp3:!!(!m&&(f||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!y&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!y&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},n},_unlockAudio:function(){var n=this||e;if(!(n._audioUnlocked||!n.ctx)){n._audioUnlocked=!1,n.autoUnlock=!1,!n._mobileUnloaded&&n.ctx.sampleRate!==44100&&(n._mobileUnloaded=!0,n.unload()),n._scratchBuffer=n.ctx.createBuffer(1,1,22050);var o=function(f){for(;n._html5AudioPool.length<n.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,n._releaseHtml5Audio(p)}catch{n.noAudio=!0;break}for(var v=0;v<n._howls.length;v++)if(!n._howls[v]._webAudio)for(var m=n._howls[v]._getSoundIds(),_=0;_<m.length;_++){var g=n._howls[v]._soundById(m[_]);g&&g._node&&!g._node._unlocked&&(g._node._unlocked=!0,g._node.load())}n._autoResume();var y=n.ctx.createBufferSource();y.buffer=n._scratchBuffer,y.connect(n.ctx.destination),typeof y.start=="undefined"?y.noteOn(0):y.start(0),typeof n.ctx.resume=="function"&&n.ctx.resume(),y.onended=function(){y.disconnect(0),n._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var k=0;k<n._howls.length;k++)n._howls[k]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),n}},_obtainHtml5Audio:function(){var n=this||e;if(n._html5AudioPool.length)return n._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise!="undefined"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(n){var o=this||e;return n._unlocked&&o._html5AudioPool.push(n),o},_autoSuspend:function(){var n=this;if(!(!n.autoSuspend||!n.ctx||typeof n.ctx.suspend=="undefined"||!e.usingWebAudio)){for(var o=0;o<n._howls.length;o++)if(n._howls[o]._webAudio){for(var f=0;f<n._howls[o]._sounds.length;f++)if(!n._howls[o]._sounds[f]._paused)return n}return n._suspendTimer&&clearTimeout(n._suspendTimer),n._suspendTimer=setTimeout(function(){if(!!n.autoSuspend){n._suspendTimer=null,n.state="suspending";var p=function(){n.state="suspended",n._resumeAfterSuspend&&(delete n._resumeAfterSuspend,n._autoResume())};n.ctx.suspend().then(p,p)}},3e4),n}},_autoResume:function(){var n=this;if(!(!n.ctx||typeof n.ctx.resume=="undefined"||!e.usingWebAudio))return n.state==="running"&&n.ctx.state!=="interrupted"&&n._suspendTimer?(clearTimeout(n._suspendTimer),n._suspendTimer=null):n.state==="suspended"||n.state==="running"&&n.ctx.state==="interrupted"?(n.ctx.resume().then(function(){n.state="running";for(var o=0;o<n._howls.length;o++)n._howls[o]._emit("resume")}),n._suspendTimer&&(clearTimeout(n._suspendTimer),n._suspendTimer=null)):n.state==="suspending"&&(n._resumeAfterSuspend=!0),n}};var e=new r,t=function(n){var o=this;if(!n.src||n.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(n)};t.prototype={init:function(n){var o=this;return e.ctx||h(),o._autoplay=n.autoplay||!1,o._format=typeof n.format!="string"?n.format:[n.format],o._html5=n.html5||!1,o._muted=n.mute||!1,o._loop=n.loop||!1,o._pool=n.pool||5,o._preload=typeof n.preload=="boolean"||n.preload==="metadata"?n.preload:!0,o._rate=n.rate||1,o._sprite=n.sprite||{},o._src=typeof n.src!="string"?n.src:[n.src],o._volume=n.volume!==void 0?n.volume:1,o._xhr={method:n.xhr&&n.xhr.method?n.xhr.method:"GET",headers:n.xhr&&n.xhr.headers?n.xhr.headers:null,withCredentials:n.xhr&&n.xhr.withCredentials?n.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=n.onend?[{fn:n.onend}]:[],o._onfade=n.onfade?[{fn:n.onfade}]:[],o._onload=n.onload?[{fn:n.onload}]:[],o._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[],o._onplayerror=n.onplayerror?[{fn:n.onplayerror}]:[],o._onpause=n.onpause?[{fn:n.onpause}]:[],o._onplay=n.onplay?[{fn:n.onplay}]:[],o._onstop=n.onstop?[{fn:n.onstop}]:[],o._onmute=n.onmute?[{fn:n.onmute}]:[],o._onvolume=n.onvolume?[{fn:n.onvolume}]:[],o._onrate=n.onrate?[{fn:n.onrate}]:[],o._onseek=n.onseek?[{fn:n.onseek}]:[],o._onunlock=n.onunlock?[{fn:n.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx!="undefined"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var n=this,o=null;if(e.noAudio){n._emit("loaderror",null,"No audio support.");return}typeof n._src=="string"&&(n._src=[n._src]);for(var f=0;f<n._src.length;f++){var p,v;if(n._format&&n._format[f])p=n._format[f];else{if(v=n._src[f],typeof v!="string"){n._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(v),p||(p=/\.([^.]+)$/.exec(v.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&e.codecs(p)){o=n._src[f];break}}if(!o){n._emit("loaderror",null,"No codec support for selected audio sources.");return}return n._src=o,n._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(n._html5=!0,n._webAudio=!1),new i(n),n._webAudio&&s(n),n},play:function(n,o){var f=this,p=null;if(typeof n=="number")p=n,n=null;else{if(typeof n=="string"&&f._state==="loaded"&&!f._sprite[n])return null;if(typeof n=="undefined"&&(n="__default",!f._playLock)){for(var v=0,m=0;m<f._sounds.length;m++)f._sounds[m]._paused&&!f._sounds[m]._ended&&(v++,p=f._sounds[m]._id);v===1?n=null:p=null}}var _=p?f._soundById(p):f._inactiveSound();if(!_)return null;if(p&&!n&&(n=_._sprite||"__default"),f._state!=="loaded"){_._sprite=n,_._ended=!1;var g=_._id;return f._queue.push({event:"play",action:function(){f.play(g)}}),g}if(p&&!_._paused)return o||f._loadQueue("play"),_._id;f._webAudio&&e._autoResume();var y=Math.max(0,_._seek>0?_._seek:f._sprite[n][0]/1e3),k=Math.max(0,(f._sprite[n][0]+f._sprite[n][1])/1e3-y),M=k*1e3/Math.abs(_._rate),P=f._sprite[n][0]/1e3,G=(f._sprite[n][0]+f._sprite[n][1])/1e3;_._sprite=n,_._ended=!1;var se=function(){_._paused=!1,_._seek=y,_._start=P,_._stop=G,_._loop=!!(_._loop||f._sprite[n][2])};if(y>=G){f._ended(_);return}var B=_._node;if(f._webAudio){var Ie=function(){f._playLock=!1,se(),f._refreshBuffer(_);var O=_._muted||f._muted?0:_._volume;B.gain.setValueAtTime(O,e.ctx.currentTime),_._playStart=e.ctx.currentTime,typeof B.bufferSource.start=="undefined"?_._loop?B.bufferSource.noteGrainOn(0,y,86400):B.bufferSource.noteGrainOn(0,y,k):_._loop?B.bufferSource.start(0,y,86400):B.bufferSource.start(0,y,k),M!==1/0&&(f._endTimers[_._id]=setTimeout(f._ended.bind(f,_),M)),o||setTimeout(function(){f._emit("play",_._id),f._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?Ie():(f._playLock=!0,f.once("resume",Ie),f._clearTimer(_._id))}else{var Ee=function(){B.currentTime=y,B.muted=_._muted||f._muted||e._muted||B.muted,B.volume=_._volume*e.volume(),B.playbackRate=_._rate;try{var O=B.play();if(O&&typeof Promise!="undefined"&&(O instanceof Promise||typeof O.then=="function")?(f._playLock=!0,se(),O.then(function(){f._playLock=!1,B._unlocked=!0,o?f._loadQueue():f._emit("play",_._id)}).catch(function(){f._playLock=!1,f._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),_._ended=!0,_._paused=!0})):o||(f._playLock=!1,se(),f._emit("play",_._id)),B.playbackRate=_._rate,B.paused){f._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}n!=="__default"||_._loop?f._endTimers[_._id]=setTimeout(f._ended.bind(f,_),M):(f._endTimers[_._id]=function(){f._ended(_),B.removeEventListener("ended",f._endTimers[_._id],!1)},B.addEventListener("ended",f._endTimers[_._id],!1))}catch(L){f._emit("playerror",_._id,L)}};B.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(B.src=f._src,B.load());var Me=window&&window.ejecta||!B.readyState&&e._navigator.isCocoonJS;if(B.readyState>=3||Me)Ee();else{f._playLock=!0,f._state="loading";var Se=function(){f._state="loaded",Ee(),B.removeEventListener(e._canPlayEvent,Se,!1)};B.addEventListener(e._canPlayEvent,Se,!1),f._clearTimer(_._id)}}return _._id},pause:function(n){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(n)}}),o;for(var f=o._getSoundIds(n),p=0;p<f.length;p++){o._clearTimer(f[p]);var v=o._soundById(f[p]);if(v&&!v._paused&&(v._seek=o.seek(f[p]),v._rateSeek=0,v._paused=!0,o._stopFade(f[p]),v._node))if(o._webAudio){if(!v._node.bufferSource)continue;typeof v._node.bufferSource.stop=="undefined"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),o._cleanBuffer(v._node)}else(!isNaN(v._node.duration)||v._node.duration===1/0)&&v._node.pause();arguments[1]||o._emit("pause",v?v._id:null)}return o},stop:function(n,o){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(n)}}),f;for(var p=f._getSoundIds(n),v=0;v<p.length;v++){f._clearTimer(p[v]);var m=f._soundById(p[v]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,f._stopFade(p[v]),m._node&&(f._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop=="undefined"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),f._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&f._clearSound(m._node))),o||f._emit("stop",m._id))}return f},mute:function(n,o){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(n,o)}}),f;if(typeof o=="undefined")if(typeof n=="boolean")f._muted=n;else return f._muted;for(var p=f._getSoundIds(o),v=0;v<p.length;v++){var m=f._soundById(p[v]);m&&(m._muted=n,m._interval&&f._stopFade(m._id),f._webAudio&&m._node?m._node.gain.setValueAtTime(n?0:m._volume,e.ctx.currentTime):m._node&&(m._node.muted=e._muted?!0:n),f._emit("mute",m._id))}return f},volume:function(){var n=this,o=arguments,f,p;if(o.length===0)return n._volume;if(o.length===1||o.length===2&&typeof o[1]=="undefined"){var v=n._getSoundIds(),m=v.indexOf(o[0]);m>=0?p=parseInt(o[0],10):f=parseFloat(o[0])}else o.length>=2&&(f=parseFloat(o[0]),p=parseInt(o[1],10));var _;if(typeof f!="undefined"&&f>=0&&f<=1){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;typeof p=="undefined"&&(n._volume=f),p=n._getSoundIds(p);for(var g=0;g<p.length;g++)_=n._soundById(p[g]),_&&(_._volume=f,o[2]||n._stopFade(p[g]),n._webAudio&&_._node&&!_._muted?_._node.gain.setValueAtTime(f,e.ctx.currentTime):_._node&&!_._muted&&(_._node.volume=f*e.volume()),n._emit("volume",_._id))}else return _=p?n._soundById(p):n._sounds[0],_?_._volume:0;return n},fade:function(n,o,f,p){var v=this;if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"fade",action:function(){v.fade(n,o,f,p)}}),v;n=Math.min(Math.max(0,parseFloat(n)),1),o=Math.min(Math.max(0,parseFloat(o)),1),f=parseFloat(f),v.volume(n,p);for(var m=v._getSoundIds(p),_=0;_<m.length;_++){var g=v._soundById(m[_]);if(g){if(p||v._stopFade(m[_]),v._webAudio&&!g._muted){var y=e.ctx.currentTime,k=y+f/1e3;g._volume=n,g._node.gain.setValueAtTime(n,y),g._node.gain.linearRampToValueAtTime(o,k)}v._startFadeInterval(g,n,o,f,m[_],typeof p=="undefined")}}return v},_startFadeInterval:function(n,o,f,p,v,m){var _=this,g=o,y=f-o,k=Math.abs(y/.01),M=Math.max(4,k>0?p/k:p),P=Date.now();n._fadeTo=f,n._interval=setInterval(function(){var G=(Date.now()-P)/p;P=Date.now(),g+=y*G,g=Math.round(g*100)/100,y<0?g=Math.max(f,g):g=Math.min(f,g),_._webAudio?n._volume=g:_.volume(g,n._id,!0),m&&(_._volume=g),(f<o&&g<=f||f>o&&g>=f)&&(clearInterval(n._interval),n._interval=null,n._fadeTo=null,_.volume(f,n._id),_._emit("fade",n._id))},M)},_stopFade:function(n){var o=this,f=o._soundById(n);return f&&f._interval&&(o._webAudio&&f._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(f._interval),f._interval=null,o.volume(f._fadeTo,n),f._fadeTo=null,o._emit("fade",n)),o},loop:function(){var n=this,o=arguments,f,p,v;if(o.length===0)return n._loop;if(o.length===1)if(typeof o[0]=="boolean")f=o[0],n._loop=f;else return v=n._soundById(parseInt(o[0],10)),v?v._loop:!1;else o.length===2&&(f=o[0],p=parseInt(o[1],10));for(var m=n._getSoundIds(p),_=0;_<m.length;_++)v=n._soundById(m[_]),v&&(v._loop=f,n._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=f,f&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop,n.playing(m[_])&&(n.pause(m[_],!0),n.play(m[_],!0)))));return n},rate:function(){var n=this,o=arguments,f,p;if(o.length===0)p=n._sounds[0]._id;else if(o.length===1){var v=n._getSoundIds(),m=v.indexOf(o[0]);m>=0?p=parseInt(o[0],10):f=parseFloat(o[0])}else o.length===2&&(f=parseFloat(o[0]),p=parseInt(o[1],10));var _;if(typeof f=="number"){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;typeof p=="undefined"&&(n._rate=f),p=n._getSoundIds(p);for(var g=0;g<p.length;g++)if(_=n._soundById(p[g]),_){n.playing(p[g])&&(_._rateSeek=n.seek(p[g]),_._playStart=n._webAudio?e.ctx.currentTime:_._playStart),_._rate=f,n._webAudio&&_._node&&_._node.bufferSource?_._node.bufferSource.playbackRate.setValueAtTime(f,e.ctx.currentTime):_._node&&(_._node.playbackRate=f);var y=n.seek(p[g]),k=(n._sprite[_._sprite][0]+n._sprite[_._sprite][1])/1e3-y,M=k*1e3/Math.abs(_._rate);(n._endTimers[p[g]]||!_._paused)&&(n._clearTimer(p[g]),n._endTimers[p[g]]=setTimeout(n._ended.bind(n,_),M)),n._emit("rate",_._id)}}else return _=n._soundById(p),_?_._rate:n._rate;return n},seek:function(){var n=this,o=arguments,f,p;if(o.length===0)n._sounds.length&&(p=n._sounds[0]._id);else if(o.length===1){var v=n._getSoundIds(),m=v.indexOf(o[0]);m>=0?p=parseInt(o[0],10):n._sounds.length&&(p=n._sounds[0]._id,f=parseFloat(o[0]))}else o.length===2&&(f=parseFloat(o[0]),p=parseInt(o[1],10));if(typeof p=="undefined")return 0;if(typeof f=="number"&&(n._state!=="loaded"||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var _=n._soundById(p);if(_)if(typeof f=="number"&&f>=0){var g=n.playing(p);g&&n.pause(p,!0),_._seek=f,_._ended=!1,n._clearTimer(p),!n._webAudio&&_._node&&!isNaN(_._node.duration)&&(_._node.currentTime=f);var y=function(){g&&n.play(p,!0),n._emit("seek",p)};if(g&&!n._webAudio){var k=function(){n._playLock?setTimeout(k,0):y()};setTimeout(k,0)}else y()}else if(n._webAudio){var M=n.playing(p)?e.ctx.currentTime-_._playStart:0,P=_._rateSeek?_._rateSeek-_._seek:0;return _._seek+(P+M*Math.abs(_._rate))}else return _._node.currentTime;return n},playing:function(n){var o=this;if(typeof n=="number"){var f=o._soundById(n);return f?!f._paused:!1}for(var p=0;p<o._sounds.length;p++)if(!o._sounds[p]._paused)return!0;return!1},duration:function(n){var o=this,f=o._duration,p=o._soundById(n);return p&&(f=o._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var n=this,o=n._sounds,f=0;f<o.length;f++)o[f]._paused||n.stop(o[f]._id),n._webAudio||(n._clearSound(o[f]._node),o[f]._node.removeEventListener("error",o[f]._errorFn,!1),o[f]._node.removeEventListener(e._canPlayEvent,o[f]._loadFn,!1),o[f]._node.removeEventListener("ended",o[f]._endFn,!1),e._releaseHtml5Audio(o[f]._node)),delete o[f]._node,n._clearTimer(o[f]._id);var p=e._howls.indexOf(n);p>=0&&e._howls.splice(p,1);var v=!0;for(f=0;f<e._howls.length;f++)if(e._howls[f]._src===n._src||n._src.indexOf(e._howls[f]._src)>=0){v=!1;break}return a&&v&&delete a[n._src],e.noAudio=!1,n._state="unloaded",n._sounds=[],n=null,null},on:function(n,o,f,p){var v=this,m=v["_on"+n];return typeof o=="function"&&m.push(p?{id:f,fn:o,once:p}:{id:f,fn:o}),v},off:function(n,o,f){var p=this,v=p["_on"+n],m=0;if(typeof o=="number"&&(f=o,o=null),o||f)for(m=0;m<v.length;m++){var _=f===v[m].id;if(o===v[m].fn&&_||!o&&_){v.splice(m,1);break}}else if(n)p["_on"+n]=[];else{var g=Object.keys(p);for(m=0;m<g.length;m++)g[m].indexOf("_on")===0&&Array.isArray(p[g[m]])&&(p[g[m]]=[])}return p},once:function(n,o,f){var p=this;return p.on(n,o,f,1),p},_emit:function(n,o,f){for(var p=this,v=p["_on"+n],m=v.length-1;m>=0;m--)(!v[m].id||v[m].id===o||n==="load")&&(setTimeout(function(_){_.call(this,o,f)}.bind(p,v[m].fn),0),v[m].once&&p.off(n,v[m].fn,v[m].id));return p._loadQueue(n),p},_loadQueue:function(n){var o=this;if(o._queue.length>0){var f=o._queue[0];f.event===n&&(o._queue.shift(),o._loadQueue()),n||f.action()}return o},_ended:function(n){var o=this,f=n._sprite;if(!o._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(o._ended.bind(o,n),100),o;var p=!!(n._loop||o._sprite[f][2]);if(o._emit("end",n._id),!o._webAudio&&p&&o.stop(n._id,!0).play(n._id),o._webAudio&&p){o._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=e.ctx.currentTime;var v=(n._stop-n._start)*1e3/Math.abs(n._rate);o._endTimers[n._id]=setTimeout(o._ended.bind(o,n),v)}return o._webAudio&&!p&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,o._clearTimer(n._id),o._cleanBuffer(n._node),e._autoSuspend()),!o._webAudio&&!p&&o.stop(n._id,!0),o},_clearTimer:function(n){var o=this;if(o._endTimers[n]){if(typeof o._endTimers[n]!="function")clearTimeout(o._endTimers[n]);else{var f=o._soundById(n);f&&f._node&&f._node.removeEventListener("ended",o._endTimers[n],!1)}delete o._endTimers[n]}return o},_soundById:function(n){for(var o=this,f=0;f<o._sounds.length;f++)if(n===o._sounds[f]._id)return o._sounds[f];return null},_inactiveSound:function(){var n=this;n._drain();for(var o=0;o<n._sounds.length;o++)if(n._sounds[o]._ended)return n._sounds[o].reset();return new i(n)},_drain:function(){var n=this,o=n._pool,f=0,p=0;if(!(n._sounds.length<o)){for(p=0;p<n._sounds.length;p++)n._sounds[p]._ended&&f++;for(p=n._sounds.length-1;p>=0;p--){if(f<=o)return;n._sounds[p]._ended&&(n._webAudio&&n._sounds[p]._node&&n._sounds[p]._node.disconnect(0),n._sounds.splice(p,1),f--)}}},_getSoundIds:function(n){var o=this;if(typeof n=="undefined"){for(var f=[],p=0;p<o._sounds.length;p++)f.push(o._sounds[p]._id);return f}else return[n]},_refreshBuffer:function(n){var o=this;return n._node.bufferSource=e.ctx.createBufferSource(),n._node.bufferSource.buffer=a[o._src],n._panner?n._node.bufferSource.connect(n._panner):n._node.bufferSource.connect(n._node),n._node.bufferSource.loop=n._loop,n._loop&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop||0),n._node.bufferSource.playbackRate.setValueAtTime(n._rate,e.ctx.currentTime),o},_cleanBuffer:function(n){var o=this,f=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&n.bufferSource&&(n.bufferSource.onended=null,n.bufferSource.disconnect(0),f))try{n.bufferSource.buffer=e._scratchBuffer}catch{}return n.bufferSource=null,o},_clearSound:function(n){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(n.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(n){this._parent=n,this.init()};i.prototype={init:function(){var n=this,o=n._parent;return n._muted=o._muted,n._loop=o._loop,n._volume=o._volume,n._rate=o._rate,n._seek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,o._sounds.push(n),n.create(),n},create:function(){var n=this,o=n._parent,f=e._muted||n._muted||n._parent._muted?0:n._volume;return o._webAudio?(n._node=typeof e.ctx.createGain=="undefined"?e.ctx.createGainNode():e.ctx.createGain(),n._node.gain.setValueAtTime(f,e.ctx.currentTime),n._node.paused=!0,n._node.connect(e.masterGain)):e.noAudio||(n._node=e._obtainHtml5Audio(),n._errorFn=n._errorListener.bind(n),n._node.addEventListener("error",n._errorFn,!1),n._loadFn=n._loadListener.bind(n),n._node.addEventListener(e._canPlayEvent,n._loadFn,!1),n._endFn=n._endListener.bind(n),n._node.addEventListener("ended",n._endFn,!1),n._node.src=o._src,n._node.preload=o._preload===!0?"auto":o._preload,n._node.volume=f*e.volume(),n._node.load()),n},reset:function(){var n=this,o=n._parent;return n._muted=o._muted,n._loop=o._loop,n._volume=o._volume,n._rate=o._rate,n._seek=0,n._rateSeek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,n},_errorListener:function(){var n=this;n._parent._emit("loaderror",n._id,n._node.error?n._node.error.code:0),n._node.removeEventListener("error",n._errorFn,!1)},_loadListener:function(){var n=this,o=n._parent;o._duration=Math.ceil(n._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),n._node.removeEventListener(e._canPlayEvent,n._loadFn,!1)},_endListener:function(){var n=this,o=n._parent;o._duration===1/0&&(o._duration=Math.ceil(n._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(n)),n._node.removeEventListener("ended",n._endFn,!1)}};var a={},s=function(n){var o=n._src;if(a[o]){n._duration=a[o].duration,d(n);return}if(/^data:[^;]+;base64,/.test(o)){for(var f=atob(o.split(",")[1]),p=new Uint8Array(f.length),v=0;v<f.length;++v)p[v]=f.charCodeAt(v);c(p.buffer,n)}else{var m=new XMLHttpRequest;m.open(n._xhr.method,o,!0),m.withCredentials=n._xhr.withCredentials,m.responseType="arraybuffer",n._xhr.headers&&Object.keys(n._xhr.headers).forEach(function(_){m.setRequestHeader(_,n._xhr.headers[_])}),m.onload=function(){var _=(m.status+"")[0];if(_!=="0"&&_!=="2"&&_!=="3"){n._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}c(m.response,n)},m.onerror=function(){n._webAudio&&(n._html5=!0,n._webAudio=!1,n._sounds=[],delete a[o],n.load())},u(m)}},u=function(n){try{n.send()}catch{n.onerror()}},c=function(n,o){var f=function(){o._emit("loaderror",null,"Decoding audio data failed.")},p=function(v){v&&o._sounds.length>0?(a[o._src]=v,d(o,v)):f()};typeof Promise!="undefined"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(n).then(p).catch(f):e.ctx.decodeAudioData(n,p,f)},d=function(n,o){o&&!n._duration&&(n._duration=o.duration),Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue())},h=function(){if(!!e.usingWebAudio){try{typeof AudioContext!="undefined"?e.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var n=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=o?parseInt(o[1],10):null;if(n&&f&&f<9){var p=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!p&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain=="undefined"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};l.Howler=e,l.Howl=t,typeof ye!="undefined"?(ye.HowlerGlobal=r,ye.Howler=e,ye.Howl=t,ye.Sound=i):typeof window!="undefined"&&(window.HowlerGlobal=r,window.Howler=e,window.Howl=t,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var i=t._howls.length-1;i>=0;i--)t._howls[i].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;if(t=typeof t!="number"?a._pos[1]:t,i=typeof i!="number"?a._pos[2]:i,typeof e=="number")a._pos=[e,t,i],typeof a.ctx.listener.positionX!="undefined"?(a.ctx.listener.positionX.setTargetAtTime(a._pos[0],Howler.ctx.currentTime,.1),a.ctx.listener.positionY.setTargetAtTime(a._pos[1],Howler.ctx.currentTime,.1),a.ctx.listener.positionZ.setTargetAtTime(a._pos[2],Howler.ctx.currentTime,.1)):a.ctx.listener.setPosition(a._pos[0],a._pos[1],a._pos[2]);else return a._pos;return a},HowlerGlobal.prototype.orientation=function(e,t,i,a,s,u){var c=this;if(!c.ctx||!c.ctx.listener)return c;var d=c._orientation;if(t=typeof t!="number"?d[1]:t,i=typeof i!="number"?d[2]:i,a=typeof a!="number"?d[3]:a,s=typeof s!="number"?d[4]:s,u=typeof u!="number"?d[5]:u,typeof e=="number")c._orientation=[e,t,i,a,s,u],typeof c.ctx.listener.forwardX!="undefined"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(u,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,t,i,a,s,u);else return d;return c},Howl.prototype.init=function(e){return function(t){var i=this;return i._orientation=t.orientation||[1,0,0],i._stereo=t.stereo||null,i._pos=t.pos||null,i._pannerAttr={coneInnerAngle:typeof t.coneInnerAngle!="undefined"?t.coneInnerAngle:360,coneOuterAngle:typeof t.coneOuterAngle!="undefined"?t.coneOuterAngle:360,coneOuterGain:typeof t.coneOuterGain!="undefined"?t.coneOuterGain:0,distanceModel:typeof t.distanceModel!="undefined"?t.distanceModel:"inverse",maxDistance:typeof t.maxDistance!="undefined"?t.maxDistance:1e4,panningModel:typeof t.panningModel!="undefined"?t.panningModel:"HRTF",refDistance:typeof t.refDistance!="undefined"?t.refDistance:1,rolloffFactor:typeof t.rolloffFactor!="undefined"?t.rolloffFactor:1},i._onstereo=t.onstereo?[{fn:t.onstereo}]:[],i._onpos=t.onpos?[{fn:t.onpos}]:[],i._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,t){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,t)}}),i;var a=typeof Howler.ctx.createStereoPanner=="undefined"?"spatial":"stereo";if(typeof t=="undefined")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var s=i._getSoundIds(t),u=0;u<s.length;u++){var c=i._soundById(s[u]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&r(c,a),a==="spatial"?typeof c._panner.positionX!="undefined"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",c._id);else return c._stereo}return i},Howl.prototype.pos=function(e,t,i,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(e,t,i,a)}}),s;if(t=typeof t!="number"?0:t,i=typeof i!="number"?-.5:i,typeof a=="undefined")if(typeof e=="number")s._pos=[e,t,i];else return s._pos;for(var u=s._getSoundIds(a),c=0;c<u.length;c++){var d=s._soundById(u[c]);if(d)if(typeof e=="number")d._pos=[e,t,i],d._node&&((!d._panner||d._panner.pan)&&r(d,"spatial"),typeof d._panner.positionX!="undefined"?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):d._panner.setPosition(e,t,i)),s._emit("pos",d._id);else return d._pos}return s},Howl.prototype.orientation=function(e,t,i,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(e,t,i,a)}}),s;if(t=typeof t!="number"?s._orientation[1]:t,i=typeof i!="number"?s._orientation[2]:i,typeof a=="undefined")if(typeof e=="number")s._orientation=[e,t,i];else return s._orientation;for(var u=s._getSoundIds(a),c=0;c<u.length;c++){var d=s._soundById(u[c]);if(d)if(typeof e=="number")d._orientation=[e,t,i],d._node&&(d._panner||(d._pos||(d._pos=s._pos||[0,0,-.5]),r(d,"spatial")),typeof d._panner.orientationX!="undefined"?(d._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),d._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):d._panner.setOrientation(e,t,i)),s._emit("orientation",d._id);else return d._orientation}return s},Howl.prototype.pannerAttr=function(){var e=this,t=arguments,i,a,s;if(!e._webAudio)return e;if(t.length===0)return e._pannerAttr;if(t.length===1)if(typeof t[0]=="object")i=t[0],typeof a=="undefined"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle!="undefined"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle!="undefined"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain!="undefined"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel!="undefined"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance!="undefined"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance!="undefined"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor!="undefined"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel!="undefined"?i.pannerAttr.panningModel:e._panningModel});else return s=e._soundById(parseInt(t[0],10)),s?s._pannerAttr:e._pannerAttr;else t.length===2&&(i=t[0],a=parseInt(t[1],10));for(var u=e._getSoundIds(a),c=0;c<u.length;c++)if(s=e._soundById(u[c]),s){var d=s._pannerAttr;d={coneInnerAngle:typeof i.coneInnerAngle!="undefined"?i.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle!="undefined"?i.coneOuterAngle:d.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain!="undefined"?i.coneOuterGain:d.coneOuterGain,distanceModel:typeof i.distanceModel!="undefined"?i.distanceModel:d.distanceModel,maxDistance:typeof i.maxDistance!="undefined"?i.maxDistance:d.maxDistance,refDistance:typeof i.refDistance!="undefined"?i.refDistance:d.refDistance,rolloffFactor:typeof i.rolloffFactor!="undefined"?i.rolloffFactor:d.rolloffFactor,panningModel:typeof i.panningModel!="undefined"?i.panningModel:d.panningModel};var h=s._panner;h?(h.coneInnerAngle=d.coneInnerAngle,h.coneOuterAngle=d.coneOuterAngle,h.coneOuterGain=d.coneOuterGain,h.distanceModel=d.distanceModel,h.maxDistance=d.maxDistance,h.refDistance=d.refDistance,h.rolloffFactor=d.rolloffFactor,h.panningModel=d.panningModel):(s._pos||(s._pos=e._pos||[0,0,-.5]),r(s,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var t=this,i=t._parent;t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this),t._stereo?i.stereo(t._stereo):t._pos&&i.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,i=t._parent;return t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,t._stereo?i.stereo(t._stereo):t._pos?i.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,i._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var r=function(e,t){t=t||"spatial",t==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX!="undefined"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX!="undefined"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(zt);function Fi(l,r,e){let{soundFile:t=!1}=r,i=!1,a={};const s=()=>{a&&a.playing&&(a.stop(),a.unload(),a={})};return Ft(async()=>{s()}),l.$$set=u=>{"soundFile"in u&&e(0,t=u.soundFile)},l.$$.update=()=>{l.$$.dirty&3&&t&&(e(1,i="https://cdn.sanity.io/files/58ueii0w/production/"+te(t,"asset._ref","").replace("file-","").replace("-mp3",".mp3")),s(),a=new zt.Howl({src:[i],loop:!0,autoplay:!0}))},[t,i]}class Li extends K{constructor(r){super(),Q(this,r,Fi,null,z,{soundFile:0})}}function ft(l){let r,e;return{c(){r=E("img"),this.h()},l(t){r=S(t,"IMG",{src:!0}),this.h()},h(){Z(r.src,e=me(l[0].iconImage).quality(100).height(100).url())||b(r,"src",e)},m(t,i){T(t,r,i)},p(t,i){i&1&&!Z(r.src,e=me(t[0].iconImage).quality(100).height(100).url())&&b(r,"src",e)},d(t){t&&w(r)}}}function ji(l){let r,e,t,i,a,s=l[0].iconImage&&ft(l);return{c(){r=E("div"),s&&s.c(),this.h()},l(u){r=S(u,"DIV",{class:!0,id:!0,alt:!0,style:!0});var c=$(r);s&&s.l(c),c.forEach(w),this.h()},h(){b(r,"class","portal svelte-1ulo7kp"),b(r,"id",e=l[0]._id),b(r,"alt",t=l[0].title),b(r,"style",l[2])},m(u,c){T(u,r,c),s&&s.m(r,null),l[5](r),a=!0},p(u,[c]){u[0].iconImage?s?s.p(u,c):(s=ft(u),s.c(),s.m(r,null)):s&&(s.d(1),s=null),(!a||c&1&&e!==(e=u[0]._id))&&b(r,"id",e),(!a||c&1&&t!==(t=u[0].title))&&b(r,"alt",t)},i(u){a||(ce(()=>{i||(i=ne(r,re,{},!0)),i.run(1)}),a=!0)},o(u){i||(i=ne(r,re,{},!1)),i.run(0),a=!1},d(u){u&&w(r),s&&s.d(),l[5](null),u&&i&&i.end()}}}function Hi(l,r,e){let t;J(l,ke,n=>e(4,t=n));let{portal:i={}}=r,a={},s={},u=i.y*R,c=i.x*R;const d=`transform: translateY(${u}px) translateX(${c}px); width: ${R}px; height: ${R}px; background-color: ${te(i,"backgroundColor.hex","")}; background-image: url("${te(i,"bgImageUrl","")}");"`;ve(async()=>{e(3,s=tippy(a,{content:"door to "+te(i,"targetArea.title",""),arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,sticky:!0,trigger:"manual",flip:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}))});function h(n){be[n?"unshift":"push"](()=>{a=n,e(1,a)})}return l.$$set=n=>{"portal"in n&&e(0,i=n.portal)},l.$$.update=()=>{l.$$.dirty&24&&s.popper&&(t?s.show():s.hide())},[i,a,d,s,t,h]}class Ci extends K{constructor(r){super(),Q(this,r,Hi,ji,z,{portal:0})}}function ct(l,r,e){const t=l.slice();return t[1]=r[e],t}function dt(l,r){let e,t,i;return t=new Ci({props:{portal:r[1]}}),{key:l,first:null,c(){e=V(),N(t.$$.fragment),this.h()},l(a){e=V(),U(t.$$.fragment,a),this.h()},h(){this.first=e},m(a,s){T(a,e,s),X(t,a,s),i=!0},p(a,s){r=a;const u={};s&1&&(u.portal=r[1]),t.$set(u)},i(a){i||(A(t.$$.fragment,a),i=!0)},o(a){I(t.$$.fragment,a),i=!1},d(a){a&&w(e),W(t,a)}}}function Gi(l){let r=[],e=new Map,t,i,a=l[0];const s=u=>u[1]._id;for(let u=0;u<a.length;u+=1){let c=ct(l,a,u),d=s(c);e.set(d,r[u]=dt(d,c))}return{c(){for(let u=0;u<r.length;u+=1)r[u].c();t=V()},l(u){for(let c=0;c<r.length;c+=1)r[c].l(u);t=V()},m(u,c){for(let d=0;d<r.length;d+=1)r[d].m(u,c);T(u,t,c),i=!0},p(u,[c]){c&1&&(a=u[0],x(),r=Oe(r,c,s,1,u,a,e,t.parentNode,De,dt,t,ct),q())},i(u){if(!i){for(let c=0;c<a.length;c+=1)A(r[c]);i=!0}},o(u){for(let c=0;c<r.length;c+=1)I(r[c]);i=!1},d(u){for(let c=0;c<r.length;c+=1)r[c].d(u);u&&w(t)}}}function Ri(l,r,e){let{portals:t={}}=r;return l.$$set=i=>{"portals"in i&&e(0,t=i.portals)},[t]}class xi extends K{constructor(r){super(),Q(this,r,Ri,Gi,z,{portals:0})}}function qi(l){let r,e;return{c(){r=E("div"),this.h()},l(t){r=S(t,"DIV",{class:!0,style:!0}),$(r).forEach(w),this.h()},h(){b(r,"class","target svelte-sfd7q3"),b(r,"style",e="top: "+l[1]+"px; left: "+l[0]+"px;")},m(t,i){T(t,r,i)},p(t,[i]){i&3&&e!==(e="top: "+t[1]+"px; left: "+t[0]+"px;")&&b(r,"style",e)},i:le,o:le,d(t){t&&w(r)}}}function Ni(l,r,e){let{x:t=0}=r,{y:i=0}=r;return l.$$set=a=>{"x"in a&&e(0,t=a.x),"y"in a&&e(1,i=a.y)},[t,i]}class Ui extends K{constructor(r){super(),Q(this,r,Ni,qi,z,{x:0,y:1})}}function Xi(l){let r,e,t;return{c(){r=E("div"),e=E("iframe"),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);e=S(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,color:!0,allow:!0,sandbox:!0,class:!0}),$(e).forEach(w),a.forEach(w),this.h()},h(){b(e,"width","720"),b(e,"height","480"),Z(e.src,t=l[0])||b(e,"src",t),b(e,"frameborder","no"),b(e,"color","#ffffff"),b(e,"allow","autoplay; fullscreen"),b(e,"sandbox","allow-same-origin allow-scripts allow-popups"),e.allowFullscreen=!0,b(e,"class","svelte-ldmhir"),b(r,"class","peertube-container svelte-ldmhir")},m(i,a){T(i,r,a),D(r,e)},p(i,a){a&1&&!Z(e.src,t=i[0])&&b(e,"src",t)},d(i){i&&w(r)}}}function Wi(l){let r,e,t;return{c(){r=E("div"),e=E("iframe"),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);e=S(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,scrolling:!0,byline:!0,color:!0,allow:!0,class:!0}),$(e).forEach(w),a.forEach(w),this.h()},h(){b(e,"width","720"),b(e,"height","480"),Z(e.src,t="https://player.vimeo.com/video/"+he(l[0]).id+"?autoplay=1")||b(e,"src",t),b(e,"frameborder","no"),b(e,"scrolling","no"),b(e,"byline","false"),b(e,"color","#ffffff"),b(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,b(e,"class","svelte-ldmhir"),b(r,"class","vimeo-container svelte-ldmhir")},m(i,a){T(i,r,a),D(r,e)},p(i,a){a&1&&!Z(e.src,t="https://player.vimeo.com/video/"+he(i[0]).id+"?autoplay=1")&&b(e,"src",t)},d(i){i&&w(r)}}}function Yi(l){let r,e,t;return{c(){r=E("div"),e=E("iframe"),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);e=S(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,allow:!0,class:!0}),$(e).forEach(w),a.forEach(w),this.h()},h(){b(e,"width","1920"),b(e,"height","1280"),Z(e.src,t="https://www.youtube.com/embed/"+he(l[0]).id+"?autoplay=1&rel=0&color=white")||b(e,"src",t),b(e,"frameborder","no"),b(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,b(e,"class","svelte-ldmhir"),b(r,"class","youtube-container svelte-ldmhir")},m(i,a){T(i,r,a),D(r,e)},p(i,a){a&1&&!Z(e.src,t="https://www.youtube.com/embed/"+he(i[0]).id+"?autoplay=1&rel=0&color=white")&&b(e,"src",t)},d(i){i&&w(r)}}}function Zi(l){let r,e,t,i,a,s,u;function c(n,o){if(o&1&&(t=null),o&1&&(i=null),o&1&&(a=null),t==null&&(t=!!(n[0].includes("youtube")||n[0].includes("youtu.be"))),t)return Yi;if(i==null&&(i=!!n[0].includes("vimeo")),i)return Wi;if(a==null&&(a=!!n[0].includes("undersco.re")),a)return Xi}let d=c(l,-1),h=d&&d(l);return{c(){r=E("div"),e=E("div"),h&&h.c(),this.h()},l(n){r=S(n,"DIV",{class:!0});var o=$(r);e=S(o,"DIV",{class:!0});var f=$(e);h&&h.l(f),f.forEach(w),o.forEach(w),this.h()},h(){b(e,"class","embed svelte-ldmhir"),b(r,"class","stream-container svelte-ldmhir")},m(n,o){T(n,r,o),D(r,e),h&&h.m(e,null),u=!0},p(n,[o]){l=n,d===(d=c(l,o))&&h?h.p(l,o):(h&&h.d(1),h=d&&d(l),h&&(h.c(),h.m(e,null)))},i(n){u||(ce(()=>{s||(s=ne(r,re,{duration:300,easing:Ve},!0)),s.run(1)}),u=!0)},o(n){s||(s=ne(r,re,{duration:300,easing:Ve},!1)),s.run(0),u=!1},d(n){n&&w(r),h&&h.d(),n&&s&&s.end()}}}function Ki(l,r,e){let{streamUrl:t=""}=r;return l.$$set=i=>{"streamUrl"in i&&e(0,t=i.streamUrl)},[t]}class Qi extends K{constructor(r){super(),Q(this,r,Ki,Zi,z,{streamUrl:0})}}function zi(l){let r,e,t;return{c(){r=E("div"),e=E("iframe"),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);e=S(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,color:!0,allow:!0,sandbox:!0,class:!0}),$(e).forEach(w),a.forEach(w),this.h()},h(){b(e,"width","720"),b(e,"height","480"),Z(e.src,t=l[0])||b(e,"src",t),b(e,"frameborder","no"),b(e,"color","#ffffff"),b(e,"allow","autoplay; fullscreen"),b(e,"sandbox","allow-same-origin allow-scripts allow-popups"),e.allowFullscreen=!0,b(e,"class","svelte-174tb22"),b(r,"class","peertube-container svelte-174tb22")},m(i,a){T(i,r,a),D(r,e)},p(i,a){a&1&&!Z(e.src,t=i[0])&&b(e,"src",t)},d(i){i&&w(r)}}}function Ji(l){let r,e,t;return{c(){r=E("div"),e=E("iframe"),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);e=S(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,scrolling:!0,byline:!0,color:!0,allow:!0,class:!0}),$(e).forEach(w),a.forEach(w),this.h()},h(){b(e,"width","720"),b(e,"height","480"),Z(e.src,t="https://player.vimeo.com/video/"+he(l[0]).id)||b(e,"src",t),b(e,"frameborder","no"),b(e,"scrolling","no"),b(e,"byline","false"),b(e,"color","#ffffff"),b(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,b(e,"class","svelte-174tb22"),b(r,"class","vimeo-container svelte-174tb22")},m(i,a){T(i,r,a),D(r,e)},p(i,a){a&1&&!Z(e.src,t="https://player.vimeo.com/video/"+he(i[0]).id)&&b(e,"src",t)},d(i){i&&w(r)}}}function ea(l){let r,e,t;return{c(){r=E("div"),e=E("iframe"),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);e=S(a,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,allow:!0,class:!0}),$(e).forEach(w),a.forEach(w),this.h()},h(){b(e,"width","1920"),b(e,"height","1280"),Z(e.src,t="https://www.youtube.com/embed/"+he(l[0]).id+"?rel=0&color=white")||b(e,"src",t),b(e,"frameborder","no"),b(e,"allow","autoplay; fullscreen"),e.allowFullscreen=!0,b(e,"class","svelte-174tb22"),b(r,"class","youtube-container svelte-174tb22")},m(i,a){T(i,r,a),D(r,e)},p(i,a){a&1&&!Z(e.src,t="https://www.youtube.com/embed/"+he(i[0]).id+"?rel=0&color=white")&&b(e,"src",t)},d(i){i&&w(r)}}}function ta(l){let r,e,t,i,a,s;function u(h,n){if(n&1&&(t=null),n&1&&(i=null),n&1&&(a=null),t==null&&(t=!!(h[0].includes("youtube")||h[0].includes("youtu.be"))),t)return ea;if(i==null&&(i=!!h[0].includes("vimeo")),i)return Ji;if(a==null&&(a=!!h[0].includes("undersco.re")),a)return zi}let c=u(l,-1),d=c&&c(l);return{c(){r=E("div"),e=E("div"),d&&d.c(),this.h()},l(h){r=S(h,"DIV",{class:!0});var n=$(r);e=S(n,"DIV",{class:!0});var o=$(e);d&&d.l(o),o.forEach(w),n.forEach(w),this.h()},h(){b(e,"class","embed svelte-174tb22"),b(r,"class","stream-container svelte-174tb22")},m(h,n){T(h,r,n),D(r,e),d&&d.m(e,null)},p(h,[n]){l=h,c===(c=u(l,n))&&d?d.p(l,n):(d&&d.d(1),d=c&&c(l),d&&(d.c(),d.m(e,null)))},i(h){s||ce(()=>{s=He(r,re,{duration:300,easing:Ve}),s.start()})},o:le,d(h){h&&w(r),d&&d.d()}}}function ra(l,r,e){let{streamUrl:t=""}=r;return l.$$set=i=>{"streamUrl"in i&&e(0,t=i.streamUrl)},[t]}class na extends K{constructor(r){super(),Q(this,r,ra,ta,z,{streamUrl:0})}}function _t(l){let r,e,t,i,a,s,u,c=Ye(l[1].startDate)+"",d,h,n,o=l[1].title+"",f,p,v=ue(l[1],"content.content"),m,_=v&&pt(l);return{c(){r=E("div"),e=E("img"),a=H(),s=E("div"),u=E("div"),d=ae(c),h=H(),n=E("div"),f=ae(o),p=H(),_&&_.c(),this.h()},l(g){r=S(g,"DIV",{class:!0});var y=$(r);e=S(y,"IMG",{class:!0,alt:!0,src:!0}),y.forEach(w),a=C(g),s=S(g,"DIV",{class:!0});var k=$(s);u=S(k,"DIV",{class:!0});var M=$(u);d=oe(M,c),M.forEach(w),h=C(k),n=S(k,"DIV",{class:!0});var P=$(n);f=oe(P,o),P.forEach(w),p=C(k),_&&_.l(k),k.forEach(w),this.h()},h(){b(e,"class","image svelte-1unfe15"),b(e,"alt",t=l[1].title),Z(e.src,i=l[0].importEvent?We(l[1].mainImage).quality(90).saturation(-100).width(500).height(500).url():me(l[1].mainImage).quality(90).saturation(-100).width(500).height(500).url())||b(e,"src",i),b(r,"class","image-container svelte-1unfe15"),b(u,"class","date svelte-1unfe15"),b(n,"class","title svelte-1unfe15"),b(s,"class","text-container svelte-1unfe15")},m(g,y){T(g,r,y),D(r,e),T(g,a,y),T(g,s,y),D(s,u),D(u,d),D(s,h),D(s,n),D(n,f),D(s,p),_&&_.m(s,null),m=!0},p(g,y){(!m||y&2&&t!==(t=g[1].title))&&b(e,"alt",t),(!m||y&3&&!Z(e.src,i=g[0].importEvent?We(g[1].mainImage).quality(90).saturation(-100).width(500).height(500).url():me(g[1].mainImage).quality(90).saturation(-100).width(500).height(500).url()))&&b(e,"src",i),(!m||y&2)&&c!==(c=Ye(g[1].startDate)+"")&&ge(d,c),(!m||y&2)&&o!==(o=g[1].title+"")&&ge(f,o),y&2&&(v=ue(g[1],"content.content")),v?_?(_.p(g,y),y&2&&A(_,1)):(_=pt(g),_.c(),A(_,1),_.m(s,null)):_&&(x(),I(_,1,1,()=>{_=null}),q())},i(g){m||(A(_),m=!0)},o(g){I(_),m=!1},d(g){g&&w(r),g&&w(a),g&&w(s),_&&_.d()}}}function pt(l){let r,e,t;return e=new Ge({props:{blocks:l[1].content.content,mainSite:l[0].importEvent}}),{c(){r=E("div"),N(e.$$.fragment),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);U(e.$$.fragment,a),a.forEach(w),this.h()},h(){b(r,"class","description")},m(i,a){T(i,r,a),X(e,r,null),t=!0},p(i,a){const s={};a&2&&(s.blocks=i[1].content.content),a&1&&(s.mainSite=i[0].importEvent),e.$set(s)},i(i){t||(A(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){i&&w(r),W(e)}}}function ia(l){let r,e,t=l[1]&&_t(l);return{c(){r=E("div"),t&&t.c(),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);t&&t.l(a),a.forEach(w),this.h()},h(){b(r,"class","event svelte-1unfe15")},m(i,a){T(i,r,a),t&&t.m(r,null),e=!0},p(i,[a]){i[1]?t?(t.p(i,a),a&2&&A(t,1)):(t=_t(i),t.c(),A(t,1),t.m(r,null)):t&&(x(),I(t,1,1,()=>{t=null}),q())},i(i){e||(A(t),e=!0)},o(i){I(t),e=!1},d(i){i&&w(r),t&&t.d()}}}function aa(l,r,e){let{event:t={}}=r,i=!1;return ve(async()=>{t.importEvent?e(1,i=await xt("*[_id == '"+t.importedEvent+"'][0]")):e(1,i=t)}),l.$$set=a=>{"event"in a&&e(0,t=a.event)},[t,i]}class oa extends K{constructor(r){super(),Q(this,r,aa,ia,z,{event:0})}}function mt(l,r,e){const t=l.slice();return t[7]=r[e],t}function ht(l){let r,e;return{c(){r=E("div"),e=ae(l[1]),this.h()},l(t){r=S(t,"DIV",{class:!0});var i=$(r);e=oe(i,l[1]),i.forEach(w),this.h()},h(){b(r,"class","viewer-count svelte-at985a")},m(t,i){T(t,r,i),D(r,e)},p(t,i){i&2&&ge(e,t[1])},d(t){t&&w(r)}}}function la(l){let r,e,t,i,a,s,u,c,d,h,n,o,f=l[0].events,p=[];for(let m=0;m<f.length;m+=1)p[m]=vt(mt(l,f,m));const v=m=>I(p[m],1,1,()=>{p[m]=null});return{c(){r=E("div"),e=E("div"),t=E("h1"),i=ae("Welcome to the Bulletin Board"),a=H(),s=E("div"),u=E("div"),c=ae("Subscribe to Calendar"),d=H(),h=E("div");for(let m=0;m<p.length;m+=1)p[m].c();this.h()},l(m){r=S(m,"DIV",{class:!0});var _=$(r);e=S(_,"DIV",{class:!0});var g=$(e);t=S(g,"H1",{});var y=$(t);i=oe(y,"Welcome to the Bulletin Board"),y.forEach(w),a=C(g),s=S(g,"DIV",{class:!0});var k=$(s);u=S(k,"DIV",{class:!0});var M=$(u);c=oe(M,"Subscribe to Calendar"),M.forEach(w),k.forEach(w),d=C(g),h=S(g,"DIV",{class:!0});var P=$(h);for(let G=0;G<p.length;G+=1)p[G].l(P);P.forEach(w),g.forEach(w),_.forEach(w),this.h()},h(){b(u,"class","action svelte-at985a"),b(s,"class","bulletin-board-actions svelte-at985a"),b(h,"class","bulletin-board-events"),b(e,"class","inner svelte-at985a"),b(r,"class","bulletin-board svelte-at985a"),ie(r,"pushed",l[3])},m(m,_){T(m,r,_),D(r,e),D(e,t),D(t,i),D(e,a),D(e,s),D(s,u),D(u,c),D(e,d),D(e,h);for(let g=0;g<p.length;g+=1)p[g].m(h,null);o=!0},p(m,_){if(_&1){f=m[0].events;let g;for(g=0;g<f.length;g+=1){const y=mt(m,f,g);p[g]?(p[g].p(y,_),A(p[g],1)):(p[g]=vt(y),p[g].c(),A(p[g],1),p[g].m(h,null))}for(x(),g=f.length;g<p.length;g+=1)v(g);q()}_&8&&ie(r,"pushed",m[3])},i(m){if(!o){for(let _=0;_<f.length;_+=1)A(p[_]);ce(()=>{n||(n=ne(r,re,{},!0)),n.run(1)}),o=!0}},o(m){p=p.filter(Boolean);for(let _=0;_<p.length;_+=1)I(p[_]);n||(n=ne(r,re,{},!1)),n.run(0),o=!1},d(m){m&&w(r),Lt(p,m),m&&n&&n.end()}}}function sa(l){let r,e,t,i,a=l[2]&&l[2].title&&gt(l);return{c(){r=E("div"),e=E("div"),a&&a.c(),this.h()},l(s){r=S(s,"DIV",{class:!0});var u=$(r);e=S(u,"DIV",{class:!0});var c=$(e);a&&a.l(c),c.forEach(w),u.forEach(w),this.h()},h(){b(e,"class","inner svelte-at985a"),b(r,"class","article svelte-at985a"),ie(r,"pushed",l[3])},m(s,u){T(s,r,u),D(r,e),a&&a.m(e,null),i=!0},p(s,u){s[2]&&s[2].title?a?(a.p(s,u),u&4&&A(a,1)):(a=gt(s),a.c(),A(a,1),a.m(e,null)):a&&(x(),I(a,1,1,()=>{a=null}),q()),u&8&&ie(r,"pushed",s[3])},i(s){i||(A(a),ce(()=>{t||(t=ne(r,re,{},!0)),t.run(1)}),i=!0)},o(s){I(a),t||(t=ne(r,re,{},!1)),t.run(0),i=!1},d(s){s&&w(r),a&&a.d(),s&&t&&t.end()}}}function ua(l){let r=ue(l[0],"content.content"),e,t,i=r&&yt(l);return{c(){i&&i.c(),e=V()},l(a){i&&i.l(a),e=V()},m(a,s){i&&i.m(a,s),T(a,e,s),t=!0},p(a,s){s&1&&(r=ue(a[0],"content.content")),r?i?(i.p(a,s),s&1&&A(i,1)):(i=yt(a),i.c(),A(i,1),i.m(e.parentNode,e)):i&&(x(),I(i,1,1,()=>{i=null}),q())},i(a){t||(A(i),t=!0)},o(a){I(i),t=!1},d(a){i&&i.d(a),a&&w(e)}}}function fa(l){let r,e,t,i;return e=new na({props:{streamUrl:l[0].videoUrl}}),{c(){r=E("div"),N(e.$$.fragment),this.h()},l(a){r=S(a,"DIV",{class:!0});var s=$(r);U(e.$$.fragment,s),s.forEach(w),this.h()},h(){b(r,"class","video svelte-at985a"),ie(r,"pushed",l[3])},m(a,s){T(a,r,s),X(e,r,null),i=!0},p(a,s){const u={};s&1&&(u.streamUrl=a[0].videoUrl),e.$set(u),s&8&&ie(r,"pushed",a[3])},i(a){i||(A(e.$$.fragment,a),ce(()=>{t||(t=ne(r,re,{},!0)),t.run(1)}),i=!0)},o(a){I(e.$$.fragment,a),t||(t=ne(r,re,{},!1)),t.run(0),i=!1},d(a){a&&w(r),W(e),a&&t&&t.end()}}}function vt(l){let r,e;return r=new oa({props:{event:l[7]}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&1&&(a.event=t[7]),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function gt(l){let r=l[2].title+"",e,t,i=ue(l[2],"content.content"),a,s,u=i&&bt(l);return{c(){e=ae(r),t=H(),u&&u.c(),a=V()},l(c){e=oe(c,r),t=C(c),u&&u.l(c),a=V()},m(c,d){T(c,e,d),T(c,t,d),u&&u.m(c,d),T(c,a,d),s=!0},p(c,d){(!s||d&4)&&r!==(r=c[2].title+"")&&ge(e,r),d&4&&(i=ue(c[2],"content.content")),i?u?(u.p(c,d),d&4&&A(u,1)):(u=bt(c),u.c(),A(u,1),u.m(a.parentNode,a)):u&&(x(),I(u,1,1,()=>{u=null}),q())},i(c){s||(A(u),s=!0)},o(c){I(u),s=!1},d(c){c&&w(e),c&&w(t),u&&u.d(c),c&&w(a)}}}function bt(l){let r,e;return r=new Ge({props:{blocks:l[2].content.content,mainSite:!0}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&4&&(a.blocks=t[2].content.content),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function yt(l){let r,e,t,i,a;return t=new Ge({props:{blocks:l[0].content.content}}),{c(){r=E("div"),e=E("div"),N(t.$$.fragment),this.h()},l(s){r=S(s,"DIV",{class:!0});var u=$(r);e=S(u,"DIV",{class:!0});var c=$(e);U(t.$$.fragment,c),c.forEach(w),u.forEach(w),this.h()},h(){b(e,"class","inner svelte-at985a"),b(r,"class","article svelte-at985a"),ie(r,"pushed",l[3])},m(s,u){T(s,r,u),D(r,e),X(t,e,null),a=!0},p(s,u){const c={};u&1&&(c.blocks=s[0].content.content),t.$set(c),u&8&&ie(r,"pushed",s[3])},i(s){a||(A(t.$$.fragment,s),ce(()=>{i||(i=ne(r,re,{},!0)),i.run(1)}),a=!0)},o(s){I(t.$$.fragment,s),i||(i=ne(r,re,{},!1)),i.run(0),a=!1},d(s){s&&w(r),W(t),s&&i&&i.end()}}}function wt(l){let r,e=l[0].infoText+"",t;return{c(){r=E("div"),t=ae(e),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);t=oe(a,e),a.forEach(w),this.h()},h(){b(r,"class","info-text svelte-at985a")},m(i,a){T(i,r,a),D(r,t)},p(i,a){a&1&&e!==(e=i[0].infoText+"")&&ge(t,e)},d(i){i&&w(r)}}}function ca(l){let r,e,t,i,a,s,u,c,d,h,n,o=l[0].contentType==="video"&&ht(l);const f=[fa,ua,sa,la],p=[];function v(_,g){return _[0].contentType==="video"?0:_[0].contentType==="text"?1:_[0].contentType==="importedPost"?2:_[0].isBulletinBoard?3:-1}~(a=v(l))&&(s=p[a]=f[a](l));let m=l[0].infoText&&wt(l);return{c(){o&&o.c(),r=H(),e=E("div"),t=ae("Return"),i=H(),s&&s.c(),u=H(),m&&m.c(),c=V(),this.h()},l(_){o&&o.l(_),r=C(_),e=S(_,"DIV",{class:!0});var g=$(e);t=oe(g,"Return"),g.forEach(w),i=C(_),s&&s.l(_),u=C(_),m&&m.l(_),c=V(),this.h()},h(){b(e,"class","return-button svelte-at985a")},m(_,g){o&&o.m(_,g),T(_,r,g),T(_,e,g),D(e,t),T(_,i,g),~a&&p[a].m(_,g),T(_,u,g),m&&m.m(_,g),T(_,c,g),d=!0,h||(n=fe(e,"click",l[6]),h=!0)},p(_,[g]){_[0].contentType==="video"?o?o.p(_,g):(o=ht(_),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null);let y=a;a=v(_),a===y?~a&&p[a].p(_,g):(s&&(x(),I(p[y],1,1,()=>{p[y]=null}),q()),~a?(s=p[a],s?s.p(_,g):(s=p[a]=f[a](_),s.c()),A(s,1),s.m(u.parentNode,u)):s=null),_[0].infoText?m?m.p(_,g):(m=wt(_),m.c(),m.m(c.parentNode,c)):m&&(m.d(1),m=null)},i(_){d||(A(s),d=!0)},o(_){I(s),d=!1},d(_){o&&o.d(_),_&&w(r),_&&w(e),_&&w(i),~a&&p[a].d(_),_&&w(u),m&&m.d(_),_&&w(c),h=!1,n()}}}function da(l,r,e){let t,i;J(l,Y,h=>e(5,t=h)),J(l,qt,h=>e(3,i=h));let{article:a={}}=r,s=0,u="",c;ve(async()=>{Zt(a),a.contentType==="importedPost"&&a.importedPost&&e(2,c=await xt("*[_id == '"+a.importedPost+"'][0]"))}),Ft(async()=>{Kt()});const d=()=>{Ce.set(!1)};return l.$$set=h=>{"article"in h&&e(0,a=h.article)},l.$$.update=()=>{if(l.$$.dirty&49){e(4,s=0);for(const[h,n]of Object.entries(t))n.viewing===a._id&&e(4,s++,s)}l.$$.dirty&16&&e(1,u=s===1?"You are the only one here.":`${s} people are here.`)},[a,u,c,i,s,t,d]}class _a extends K{constructor(r){super(),Q(this,r,da,ca,z,{article:0})}}function pa(l){let r,e,t,i,a,s,u,c,d,h,n,o,f,p,v,m;return{c(){r=E("div"),e=E("div"),t=ae(l[0]),i=H(),a=E("div"),s=E("div"),u=E("div"),c=ae("\u25B8"),d=ae(`
      Yes`),h=H(),n=E("div"),o=E("div"),f=ae("\u25B8"),p=ae(`
      No`),this.h()},l(_){r=S(_,"DIV",{class:!0});var g=$(r);e=S(g,"DIV",{});var y=$(e);t=oe(y,l[0]),y.forEach(w),i=C(g),a=S(g,"DIV",{class:!0});var k=$(a);s=S(k,"DIV",{class:!0,tabindex:!0,autofocus:!0});var M=$(s);u=S(M,"DIV",{class:!0});var P=$(u);c=oe(P,"\u25B8"),P.forEach(w),d=oe(M,`
      Yes`),M.forEach(w),h=C(k),n=S(k,"DIV",{class:!0,tabindex:!0});var G=$(n);o=S(G,"DIV",{class:!0});var se=$(o);f=oe(se,"\u25B8"),se.forEach(w),p=oe(G,`
      No`),G.forEach(w),k.forEach(w),g.forEach(w),this.h()},h(){b(u,"class","marker svelte-pi72xu"),b(s,"class","choice svelte-pi72xu"),b(s,"tabindex","0"),b(s,"autofocus",""),b(o,"class","marker svelte-pi72xu"),b(n,"class","choice svelte-pi72xu"),b(n,"tabindex","0"),b(a,"class","multiple-choice"),b(r,"class","room-dialog-box svelte-pi72xu")},m(_,g){T(_,r,g),D(r,e),D(e,t),D(r,i),D(r,a),D(a,s),D(s,u),D(u,c),D(s,d),D(a,h),D(a,n),D(n,o),D(o,f),D(n,p),s.focus(),v||(m=[fe(s,"click",l[3]),fe(s,"keydown",l[4]),fe(n,"click",l[5]),fe(n,"keydown",l[6])],v=!0)},p(_,[g]){g&1&&ge(t,_[0])},i:le,o:le,d(_){_&&w(r),v=!1,jt(m)}}}function ma(l,r,e){const t=Te();let{text:i=""}=r,{roomId:a=""}=r;const s=h=>{t("room",{roomId:a})},u=h=>{h.code==="Enter"&&t("room",{roomId:a})},c=h=>{t("room",{roomId:!1})},d=h=>{h.code==="Enter"&&t("room",{roomId:!1})};return l.$$set=h=>{"text"in h&&e(0,i=h.text),"roomId"in h&&e(1,a=h.roomId)},[i,a,t,s,u,c,d]}class ha extends K{constructor(r){super(),Q(this,r,ma,pa,z,{text:0,roomId:1})}}function va(l){let r,e,t,i;return e=new ha({props:{text:`Go to ${l[1]}?`,roomId:l[0]}}),e.$on("room",l[3]),{c(){r=E("div"),N(e.$$.fragment),this.h()},l(a){r=S(a,"DIV",{class:!0});var s=$(r);U(e.$$.fragment,s),s.forEach(w),this.h()},h(){b(r,"class","caption-container svelte-ukizaq")},m(a,s){T(a,r,s),X(e,r,null),i=!0},p(a,[s]){const u={};s&2&&(u.text=`Go to ${a[1]}?`),s&1&&(u.roomId=a[0]),e.$set(u)},i(a){i||(A(e.$$.fragment,a),t||ce(()=>{t=He(r,re,{}),t.start()}),i=!0)},o(a){I(e.$$.fragment,a),i=!1},d(a){a&&w(r),W(e)}}}function ga(l,r,e){const t=Te();let{roomIntent:i=""}=r,{roomTitle:a=""}=r;const s=u=>{console.log(u),t("room",{roomId:u.detail.roomId})};return l.$$set=u=>{"roomIntent"in u&&e(0,i=u.roomIntent),"roomTitle"in u&&e(1,a=u.roomTitle)},[i,a,t,s]}class ba extends K{constructor(r){super(),Q(this,r,ga,va,z,{roomIntent:0,roomTitle:1})}}function ya(l){let r,e;return{c(){r=qe("svg"),e=qe("path"),this.h()},l(t){r=Ne(t,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0,class:!0});var i=$(r);e=Ne(i,"path",{d:!0,class:!0}),$(e).forEach(w),i.forEach(w),this.h()},h(){b(e,"d","M4.8474 7.78418L0.703963 0.607532L8.99084 0.607531L4.8474 7.78418Z"),b(e,"class","svelte-fiesz8"),b(r,"width","9"),b(r,"height","8"),b(r,"viewBox","0 0 9 8"),b(r,"fill","none"),b(r,"xmlns","http://www.w3.org/2000/svg"),b(r,"class","svelte-fiesz8")},m(t,i){T(t,r,i),D(r,e)},p:le,i:le,o:le,d(t){t&&w(r)}}}class wa extends K{constructor(r){super(),Q(this,r,null,ya,z,{})}}function At(l){let r,e,t,i,a;return e=new wa({}),{c(){r=E("div"),N(e.$$.fragment),this.h()},l(s){r=S(s,"DIV",{class:!0});var u=$(r);U(e.$$.fragment,u),u.forEach(w),this.h()},h(){b(r,"class","next-caption svelte-10yrac0")},m(s,u){T(s,r,u),X(e,r,null),t=!0,i||(a=fe(r,"click",l[6]),i=!0)},p:le,i(s){t||(A(e.$$.fragment,s),t=!0)},o(s){I(e.$$.fragment,s),t=!1},d(s){s&&w(r),W(e),i=!1,a()}}}function Aa(l){let r,e,t=Ze(l[2].text.content)+"",i,a,s,u,c,d,h=l[1]<l[0].length-1&&At(l);return{c(){r=E("div"),e=E("div"),s=H(),h&&h.c(),this.h()},l(n){r=S(n,"DIV",{class:!0});var o=$(r);e=S(o,"DIV",{class:!0});var f=$(e);f.forEach(w),s=C(o),h&&h.l(o),o.forEach(w),this.h()},h(){b(e,"class","caption-box svelte-10yrac0"),b(r,"class","caption-container svelte-10yrac0")},m(n,o){T(n,r,o),D(r,e),e.innerHTML=t,D(r,s),h&&h.m(r,null),u=!0,c||(d=fe(e,"click",l[5]),c=!0)},p(n,[o]){l=n,(!u||o&4)&&t!==(t=Ze(l[2].text.content)+"")&&(e.innerHTML=t),l[1]<l[0].length-1?h?(h.p(l,o),o&3&&A(h,1)):(h=At(l),h.c(),A(h,1),h.m(r,null)):h&&(x(),I(h,1,1,()=>{h=null}),q())},i(n){u||(ce(()=>{a&&a.end(1),i=He(e,re,l[4]),i.start()}),A(h),u=!0)},o(n){i&&i.invalidate(),a=nr(e,re,{duration:100}),I(h),u=!1},d(n){n&&w(r),n&&a&&a.end(),h&&h.d(),c=!1,d()}}}function ka(l,r,e){const t=Te(),i={duration:500};let{text:a=[]}=r,s=0,u=!1;a.length>0&&(u=a[s]);const c=h=>{s<a.length-1?(e(1,s++,s),e(2,u=a[s])):t("close")},d=h=>{e(1,s++,s),e(2,u=a[s])};return l.$$set=h=>{"text"in h&&e(0,a=h.text)},[a,s,u,t,i,c,d]}class Ta extends K{constructor(r){super(),Q(this,r,ka,Aa,z,{text:0})}}function Ia(l){let r,e,t,i,a,s,u,c;return{c(){r=E("div"),e=E("div"),t=E("input"),i=H(),a=E("button"),s=ae("Send"),this.h()},l(d){r=S(d,"DIV",{class:!0});var h=$(r);e=S(h,"DIV",{class:!0});var n=$(e);t=S(n,"INPUT",{placeholder:!0,type:!0,maxlength:!0,class:!0}),i=C(n),a=S(n,"BUTTON",{class:!0});var o=$(a);s=oe(o,"Send"),o.forEach(w),n.forEach(w),h.forEach(w),this.h()},h(){b(t,"placeholder","Write a message..."),b(t,"type","[text]"),b(t,"maxlength","600"),b(t,"class","svelte-oqrtp3"),b(a,"class","svelte-oqrtp3"),b(e,"class","chat-input svelte-oqrtp3"),b(r,"class","chat-container svelte-oqrtp3")},m(d,h){T(d,r,h),D(r,e),D(e,t),Ue(t,l[0]),D(e,i),D(e,a),D(a,s),u||(c=[fe(t,"input",l[3]),fe(t,"keydown",l[4]),fe(a,"click",l[1])],u=!0)},p(d,[h]){h&1&&Ue(t,d[0])},i:le,o:le,d(d){d&&w(r),u=!1,jt(c)}}}function Ea(l,r,e){const t=Te();let i="";const a=()=>{t("submit",{text:i}),e(0,i="")};let{chatMessages:s=[]}=r;function u(){i=this.value,e(0,i)}const c=d=>{d.keyCode==13&&a()};return l.$$set=d=>{"chatMessages"in d&&e(2,s=d.chatMessages)},[i,a,s,u,c]}class Sa extends K{constructor(r){super(),Q(this,r,Ea,Ia,z,{chatMessages:2})}}var $a=Ht,Oa=function(){return $a.Date.now()},Da=Oa,Ma=Nt,Pe=Da,kt=dr,Pa="Expected a function",Va=Math.max,Ba=Math.min;function Fa(l,r,e){var t,i,a,s,u,c,d=0,h=!1,n=!1,o=!0;if(typeof l!="function")throw new TypeError(Pa);r=kt(r)||0,Ma(e)&&(h=!!e.leading,n="maxWait"in e,a=n?Va(kt(e.maxWait)||0,r):a,o="trailing"in e?!!e.trailing:o);function f(P){var G=t,se=i;return t=i=void 0,d=P,s=l.apply(se,G),s}function p(P){return d=P,u=setTimeout(_,r),h?f(P):s}function v(P){var G=P-c,se=P-d,B=r-G;return n?Ba(B,a-se):B}function m(P){var G=P-c,se=P-d;return c===void 0||G>=r||G<0||n&&se>=a}function _(){var P=Pe();if(m(P))return g(P);u=setTimeout(_,v(P))}function g(P){return u=void 0,o&&t?f(P):(t=i=void 0,s)}function y(){u!==void 0&&clearTimeout(u),d=0,t=c=i=u=void 0}function k(){return u===void 0?s:g(Pe())}function M(){var P=Pe(),G=m(P);if(t=arguments,i=this,c=P,G){if(u===void 0)return p(c);if(n)return clearTimeout(u),u=setTimeout(_,r),f(c)}return u===void 0&&(u=setTimeout(_,r)),s}return M.cancel=y,M.flush=k,M}var La=Fa,ja=La,Ha=Nt,Ca="Expected a function";function Ga(l,r,e){var t=!0,i=!0;if(typeof l!="function")throw new TypeError(Ca);return Ha(e)&&(t="leading"in e?!!e.leading:t,i="trailing"in e?!!e.trailing:i),ja(l,r,{leading:t,maxWait:r,trailing:i})}var Ra=Ga;const we=de(!0),xa=()=>new Promise((l,r)=>{document.addEventListener("keydown",Ra(e=>{e.keyCode===38&&(we.set(!1),F(Y)[F(ee).uuid].y>0&&Y.update(t=>(t[F(ee).uuid].y-=1,t))),e.keyCode===40&&(we.set(!1),F(Y)[F(ee).uuid].y*R<F(Ae).dimensions.height*R-60&&Y.update(t=>(t[F(ee).uuid].y+=1,t))),e.keyCode===37&&(we.set(!1),F(Y)[F(ee).uuid].x>0&&Y.update(t=>(t[F(ee).uuid].x-=1,t))),e.keyCode===39&&(we.set(!1),F(Y)[F(ee).uuid].x*R<F(Ae).dimensions.width*R-60&&Y.update(t=>(t[F(ee).uuid].x+=1,t))),xe(F(Y)[F(ee).uuid].x,F(Y)[F(ee).uuid].y,!0)},100)),document.addEventListener("keyup",e=>{we.set(!0)}),l()}),qa=l=>new Promise((r,e)=>{let t=gsap.timeline();t.to(l,.5,{css:{opacity:0}}),t.play(),t.eventCallback("onComplete",()=>{r()})}),Na=l=>new Promise((r,e)=>{let t=gsap.timeline();t.to(l,.5,{css:{opacity:0}}),t.to(l,.5,{css:{opacity:1}}),t.play(),t.eventCallback("onComplete",()=>{r()})}),je=de([]),Ua=async()=>{const l='*[_id == "streams"][0]';let r=await pe(l);je.set(r.activeStreams),_r.listen(l).subscribe(e=>{je.set(e.result.activeStreams)})};function Tt(l,r,e){const t=l.slice();return t[27]=r[e],t}function It(l){let r,e,t;return e=new di({props:{room:l[7],x:te(l[2][l[1].uuid],"x",100),y:te(l[2][l[1].uuid],"y",100),$$slots:{default:[Xa]},$$scope:{ctx:l}}}),e.$on("move",l[18]),{c(){r=E("div"),N(e.$$.fragment),this.h()},l(i){r=S(i,"DIV",{class:!0});var a=$(r);U(e.$$.fragment,a),a.forEach(w),this.h()},h(){b(r,"class","viewport"),ie(r,"pushed",l[9])},m(i,a){T(i,r,a),X(e,r,null),l[19](r),t=!0},p(i,a){const s={};a&128&&(s.room=i[7]),a&6&&(s.x=te(i[2][i[1].uuid],"x",100)),a&6&&(s.y=te(i[2][i[1].uuid],"y",100)),a&1073749140&&(s.$$scope={dirty:a,ctx:i}),e.$set(s),a&512&&ie(r,"pushed",i[9])},i(i){t||(A(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){i&&w(r),W(e),l[19](null)}}}function Et(l){let r,e;return r=new Ui({props:{x:l[11],y:l[12]}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&2048&&(a.x=t[11]),i&4096&&(a.y=t[12]),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function Xa(l){let r,e,t,i,a,s,u,c,d,h;r=new Ai({props:{players:l[2],currentRoomId:l[7]._id,avatars:l[4]}}),t=new $i({props:{objects:te(l[7],"objects",[])}}),a=new Bi({props:{zones:te(l[7],"zones",[])}}),u=new xi({props:{portals:te(l[7],"portals",[])}});let n=l[10]&&Et(l);return{c(){N(r.$$.fragment),e=H(),N(t.$$.fragment),i=H(),N(a.$$.fragment),s=H(),N(u.$$.fragment),c=H(),n&&n.c(),d=V()},l(o){U(r.$$.fragment,o),e=C(o),U(t.$$.fragment,o),i=C(o),U(a.$$.fragment,o),s=C(o),U(u.$$.fragment,o),c=C(o),n&&n.l(o),d=V()},m(o,f){X(r,o,f),T(o,e,f),X(t,o,f),T(o,i,f),X(a,o,f),T(o,s,f),X(u,o,f),T(o,c,f),n&&n.m(o,f),T(o,d,f),h=!0},p(o,f){const p={};f&4&&(p.players=o[2]),f&128&&(p.currentRoomId=o[7]._id),f&16&&(p.avatars=o[4]),r.$set(p);const v={};f&128&&(v.objects=te(o[7],"objects",[])),t.$set(v);const m={};f&128&&(m.zones=te(o[7],"zones",[])),a.$set(m);const _={};f&128&&(_.portals=te(o[7],"portals",[])),u.$set(_),o[10]?n?(n.p(o,f),f&1024&&A(n,1)):(n=Et(o),n.c(),A(n,1),n.m(d.parentNode,d)):n&&(x(),I(n,1,1,()=>{n=null}),q())},i(o){h||(A(r.$$.fragment,o),A(t.$$.fragment,o),A(a.$$.fragment,o),A(u.$$.fragment,o),A(n),h=!0)},o(o){I(r.$$.fragment,o),I(t.$$.fragment,o),I(a.$$.fragment,o),I(u.$$.fragment,o),I(n),h=!1},d(o){W(r,o),o&&w(e),W(t,o),o&&w(i),W(a,o),o&&w(s),W(u,o),o&&w(c),n&&n.d(o),o&&w(d)}}}function St(l){let r,e;return r=new Li({props:{soundFile:l[7].backgroundSound}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&128&&(a.soundFile=t[7].backgroundSound),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function $t(l){let r,e;return r=new Qi({props:{streamUrl:l[27].videoUrl}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&16384&&(a.streamUrl=t[27].videoUrl),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function Ot(l){let r,e,t=(l[7]._id==l[27].parentArea._ref||l[6]._id==l[27].parentArea._ref)&&$t(l);return{c(){t&&t.c(),r=V()},l(i){t&&t.l(i),r=V()},m(i,a){t&&t.m(i,a),T(i,r,a),e=!0},p(i,a){i[7]._id==i[27].parentArea._ref||i[6]._id==i[27].parentArea._ref?t?(t.p(i,a),a&16576&&A(t,1)):(t=$t(i),t.c(),A(t,1),t.m(r.parentNode,r)):t&&(x(),I(t,1,1,()=>{t=null}),q())},i(i){e||(A(t),e=!0)},o(i){I(t),e=!1},d(i){t&&t.d(i),i&&w(r)}}}function Dt(l){let r,e;return r=new ba({props:{roomIntent:l[0],roomTitle:l[8][l[0]].title}}),r.$on("room",l[20]),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&1&&(a.roomIntent=t[0]),i&257&&(a.roomTitle=t[8][t[0]].title),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function Mt(l){let r,e,t=l[5]&&Pt(l);return{c(){t&&t.c(),r=V()},l(i){t&&t.l(i),r=V()},m(i,a){t&&t.m(i,a),T(i,r,a),e=!0},p(i,a){i[5]?t?(t.p(i,a),a&32&&A(t,1)):(t=Pt(i),t.c(),A(t,1),t.m(r.parentNode,r)):t&&(x(),I(t,1,1,()=>{t=null}),q())},i(i){e||(A(t),e=!0)},o(i){I(t),e=!1},d(i){t&&t.d(i),i&&w(r)}}}function Pt(l){let r,e;return r=new Ta({props:{text:l[5]}}),r.$on("close",l[21]),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&32&&(a.text=t[5]),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function Vt(l){let r,e;return r=new _a({props:{article:l[15]}}),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&32768&&(a.article=t[15]),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function Bt(l){let r,e;return r=new Sa({props:{chatMessages:l[16].filter(l[22])}}),r.$on("submit",l[23]),{c(){N(r.$$.fragment)},l(t){U(r.$$.fragment,t)},m(t,i){X(r,t,i),e=!0},p(t,i){const a={};i&65664&&(a.chatMessages=t[16].filter(t[22])),r.$set(a)},i(t){e||(A(r.$$.fragment,t),e=!0)},o(t){I(r.$$.fragment,t),e=!1},d(t){W(r,t)}}}function Wa(l){let r,e=ue(l[7],"backgroundSound.asset")&&l[13],t,i,a,s,u,c,d,h=l[7]&&It(l),n=e&&St(l),o=l[14],f=[];for(let y=0;y<o.length;y+=1)f[y]=Ot(Tt(l,o,y));const p=y=>I(f[y],1,1,()=>{f[y]=null});let v=l[0]&&Dt(l),m=!l[9]&&!l[15]&&!l[0]&&Mt(l),_=l[15]&&Vt(l),g=!l[9]&&!l[15]&&Bt(l);return{c(){h&&h.c(),r=H(),n&&n.c(),t=H();for(let y=0;y<f.length;y+=1)f[y].c();i=H(),v&&v.c(),a=H(),m&&m.c(),s=H(),_&&_.c(),u=H(),g&&g.c(),c=V()},l(y){h&&h.l(y),r=C(y),n&&n.l(y),t=C(y);for(let k=0;k<f.length;k+=1)f[k].l(y);i=C(y),v&&v.l(y),a=C(y),m&&m.l(y),s=C(y),_&&_.l(y),u=C(y),g&&g.l(y),c=V()},m(y,k){h&&h.m(y,k),T(y,r,k),n&&n.m(y,k),T(y,t,k);for(let M=0;M<f.length;M+=1)f[M].m(y,k);T(y,i,k),v&&v.m(y,k),T(y,a,k),m&&m.m(y,k),T(y,s,k),_&&_.m(y,k),T(y,u,k),g&&g.m(y,k),T(y,c,k),d=!0},p(y,[k]){if(y[7]?h?(h.p(y,k),k&128&&A(h,1)):(h=It(y),h.c(),A(h,1),h.m(r.parentNode,r)):h&&(x(),I(h,1,1,()=>{h=null}),q()),k&8320&&(e=ue(y[7],"backgroundSound.asset")&&y[13]),e?n?(n.p(y,k),k&8320&&A(n,1)):(n=St(y),n.c(),A(n,1),n.m(t.parentNode,t)):n&&(x(),I(n,1,1,()=>{n=null}),q()),k&16576){o=y[14];let M;for(M=0;M<o.length;M+=1){const P=Tt(y,o,M);f[M]?(f[M].p(P,k),A(f[M],1)):(f[M]=Ot(P),f[M].c(),A(f[M],1),f[M].m(i.parentNode,i))}for(x(),M=o.length;M<f.length;M+=1)p(M);q()}y[0]?v?(v.p(y,k),k&1&&A(v,1)):(v=Dt(y),v.c(),A(v,1),v.m(a.parentNode,a)):v&&(x(),I(v,1,1,()=>{v=null}),q()),!y[9]&&!y[15]&&!y[0]?m?(m.p(y,k),k&33281&&A(m,1)):(m=Mt(y),m.c(),A(m,1),m.m(s.parentNode,s)):m&&(x(),I(m,1,1,()=>{m=null}),q()),y[15]?_?(_.p(y,k),k&32768&&A(_,1)):(_=Vt(y),_.c(),A(_,1),_.m(u.parentNode,u)):_&&(x(),I(_,1,1,()=>{_=null}),q()),!y[9]&&!y[15]?g?(g.p(y,k),k&33280&&A(g,1)):(g=Bt(y),g.c(),A(g,1),g.m(c.parentNode,c)):g&&(x(),I(g,1,1,()=>{g=null}),q())},i(y){if(!d){A(h),A(n);for(let k=0;k<o.length;k+=1)A(f[k]);A(v),A(m),A(_),A(g),d=!0}},o(y){I(h),I(n),f=f.filter(Boolean);for(let k=0;k<f.length;k+=1)I(f[k]);I(v),I(m),I(_),I(g),d=!1},d(y){h&&h.d(y),y&&w(r),n&&n.d(y),y&&w(t),Lt(f,y),y&&w(i),v&&v.d(y),y&&w(a),m&&m.d(y),y&&w(s),_&&_.d(y),y&&w(u),g&&g.d(y),y&&w(c)}}}function Ya(l,r,e){let t,i,a,s,u,c,d,h,n,o,f,p,v;J(l,Ae,O=>e(7,t=O)),J(l,gr,O=>e(24,i=O)),J(l,ee,O=>e(1,a=O)),J(l,Xt,O=>e(8,s=O)),J(l,Y,O=>e(2,u=O)),J(l,qt,O=>e(9,c=O)),J(l,Wt,O=>e(10,d=O)),J(l,_i,O=>e(11,h=O)),J(l,pi,O=>e(12,n=O)),J(l,br,O=>e(13,o=O)),J(l,je,O=>e(14,f=O)),J(l,Ce,O=>e(15,p=O)),J(l,Re,O=>e(16,v=O));let m={},_=!1,g=[],y=!1,k=!1;const M=()=>{if(t.portals&&Array.isArray(t.portals)){let O=!1;t.portals.forEach(L=>{u[a.uuid].x===L.x&&u[a.uuid].y===L.y&&(O=L.targetArea._id)}),O?e(0,_=O):e(0,_=!1)}},P=()=>{let O=!1;t.zones.forEach(L=>{Ke(u[a.uuid].x,L.x,L.x+L.dimensions.width)&&Ke(u[a.uuid].y,L.y,L.y+L.dimensions.height)&&(O=L)}),O?e(6,k=O):e(6,k=!1)},G=async O=>{let L=s[O];ke.set(!1),await qa(m),Ae.set(L),Yt({id:L._id,x:$e(4,6),y:$e(4,6)}),await Na(m),ke.set(!0),ue(L,"introductionTexts")?e(5,y=L.introductionTexts):e(5,y=!1)};ve(async()=>{_e("__ => App starting...");try{await pr()}catch(L){mr("Error in authentication:",L)}_e("\u2713 (1) Auth client configured "),await li(),_e("\u2713 (2) World built");for(const[L,Za]of Object.entries(s))if(s[L].mainArea){Ae.set(s[L]);break}e(4,g=await si()),_e("\u2713 (3) Avatars loaded"),ee.update(L=>(L.uuid=Rt(),L));let O={uuid:a.uuid,name:i&&i.name?i.name:"Test player",shape:ue(i,"avatar._ref")?i.avatar._ref:Le(g)._id,onboarded:!0,room:t._id,x:$e(10,30),y:$e(5,15)};await hi(O),_e("\u2713 (4) Game server connected"),await xa(),_e("\u2713 (5) Keyboard initialized"),Ua(),_e("\u2713 (6) Stream listener initialized"),ue(t,"introductionTexts")&&e(5,y=t.introductionTexts),_e("\u2713 (7) Show main room introduction"),_e("__ => App loaded"),hr.set(vr.READY)});const se=O=>{xe(O.detail.x,O.detail.y,!1)};function B(O){be[O?"unshift":"push"](()=>{m=O,e(3,m)})}const Ie=O=>{O.detail.roomId&&G(_),e(0,_=!1)},Ee=O=>{e(5,y=!1)},Me=O=>O.room===t._id,Se=O=>{Qt(O,t)};return l.$$.update=()=>{l.$$.dirty&1&&_&&e(5,y=!1),l.$$.dirty&6&&u[a.uuid]&&(u[a.uuid].x||u[a.uuid].x)&&(M(),P())},[_,a,u,m,g,y,k,t,s,c,d,h,n,o,f,p,v,G,se,B,Ie,Ee,Me,Se]}class Ja extends K{constructor(r){super(),Q(this,r,Ya,Wa,z,{})}}export{Ja as default};
