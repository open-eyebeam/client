import{S as te,i as re,s as ne,e as I,k as q,c as E,a as x,m as L,d as b,_ as Q,b as m,H as ee,g as S,I as A,O as F,t as R,h as H,E as le,R as He,a1 as me,l as B,Y as pr,Z as vr,Q as Ie,a2 as Le,w as Y,x as W,y as Z,q as T,o as D,B as K,n as U,p as C,v as ke,T as mr,U as hr,V as br,W as gr,M as N,J as _e,K as ue,a3 as ze,a4 as Ge,a5 as Ne,a6 as rr,F as Be,G as Fe,f as yr,j as we,L as Ue,a7 as wr}from"../chunks/index-b35354fd.js";import{_ as kr,k as Ar,m as Tr,n as nr,o as Ir,q as Er,r as xr,v as $r,w as ir,x as Sr,y as Ve,z as fe,C as jr,D as lr,f as se,E as Ye,F as or,G as je,H as ce,I as Ae,s as Pe,g as qe,J as Je,j as ye,K as De,L as Te,P as Dr,M as et,N as tt,O as rt,h as ve,l as ar,Q as Or,R as sr,t as fr,T as Vr,U as Pr,B as ur,S as Re,V as ge,W as zr,X as Mr,Y as Oe,c as qr,Z as Lr,$ as Br,a0 as nt,a1 as Fr,u as Ce,a2 as Rr,a3 as Hr,a4 as Gr,a5 as Se,a6 as Nr,a7 as Ur,a8 as Cr,a9 as Xe,aa as it,ab as Xr,b as Yr,ac as Wr,p as Zr,e as Kr,ad as Qr,ae as Jr,af as en,ag as tn,ah as rn}from"../chunks/movement-65cd065f.js";import"../chunks/index-aa96d99b.js";function We(o){return Math.pow(o-1,3)*(1-o)+1}var nn=Math.floor,ln=Math.random;function on(o,e){return o+nn(ln()*(e-o+1))}var an=on,sn=an;function fn(o){var e=o.length;return e?o[sn(0,e-1)]:void 0}var cr=fn,un=kr;function cn(o,e){return un(e,function(t){return o[t]})}var dn=cn;function _n(o,e){for(var t=-1,r=Array(o);++t<o;)r[t]=e(t);return r}var pn=_n,Ze={exports:{}};function vn(){return!1}var mn=vn;(function(o,e){var t=Ar,r=mn,i=e&&!e.nodeType&&e,l=i&&!0&&o&&!o.nodeType&&o,s=l&&l.exports===i,a=s?t.Buffer:void 0,f=a?a.isBuffer:void 0,c=f||r;o.exports=c})(Ze,Ze.exports);var hn=Tr,bn=nr,gn=Ir,yn="[object Arguments]",wn="[object Array]",kn="[object Boolean]",An="[object Date]",Tn="[object Error]",In="[object Function]",En="[object Map]",xn="[object Number]",$n="[object Object]",Sn="[object RegExp]",jn="[object Set]",Dn="[object String]",On="[object WeakMap]",Vn="[object ArrayBuffer]",Pn="[object DataView]",zn="[object Float32Array]",Mn="[object Float64Array]",qn="[object Int8Array]",Ln="[object Int16Array]",Bn="[object Int32Array]",Fn="[object Uint8Array]",Rn="[object Uint8ClampedArray]",Hn="[object Uint16Array]",Gn="[object Uint32Array]",ie={};ie[zn]=ie[Mn]=ie[qn]=ie[Ln]=ie[Bn]=ie[Fn]=ie[Rn]=ie[Hn]=ie[Gn]=!0;ie[yn]=ie[wn]=ie[Vn]=ie[kn]=ie[Pn]=ie[An]=ie[Tn]=ie[In]=ie[En]=ie[xn]=ie[$n]=ie[Sn]=ie[jn]=ie[Dn]=ie[On]=!1;function Nn(o){return gn(o)&&bn(o.length)&&!!ie[hn(o)]}var Un=Nn;function Cn(o){return function(e){return o(e)}}var Xn=Cn,Ke={exports:{}};(function(o,e){var t=Er,r=e&&!e.nodeType&&e,i=r&&!0&&o&&!o.nodeType&&o,l=i&&i.exports===r,s=l&&t.process,a=function(){try{var f=i&&i.require&&i.require("util").types;return f||s&&s.binding&&s.binding("util")}catch{}}();o.exports=a})(Ke,Ke.exports);var Yn=Un,Wn=Xn,lt=Ke.exports,ot=lt&&lt.isTypedArray,Zn=ot?Wn(ot):Yn,Kn=Zn,Qn=pn,Jn=xr,ei=ir,ti=Ze.exports,ri=$r,ni=Kn,ii=Object.prototype,li=ii.hasOwnProperty;function oi(o,e){var t=ei(o),r=!t&&Jn(o),i=!t&&!r&&ti(o),l=!t&&!r&&!i&&ni(o),s=t||r||i||l,a=s?Qn(o.length,String):[],f=a.length;for(var c in o)(e||li.call(o,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||l&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||ri(c,f)))&&a.push(c);return a}var ai=oi,si=Object.prototype;function fi(o){var e=o&&o.constructor,t=typeof e=="function"&&e.prototype||si;return o===t}var ui=fi;function ci(o,e){return function(t){return o(e(t))}}var di=ci,_i=di,pi=_i(Object.keys,Object),vi=pi,mi=ui,hi=vi,bi=Object.prototype,gi=bi.hasOwnProperty;function yi(o){if(!mi(o))return hi(o);var e=[];for(var t in Object(o))gi.call(o,t)&&t!="constructor"&&e.push(t);return e}var wi=yi,ki=Sr,Ai=nr;function Ti(o){return o!=null&&Ai(o.length)&&!ki(o)}var Ii=Ti,Ei=ai,xi=wi,$i=Ii;function Si(o){return $i(o)?Ei(o):xi(o)}var ji=Si,Di=dn,Oi=ji;function Vi(o){return o==null?[]:Di(o,Oi(o))}var Pi=Vi,zi=cr,Mi=Pi;function qi(o){return zi(Mi(o))}var Li=qi,Bi=cr,Fi=Li,Ri=ir;function Hi(o){var e=Ri(o)?Bi:Fi;return e(o)}var Qe=Hi;function at(o,e,t){const r=o.slice();return r[4]=e[t],r[6]=t,r}function st(o){let e,t,r,i,l,s;function a(){return o[3](o[4])}return{c(){e=I("div"),t=I("img"),i=q(),this.h()},l(f){e=E(f,"DIV",{class:!0});var c=x(e);t=E(c,"IMG",{src:!0}),i=L(c),c.forEach(b),this.h()},h(){Q(t.src,r=o[4].imageUrl)||m(t,"src",r),m(e,"class","avatar svelte-i1o3ve"),ee(e,"selected",o[1]==o[4]._id)},m(f,c){S(f,e,c),A(e,t),A(e,i),l||(s=F(e,"click",a),l=!0)},p(f,c){o=f,c&1&&!Q(t.src,r=o[4].imageUrl)&&m(t,"src",r),c&3&&ee(e,"selected",o[1]==o[4]._id)},d(f){f&&b(e),l=!1,s()}}}function Gi(o){let e,t,r,i,l,s=o[0],a=[];for(let f=0;f<s.length;f+=1)a[f]=st(at(o,s,f));return{c(){e=I("div"),t=I("div"),r=R("Select your avatar"),i=q(),l=I("div");for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){e=E(f,"DIV",{class:!0});var c=x(e);t=E(c,"DIV",{});var p=x(t);r=H(p,"Select your avatar"),p.forEach(b),i=L(c),l=E(c,"DIV",{class:!0});var n=x(l);for(let u=0;u<a.length;u+=1)a[u].l(n);n.forEach(b),c.forEach(b),this.h()},h(){m(l,"class","inner svelte-i1o3ve"),m(e,"class","avatar-picker")},m(f,c){S(f,e,c),A(e,t),A(t,r),A(e,i),A(e,l);for(let p=0;p<a.length;p+=1)a[p].m(l,null)},p(f,[c]){if(c&7){s=f[0];let p;for(p=0;p<s.length;p+=1){const n=at(f,s,p);a[p]?a[p].p(n,c):(a[p]=st(n),a[p].c(),a[p].m(l,null))}for(;p<a.length;p+=1)a[p].d(1);a.length=s.length}},i:le,o:le,d(f){f&&b(e),He(a,f)}}}function Ni(o,e,t){const r=me();let{avatars:i=[]}=e,l=Qe(i)._id;r("select",{id:l});const s=a=>{t(1,l=a._id),r("select",{id:a._id})};return o.$$set=a=>{"avatars"in a&&t(0,i=a.avatars)},[i,l,r,s]}class Ui extends te{constructor(e){super(),re(this,e,Ni,Gi,ne,{avatars:0})}}function ft(o,e,t){const r=o.slice();return r[14]=e[t],r[16]=t,r}function ut(o){let e,t=o[1],r=[];for(let i=0;i<t.length;i+=1)r[i]=dt(ft(o,t,i));return{c(){for(let i=0;i<r.length;i+=1)r[i].c();e=B()},l(i){for(let l=0;l<r.length;l+=1)r[l].l(i);e=B()},m(i,l){for(let s=0;s<r.length;s+=1)r[s].m(i,l);S(i,e,l)},p(i,l){if(l&38){t=i[1];let s;for(s=0;s<t.length;s+=1){const a=ft(i,t,s);r[s]?r[s].p(a,l):(r[s]=dt(a),r[s].c(),r[s].m(e.parentNode,e))}for(;s<r.length;s+=1)r[s].d(1);r.length=t.length}},d(i){He(r,i),i&&b(e)}}}function ct(o){let e,t,r=Ve(fe(o[14],"content.content",[]))+"",i,l,s,a,f,c;return{c(){e=I("div"),t=new pr(!1),i=q(),l=I("div"),s=R("Next"),a=q(),this.h()},l(p){e=E(p,"DIV",{class:!0});var n=x(e);t=vr(n,!1),i=L(n),l=E(n,"DIV",{class:!0});var u=x(l);s=H(u,"Next"),u.forEach(b),a=L(n),n.forEach(b),this.h()},h(){t.a=i,m(l,"class","btn next svelte-1i69y61"),m(e,"class","slide")},m(p,n){S(p,e,n),t.m(r,e),A(e,i),A(e,l),A(l,s),A(e,a),f||(c=[F(l,"click",o[5]),F(e,"keydown",o[7])],f=!0)},p(p,n){n&2&&r!==(r=Ve(fe(p[14],"content.content",[]))+"")&&t.p(r)},d(p){p&&b(e),f=!1,Ie(c)}}}function dt(o){let e,t=o[16]===o[2]&&ct(o);return{c(){t&&t.c(),e=B()},l(r){t&&t.l(r),e=B()},m(r,i){t&&t.m(r,i),S(r,e,i)},p(r,i){r[16]===r[2]?t?t.p(r,i):(t=ct(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){t&&t.d(r),r&&b(e)}}}function _t(o){let e,t,r,i,l,s,a,f,c,p,n;return{c(){e=I("div"),t=I("div"),r=R("What would you like to be called?"),i=q(),l=I("div"),s=I("input"),a=q(),f=I("div"),c=R("Next"),this.h()},l(u){e=E(u,"DIV",{class:!0});var d=x(e);t=E(d,"DIV",{class:!0});var _=x(t);r=H(_,"What would you like to be called?"),_.forEach(b),i=L(d),l=E(d,"DIV",{class:!0});var g=x(l);s=E(g,"INPUT",{class:!0,type:!0,placeholder:!0}),g.forEach(b),a=L(d),f=E(d,"DIV",{class:!0});var h=x(f);c=H(h,"Next"),h.forEach(b),d.forEach(b),this.h()},h(){m(t,"class","name svelte-1i69y61"),m(s,"class","name svelte-1i69y61"),m(s,"type","text"),m(s,"placeholder","Name"),s.autofocus=!0,m(l,"class","input-container"),m(f,"class","btn next svelte-1i69y61"),m(e,"class","slide")},m(u,d){S(u,e,d),A(e,t),A(t,r),A(e,i),A(e,l),A(l,s),Le(s,o[3]),A(e,a),A(e,f),A(f,c),s.focus(),p||(n=[F(s,"input",o[8]),F(s,"keydown",o[9]),F(f,"click",o[5])],p=!0)},p(u,d){d&8&&s.value!==u[3]&&Le(s,u[3])},d(u){u&&b(e),p=!1,Ie(n)}}}function pt(o){let e,t,r,i,l,s,a,f,c;return r=new Ui({props:{avatars:o[0]}}),r.$on("select",o[10]),{c(){e=I("div"),t=I("div"),Y(r.$$.fragment),i=q(),l=I("div"),s=R("Enter"),this.h()},l(p){e=E(p,"DIV",{class:!0});var n=x(e);t=E(n,"DIV",{class:!0});var u=x(t);W(r.$$.fragment,u),u.forEach(b),i=L(n),l=E(n,"DIV",{class:!0});var d=x(l);s=H(d,"Enter"),d.forEach(b),n.forEach(b),this.h()},h(){m(t,"class","name svelte-1i69y61"),m(l,"class","btn next svelte-1i69y61"),m(e,"class","slide")},m(p,n){S(p,e,n),A(e,t),Z(r,t,null),A(e,i),A(e,l),A(l,s),a=!0,f||(c=[F(l,"click",o[6]),F(e,"keydown",o[11])],f=!0)},p(p,n){const u={};n&1&&(u.avatars=p[0]),r.$set(u)},i(p){a||(T(r.$$.fragment,p),a=!0)},o(p){D(r.$$.fragment,p),a=!1},d(p){p&&b(e),K(r),f=!1,Ie(c)}}}function Ci(o){let e,t,r,i,l,s=o[1]&&ut(o),a=o[2]===o[1].length&&_t(o),f=o[2]===o[1].length+1&&pt(o);return{c(){e=I("div"),t=I("div"),s&&s.c(),r=q(),a&&a.c(),i=q(),f&&f.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var p=x(e);t=E(p,"DIV",{class:!0});var n=x(t);s&&s.l(n),r=L(n),a&&a.l(n),i=L(n),f&&f.l(n),n.forEach(b),p.forEach(b),this.h()},h(){m(t,"class","box svelte-1i69y61"),m(e,"class","onboarding-screen svelte-1i69y61")},m(c,p){S(c,e,p),A(e,t),s&&s.m(t,null),A(t,r),a&&a.m(t,null),A(t,i),f&&f.m(t,null),l=!0},p(c,[p]){c[1]?s?s.p(c,p):(s=ut(c),s.c(),s.m(t,r)):s&&(s.d(1),s=null),c[2]===c[1].length?a?a.p(c,p):(a=_t(c),a.c(),a.m(t,i)):a&&(a.d(1),a=null),c[2]===c[1].length+1?f?(f.p(c,p),p&6&&T(f,1)):(f=pt(c),f.c(),T(f,1),f.m(t,null)):f&&(U(),D(f,1,1,()=>{f=null}),C())},i(c){l||(T(f),l=!0)},o(c){D(f),l=!1},d(c){c&&b(e),s&&s.d(),a&&a.d(),f&&f.d()}}}function Xi(o,e,t){const r=me();let{avatars:i=[]}=e,l={},s=!1,a=0,f="",c="";const p=()=>t(2,a++,a),n=()=>{r("finish",{name:f,avatar:c})};ke(async()=>{l=await jr(),t(1,s=l.tutorialSlides)});const u=v=>v.key==="Enter"&&p();function d(){f=this.value,t(3,f)}const _=v=>v.key==="Enter"&&p(),g=v=>{t(4,c=v.detail.id)},h=v=>v.key==="Enter"&&n();return o.$$set=v=>{"avatars"in v&&t(0,i=v.avatars)},[i,s,a,f,c,p,n,u,d,_,g,h]}class Yi extends te{constructor(e){super(),re(this,e,Xi,Ci,ne,{avatars:0})}}function vt(o){let e,t;return{c(){e=I("video"),this.h()},l(r){e=E(r,"VIDEO",{src:!0,class:!0}),x(e).forEach(b),this.h()},h(){Q(e.src,t=o[0].bgVideoUrl)||m(e,"src",t),e.autoplay=!0,e.loop=!0,e.muted=!0,m(e,"class","svelte-947h49")},m(r,i){S(r,e,i)},p(r,i){i&1&&!Q(e.src,t=r[0].bgVideoUrl)&&m(e,"src",t)},d(r){r&&b(e)}}}function Wi(o){let e,t,r,i;const l=o[3].default,s=mr(l,o,o[2],null);let a=o[0].bgVideoUrl&&vt(o);return{c(){e=I("div"),s&&s.c(),t=q(),a&&a.c(),this.h()},l(f){e=E(f,"DIV",{class:!0,id:!0,style:!0,"aria-live":!0});var c=x(e);s&&s.l(c),t=L(c),a&&a.l(c),c.forEach(b),this.h()},h(){m(e,"class","room svelte-947h49"),m(e,"id","room"),m(e,"style",r=`${o[0].inlineStyles} ${o[1]}`),m(e,"aria-live","polite")},m(f,c){S(f,e,c),s&&s.m(e,null),A(e,t),a&&a.m(e,null),i=!0},p(f,[c]){s&&s.p&&(!i||c&4)&&hr(s,l,f,f[2],i?gr(l,f[2],c,null):br(f[2]),null),f[0].bgVideoUrl?a?a.p(f,c):(a=vt(f),a.c(),a.m(e,null)):a&&(a.d(1),a=null),(!i||c&3&&r!==(r=`${f[0].inlineStyles} ${f[1]}`))&&m(e,"style",r)},i(f){i||(T(s,f),i=!0)},o(f){D(s,f),i=!1},d(f){f&&b(e),s&&s.d(f),a&&a.d()}}}function Zi(o,e,t){let r;N(o,lr,a=>t(1,r=a));let{$$slots:i={},$$scope:l}=e,{room:s={}}=e;return o.$$set=a=>{"room"in a&&t(0,s=a.room),"$$scope"in a&&t(2,l=a.$$scope)},[s,r,l,i]}class Ki extends te{constructor(e){super(),re(this,e,Zi,Wi,ne,{room:0})}}function Qi(o){let e,t,r,i,l,s,a;return{c(){e=I("div"),t=I("img"),this.h()},l(f){e=E(f,"DIV",{class:!0,id:!0,alt:!0,style:!0});var c=x(e);t=E(c,"IMG",{src:!0,class:!0}),c.forEach(b),this.h()},h(){Q(t.src,r=o[7]&&o[7].imageUrl?o[7].imageUrl:Qe(o[1]).imageUrl)||m(t,"src",r),m(t,"class","svelte-1qs6xkk"),m(e,"class","avatar svelte-1qs6xkk"),m(e,"id",o[2]),m(e,"alt",i=o[0].name),m(e,"style",l="transform: translateY("+o[4]+"px) translateX("+o[5]+"px)"),ee(e,"shown",!o[6]||o[0].self),ee(e,"self",o[0].self),ee(e,"blinking",o[6]&&o[0].self)},m(f,c){S(f,e,c),A(e,t),o[9](e),a=!0},p(f,[c]){(!a||c&2&&!Q(t.src,r=f[7]&&f[7].imageUrl?f[7].imageUrl:Qe(f[1]).imageUrl))&&m(t,"src",r),(!a||c&4)&&m(e,"id",f[2]),(!a||c&1&&i!==(i=f[0].name))&&m(e,"alt",i),(!a||c&48&&l!==(l="transform: translateY("+f[4]+"px) translateX("+f[5]+"px)"))&&m(e,"style",l),c&65&&ee(e,"shown",!f[6]||f[0].self),c&1&&ee(e,"self",f[0].self),c&65&&ee(e,"blinking",f[6]&&f[0].self)},i(f){a||(_e(()=>{s||(s=ue(e,se,{},!0)),s.run(1)}),a=!0)},o(f){s||(s=ue(e,se,{},!1)),s.run(0),a=!1},d(f){f&&b(e),o[9](null),f&&s&&s.end()}}}function Ji(o,e,t){let r,i,l;N(o,Ye,y=>t(12,r=y)),N(o,or,y=>t(8,i=y)),N(o,je,y=>t(6,l=y));let s={},a={};const f=y=>{s.popper&&(s.hide(),s.destroy(),clearTimeout(a)),u&&u.nodeName&&(s=tippy(u,{content:y.text,arrow:!1,offset:[0,5],sticky:!0,animation:"fade",inertia:!0,theme:"chat",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}),s.show(),a=setTimeout(()=>{s.hide(),setTimeout(()=>{s.destroy()},500)},4e3))};let{player:c={}}=e,{avatars:p=[]}=e,{key:n=""}=e,u={},d=p.find(y=>y._id===c.shape),_=c.y*ce,g=c.x*ce;const h=()=>{if(u&&u.parentElement){let y=u.getBoundingClientRect();if(y.left<(r?40:100)||y.top<(r?120:100)||y.right>window.innerWidth-(r?40:100)||y.bottom>window.innerHeight-(r?180:100))return!0}return!1},v=()=>{lr.set(`transform: translateX(-${g}px) translateY(-${_}px);`)};ke(async()=>{c.self||tippy(u,{content:c.name,arrow:!1,offset:[0,5],theme:"name",hideOnClick:!1,placement:"bottom",popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",enabled:!1}]}}),c.self&&v()});function k(y){ze[y?"unshift":"push"](()=>{u=y,t(3,u)})}return o.$$set=y=>{"player"in y&&t(0,c=y.player),"avatars"in y&&t(1,p=y.avatars),"key"in y&&t(2,n=y.key)},o.$$.update=()=>{if(o.$$.dirty&260){let y=i[i.length-1];y&&y.uuid==n&&Date.now()-y.timestamp<5e3&&f(y)}o.$$.dirty&1&&(t(4,_=c.y*ce),t(5,g=c.x*ce)),o.$$.dirty&1&&c.self&&(c.x||c.y)&&h()&&v()},[c,p,n,u,_,g,l,d,i,k]}class el extends te{constructor(e){super(),re(this,e,Ji,Qi,ne,{player:0,avatars:1,key:2})}}function mt(o,e,t){const r=o.slice();return r[3]=e[t][0],r[4]=e[t][1],r}function ht(o){let e,t;return e=new el({props:{player:o[4],key:o[3],avatars:o[2]}}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i&1&&(l.player=r[4]),i&1&&(l.key=r[3]),i&4&&(l.avatars=r[2]),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function bt(o,e){let t,r,i,l=e[4].room===e[1]&&!e[4].inTransit&&ht(e);return{key:o,first:null,c(){t=B(),l&&l.c(),r=B(),this.h()},l(s){t=B(),l&&l.l(s),r=B(),this.h()},h(){this.first=t},m(s,a){S(s,t,a),l&&l.m(s,a),S(s,r,a),i=!0},p(s,a){e=s,e[4].room===e[1]&&!e[4].inTransit?l?(l.p(e,a),a&3&&T(l,1)):(l=ht(e),l.c(),T(l,1),l.m(r.parentNode,r)):l&&(U(),D(l,1,1,()=>{l=null}),C())},i(s){i||(T(l),i=!0)},o(s){D(l),i=!1},d(s){s&&b(t),l&&l.d(s),s&&b(r)}}}function tl(o){let e=[],t=new Map,r,i,l=Object.entries(o[0]);const s=a=>a[3];for(let a=0;a<l.length;a+=1){let f=mt(o,l,a),c=s(f);t.set(c,e[a]=bt(c,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=B()},l(a){for(let f=0;f<e.length;f+=1)e[f].l(a);r=B()},m(a,f){for(let c=0;c<e.length;c+=1)e[c].m(a,f);S(a,r,f),i=!0},p(a,[f]){f&7&&(l=Object.entries(a[0]),U(),e=Ge(e,f,s,1,a,l,t,r.parentNode,Ne,bt,r,mt),C())},i(a){if(!i){for(let f=0;f<l.length;f+=1)T(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)D(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&b(r)}}}function rl(o,e,t){let{players:r={}}=e,{currentRoomId:i=""}=e,{avatars:l=[]}=e;return o.$$set=s=>{"players"in s&&t(0,r=s.players),"currentRoomId"in s&&t(1,i=s.currentRoomId),"avatars"in s&&t(2,l=s.avatars)},[r,i,l]}class nl extends te{constructor(e){super(),re(this,e,rl,tl,ne,{players:0,currentRoomId:1,avatars:2})}}function gt(o){let e,t,r;return{c(){e=I("img"),this.h()},l(i){e=E(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Q(e.src,t=Ae(o[0].iconImage).quality(100).height(300).url())||m(e,"src",t),m(e,"alt",r=o[0].title),m(e,"class","svelte-pj284l")},m(i,l){S(i,e,l)},p(i,l){l&1&&!Q(e.src,t=Ae(i[0].iconImage).quality(100).height(300).url())&&m(e,"src",t),l&1&&r!==(r=i[0].title)&&m(e,"alt",r)},d(i){i&&b(e)}}}function il(o){let e,t,r,i,l,s,a,f,c=o[0].iconImage&&gt(o);return{c(){e=I("div"),c&&c.c(),this.h()},l(p){e=E(p,"DIV",{class:!0,id:!0,alt:!0,style:!0,tabindex:!0,"aria-label":!0});var n=x(e);c&&c.l(n),n.forEach(b),this.h()},h(){m(e,"class","object svelte-pj284l"),m(e,"id",t=o[0]._id),m(e,"alt",r=o[0].title),m(e,"style",o[3]),m(e,"tabindex","0"),m(e,"aria-label",i=o[0].static?"Inspect "+o[0].title:"A static image of a "+o[0].title),ee(e,"static",o[0].static),ee(e,"image",o[0].iconImage)},m(p,n){S(p,e,n),c&&c.m(e,null),o[7](e),s=!0,a||(f=[F(e,"click",ll),F(e,"keydown",o[8])],a=!0)},p(p,[n]){p[0].iconImage?c?c.p(p,n):(c=gt(p),c.c(),c.m(e,null)):c&&(c.d(1),c=null),(!s||n&1&&t!==(t=p[0]._id))&&m(e,"id",t),(!s||n&1&&r!==(r=p[0].title))&&m(e,"alt",r),(!s||n&1&&i!==(i=p[0].static?"Inspect "+p[0].title:"A static image of a "+p[0].title))&&m(e,"aria-label",i),n&1&&ee(e,"static",p[0].static),n&1&&ee(e,"image",p[0].iconImage)},i(p){s||(_e(()=>{l||(l=ue(e,se,{},!0)),l.run(1)}),s=!0)},o(p){l||(l=ue(e,se,{},!1)),l.run(0),s=!1},d(p){p&&b(e),c&&c.d(),o[7](null),p&&l&&l.end(),a=!1,Ie(f)}}}const ll=()=>{};function ol(o,e,t){let r,i;N(o,Pe,h=>t(6,r=h)),N(o,qe,h=>t(2,i=h));let{object:l={}}=e,s={},a={},f=l.y*ce,c=l.x*ce,p=fe(l,"dimensions.width",1)*ce,n=fe(l,"dimensions.height",1)*ce;const u=`transform: translateY(${f}px) translateX(${c}px); width: ${p}px; height: ${n}px;`;ke(async()=>{const h=Je;h.content=l.title,h.appendTo=s.parentElement,h.theme=l.static?"static":"name",t(5,a=tippy(s,h))});const d=me();function _(h){ze[h?"unshift":"push"](()=>{s=h,t(1,s)})}const g=h=>{console.log("e: ",h),h.key==="Enter"&&!l.static&&(d("object",{objectId:l._id}),ye.set(i.objects.find(v=>v._id==l._id)))};return o.$$set=h=>{"object"in h&&t(0,l=h.object)},o.$$.update=()=>{o.$$.dirty&96&&a.popper&&(r?a.show():a.hide())},[l,s,i,u,d,a,r,_,g]}class al extends te{constructor(e){super(),re(this,e,ol,il,ne,{object:0})}}function yt(o,e,t){const r=o.slice();return r[2]=e[t],r}function wt(o){let e=[],t=new Map,r,i,l=o[0];const s=a=>a[2]._id;for(let a=0;a<l.length;a+=1){let f=yt(o,l,a),c=s(f);t.set(c,e[a]=kt(c,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=B()},l(a){for(let f=0;f<e.length;f+=1)e[f].l(a);r=B()},m(a,f){for(let c=0;c<e.length;c+=1)e[c].m(a,f);S(a,r,f),i=!0},p(a,f){f&1&&(l=a[0],U(),e=Ge(e,f,s,1,a,l,t,r.parentNode,Ne,kt,r,yt),C())},i(a){if(!i){for(let f=0;f<l.length;f+=1)T(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)D(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&b(r)}}}function kt(o,e){let t,r,i;return r=new al({props:{object:e[2]}}),{key:o,first:null,c(){t=B(),Y(r.$$.fragment),this.h()},l(l){t=B(),W(r.$$.fragment,l),this.h()},h(){this.first=t},m(l,s){S(l,t,s),Z(r,l,s),i=!0},p(l,s){e=l;const a={};s&1&&(a.object=e[2]),r.$set(a)},i(l){i||(T(r.$$.fragment,l),i=!0)},o(l){D(r.$$.fragment,l),i=!1},d(l){l&&b(t),K(r,l)}}}function sl(o){let e,t,r=!o[1]&&wt(o);return{c(){r&&r.c(),e=B()},l(i){r&&r.l(i),e=B()},m(i,l){r&&r.m(i,l),S(i,e,l),t=!0},p(i,[l]){i[1]?r&&(U(),D(r,1,1,()=>{r=null}),C()):r?(r.p(i,l),l&2&&T(r,1)):(r=wt(i),r.c(),T(r,1),r.m(e.parentNode,e))},i(i){t||(T(r),t=!0)},o(i){D(r),t=!1},d(i){r&&r.d(i),i&&b(e)}}}function fl(o,e,t){let r;N(o,je,l=>t(1,r=l));let{objects:i={}}=e;return o.$$set=l=>{"objects"in l&&t(0,i=l.objects)},[i,r]}class ul extends te{constructor(e){super(),re(this,e,fl,sl,ne,{objects:0})}}function cl(o){let e,t;return{c(){e=I("img"),this.h()},l(r){e=E(r,"IMG",{src:!0,class:!0}),this.h()},h(){Q(e.src,t=Ae(o[0].backgroundImage).quality(100).url())||m(e,"src",t),m(e,"class","svelte-8z8z6b")},m(r,i){S(r,e,i)},p(r,i){i&1&&!Q(e.src,t=Ae(r[0].backgroundImage).quality(100).url())&&m(e,"src",t)},d(r){r&&b(e)}}}function dl(o){let e,t;return{c(){e=I("video"),this.h()},l(r){e=E(r,"VIDEO",{src:!0,class:!0}),x(e).forEach(b),this.h()},h(){Q(e.src,t=o[0].bgVideoUrl)||m(e,"src",t),e.autoplay=!0,e.loop=!0,e.muted=!0,m(e,"class","svelte-8z8z6b")},m(r,i){S(r,e,i)},p(r,i){i&1&&!Q(e.src,t=r[0].bgVideoUrl)&&m(e,"src",t)},d(r){r&&b(e)}}}function _l(o){let e,t,r,i,l;function s(c,p){if(c[0].bgVideoUrl)return dl;if(c[0].backgroundImage)return cl}let a=s(o),f=a&&a(o);return{c(){e=I("div"),f&&f.c(),this.h()},l(c){e=E(c,"DIV",{class:!0,id:!0,alt:!0,style:!0});var p=x(e);f&&f.l(p),p.forEach(b),this.h()},h(){m(e,"class","zone svelte-8z8z6b"),m(e,"id",t=o[0]._id),m(e,"alt",r=o[0].title),m(e,"style",o[2])},m(c,p){S(c,e,p),f&&f.m(e,null),o[5](e),l=!0},p(c,[p]){a===(a=s(c))&&f?f.p(c,p):(f&&f.d(1),f=a&&a(c),f&&(f.c(),f.m(e,null))),(!l||p&1&&t!==(t=c[0]._id))&&m(e,"id",t),(!l||p&1&&r!==(r=c[0].title))&&m(e,"alt",r)},i(c){l||(_e(()=>{i||(i=ue(e,se,{},!0)),i.run(1)}),l=!0)},o(c){i||(i=ue(e,se,{},!1)),i.run(0),l=!1},d(c){c&&b(e),f&&f.d(),o[5](null),c&&i&&i.end()}}}function pl(o,e,t){let r;N(o,Pe,d=>t(4,r=d));let{zone:i={}}=e,l={},s={},a=i.y*ce,f=i.x*ce,c=fe(i,"dimensions.width",1)*ce,p=fe(i,"dimensions.height",1)*ce;const n=`transform: translateY(${a}px) translateX(${f}px); width: ${c}px; height: ${p}px;};`;ke(async()=>{const d=Je;d.content=i.title,d.appendTo=l.parentElement,d.theme="name",t(3,s=tippy(l,d))});function u(d){ze[d?"unshift":"push"](()=>{l=d,t(1,l)})}return o.$$set=d=>{"zone"in d&&t(0,i=d.zone)},o.$$.update=()=>{o.$$.dirty&24&&s.popper&&(r?s.show():s.hide())},[i,l,n,s,r,u]}class vl extends te{constructor(e){super(),re(this,e,pl,_l,ne,{zone:0})}}function At(o,e,t){const r=o.slice();return r[2]=e[t],r}function Tt(o){let e=[],t=new Map,r,i,l=o[0];const s=a=>a[2]._id;for(let a=0;a<l.length;a+=1){let f=At(o,l,a),c=s(f);t.set(c,e[a]=It(c,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=B()},l(a){for(let f=0;f<e.length;f+=1)e[f].l(a);r=B()},m(a,f){for(let c=0;c<e.length;c+=1)e[c].m(a,f);S(a,r,f),i=!0},p(a,f){f&1&&(l=a[0],U(),e=Ge(e,f,s,1,a,l,t,r.parentNode,Ne,It,r,At),C())},i(a){if(!i){for(let f=0;f<l.length;f+=1)T(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)D(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&b(r)}}}function It(o,e){let t,r,i;return r=new vl({props:{zone:e[2]}}),{key:o,first:null,c(){t=B(),Y(r.$$.fragment),this.h()},l(l){t=B(),W(r.$$.fragment,l),this.h()},h(){this.first=t},m(l,s){S(l,t,s),Z(r,l,s),i=!0},p(l,s){e=l;const a={};s&1&&(a.zone=e[2]),r.$set(a)},i(l){i||(T(r.$$.fragment,l),i=!0)},o(l){D(r.$$.fragment,l),i=!1},d(l){l&&b(t),K(r,l)}}}function ml(o){let e,t,r=!o[1]&&Tt(o);return{c(){r&&r.c(),e=B()},l(i){r&&r.l(i),e=B()},m(i,l){r&&r.m(i,l),S(i,e,l),t=!0},p(i,[l]){i[1]?r&&(U(),D(r,1,1,()=>{r=null}),C()):r?(r.p(i,l),l&2&&T(r,1)):(r=Tt(i),r.c(),T(r,1),r.m(e.parentNode,e))},i(i){t||(T(r),t=!0)},o(i){D(r),t=!1},d(i){r&&r.d(i),i&&b(e)}}}function hl(o,e,t){let r;N(o,je,l=>t(1,r=l));let{zones:i={}}=e;return o.$$set=l=>{"zones"in l&&t(0,i=l.zones)},[i,r]}class bl extends te{constructor(e){super(),re(this,e,hl,ml,ne,{zones:0})}}var dr={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(o){(function(){var e=function(){this.init()};e.prototype={init:function(){var n=this||t;return n._counter=1e3,n._html5AudioPool=[],n.html5PoolSize=10,n._codecs={},n._howls=[],n._muted=!1,n._volume=1,n._canPlayEvent="canplaythrough",n._navigator=typeof window!="undefined"&&window.navigator?window.navigator:null,n.masterGain=null,n.noAudio=!1,n.usingWebAudio=!0,n.autoSuspend=!0,n.ctx=null,n.autoUnlock=!0,n._setup(),n},volume:function(n){var u=this||t;if(n=parseFloat(n),u.ctx||p(),typeof n!="undefined"&&n>=0&&n<=1){if(u._volume=n,u._muted)return u;u.usingWebAudio&&u.masterGain.gain.setValueAtTime(n,t.ctx.currentTime);for(var d=0;d<u._howls.length;d++)if(!u._howls[d]._webAudio)for(var _=u._howls[d]._getSoundIds(),g=0;g<_.length;g++){var h=u._howls[d]._soundById(_[g]);h&&h._node&&(h._node.volume=h._volume*n)}return u}return u._volume},mute:function(n){var u=this||t;u.ctx||p(),u._muted=n,u.usingWebAudio&&u.masterGain.gain.setValueAtTime(n?0:u._volume,t.ctx.currentTime);for(var d=0;d<u._howls.length;d++)if(!u._howls[d]._webAudio)for(var _=u._howls[d]._getSoundIds(),g=0;g<_.length;g++){var h=u._howls[d]._soundById(_[g]);h&&h._node&&(h._node.muted=n?!0:h._muted)}return u},stop:function(){for(var n=this||t,u=0;u<n._howls.length;u++)n._howls[u].stop();return n},unload:function(){for(var n=this||t,u=n._howls.length-1;u>=0;u--)n._howls[u].unload();return n.usingWebAudio&&n.ctx&&typeof n.ctx.close!="undefined"&&(n.ctx.close(),n.ctx=null,p()),n},codecs:function(n){return(this||t)._codecs[n.replace(/^x-/,"")]},_setup:function(){var n=this||t;if(n.state=n.ctx&&n.ctx.state||"suspended",n._autoSuspend(),!n.usingWebAudio)if(typeof Audio!="undefined")try{var u=new Audio;typeof u.oncanplaythrough=="undefined"&&(n._canPlayEvent="canplay")}catch{n.noAudio=!0}else n.noAudio=!0;try{var u=new Audio;u.muted&&(n.noAudio=!0)}catch{}return n.noAudio||n._setupCodecs(),n},_setupCodecs:function(){var n=this||t,u=null;try{u=typeof Audio!="undefined"?new Audio:null}catch{return n}if(!u||typeof u.canPlayType!="function")return n;var d=u.canPlayType("audio/mpeg;").replace(/^no$/,""),_=n._navigator?n._navigator.userAgent:"",g=_.match(/OPR\/([0-6].)/g),h=g&&parseInt(g[0].split("/")[1],10)<33,v=_.indexOf("Safari")!==-1&&_.indexOf("Chrome")===-1,k=_.match(/Version\/(.*?) /),y=v&&k&&parseInt(k[1],10)<15;return n._codecs={mp3:!!(!h&&(d||u.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!d,opus:!!u.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!u.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!u.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(u.canPlayType('audio/wav; codecs="1"')||u.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!u.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!u.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(u.canPlayType("audio/x-m4a;")||u.canPlayType("audio/m4a;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(u.canPlayType("audio/x-m4b;")||u.canPlayType("audio/m4b;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(u.canPlayType("audio/x-mp4;")||u.canPlayType("audio/mp4;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!y&&u.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!y&&u.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!u.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(u.canPlayType("audio/x-flac;")||u.canPlayType("audio/flac;")).replace(/^no$/,"")},n},_unlockAudio:function(){var n=this||t;if(!(n._audioUnlocked||!n.ctx)){n._audioUnlocked=!1,n.autoUnlock=!1,!n._mobileUnloaded&&n.ctx.sampleRate!==44100&&(n._mobileUnloaded=!0,n.unload()),n._scratchBuffer=n.ctx.createBuffer(1,1,22050);var u=function(d){for(;n._html5AudioPool.length<n.html5PoolSize;)try{var _=new Audio;_._unlocked=!0,n._releaseHtml5Audio(_)}catch{n.noAudio=!0;break}for(var g=0;g<n._howls.length;g++)if(!n._howls[g]._webAudio)for(var h=n._howls[g]._getSoundIds(),v=0;v<h.length;v++){var k=n._howls[g]._soundById(h[v]);k&&k._node&&!k._node._unlocked&&(k._node._unlocked=!0,k._node.load())}n._autoResume();var y=n.ctx.createBufferSource();y.buffer=n._scratchBuffer,y.connect(n.ctx.destination),typeof y.start=="undefined"?y.noteOn(0):y.start(0),typeof n.ctx.resume=="function"&&n.ctx.resume(),y.onended=function(){y.disconnect(0),n._audioUnlocked=!0,document.removeEventListener("touchstart",u,!0),document.removeEventListener("touchend",u,!0),document.removeEventListener("click",u,!0),document.removeEventListener("keydown",u,!0);for(var $=0;$<n._howls.length;$++)n._howls[$]._emit("unlock")}};return document.addEventListener("touchstart",u,!0),document.addEventListener("touchend",u,!0),document.addEventListener("click",u,!0),document.addEventListener("keydown",u,!0),n}},_obtainHtml5Audio:function(){var n=this||t;if(n._html5AudioPool.length)return n._html5AudioPool.pop();var u=new Audio().play();return u&&typeof Promise!="undefined"&&(u instanceof Promise||typeof u.then=="function")&&u.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(n){var u=this||t;return n._unlocked&&u._html5AudioPool.push(n),u},_autoSuspend:function(){var n=this;if(!(!n.autoSuspend||!n.ctx||typeof n.ctx.suspend=="undefined"||!t.usingWebAudio)){for(var u=0;u<n._howls.length;u++)if(n._howls[u]._webAudio){for(var d=0;d<n._howls[u]._sounds.length;d++)if(!n._howls[u]._sounds[d]._paused)return n}return n._suspendTimer&&clearTimeout(n._suspendTimer),n._suspendTimer=setTimeout(function(){if(!!n.autoSuspend){n._suspendTimer=null,n.state="suspending";var _=function(){n.state="suspended",n._resumeAfterSuspend&&(delete n._resumeAfterSuspend,n._autoResume())};n.ctx.suspend().then(_,_)}},3e4),n}},_autoResume:function(){var n=this;if(!(!n.ctx||typeof n.ctx.resume=="undefined"||!t.usingWebAudio))return n.state==="running"&&n.ctx.state!=="interrupted"&&n._suspendTimer?(clearTimeout(n._suspendTimer),n._suspendTimer=null):n.state==="suspended"||n.state==="running"&&n.ctx.state==="interrupted"?(n.ctx.resume().then(function(){n.state="running";for(var u=0;u<n._howls.length;u++)n._howls[u]._emit("resume")}),n._suspendTimer&&(clearTimeout(n._suspendTimer),n._suspendTimer=null)):n.state==="suspending"&&(n._resumeAfterSuspend=!0),n}};var t=new e,r=function(n){var u=this;if(!n.src||n.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}u.init(n)};r.prototype={init:function(n){var u=this;return t.ctx||p(),u._autoplay=n.autoplay||!1,u._format=typeof n.format!="string"?n.format:[n.format],u._html5=n.html5||!1,u._muted=n.mute||!1,u._loop=n.loop||!1,u._pool=n.pool||5,u._preload=typeof n.preload=="boolean"||n.preload==="metadata"?n.preload:!0,u._rate=n.rate||1,u._sprite=n.sprite||{},u._src=typeof n.src!="string"?n.src:[n.src],u._volume=n.volume!==void 0?n.volume:1,u._xhr={method:n.xhr&&n.xhr.method?n.xhr.method:"GET",headers:n.xhr&&n.xhr.headers?n.xhr.headers:null,withCredentials:n.xhr&&n.xhr.withCredentials?n.xhr.withCredentials:!1},u._duration=0,u._state="unloaded",u._sounds=[],u._endTimers={},u._queue=[],u._playLock=!1,u._onend=n.onend?[{fn:n.onend}]:[],u._onfade=n.onfade?[{fn:n.onfade}]:[],u._onload=n.onload?[{fn:n.onload}]:[],u._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[],u._onplayerror=n.onplayerror?[{fn:n.onplayerror}]:[],u._onpause=n.onpause?[{fn:n.onpause}]:[],u._onplay=n.onplay?[{fn:n.onplay}]:[],u._onstop=n.onstop?[{fn:n.onstop}]:[],u._onmute=n.onmute?[{fn:n.onmute}]:[],u._onvolume=n.onvolume?[{fn:n.onvolume}]:[],u._onrate=n.onrate?[{fn:n.onrate}]:[],u._onseek=n.onseek?[{fn:n.onseek}]:[],u._onunlock=n.onunlock?[{fn:n.onunlock}]:[],u._onresume=[],u._webAudio=t.usingWebAudio&&!u._html5,typeof t.ctx!="undefined"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(u),u._autoplay&&u._queue.push({event:"play",action:function(){u.play()}}),u._preload&&u._preload!=="none"&&u.load(),u},load:function(){var n=this,u=null;if(t.noAudio){n._emit("loaderror",null,"No audio support.");return}typeof n._src=="string"&&(n._src=[n._src]);for(var d=0;d<n._src.length;d++){var _,g;if(n._format&&n._format[d])_=n._format[d];else{if(g=n._src[d],typeof g!="string"){n._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}_=/^data:audio\/([^;,]+);/i.exec(g),_||(_=/\.([^.]+)$/.exec(g.split("?",1)[0])),_&&(_=_[1].toLowerCase())}if(_||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),_&&t.codecs(_)){u=n._src[d];break}}if(!u){n._emit("loaderror",null,"No codec support for selected audio sources.");return}return n._src=u,n._state="loading",window.location.protocol==="https:"&&u.slice(0,5)==="http:"&&(n._html5=!0,n._webAudio=!1),new i(n),n._webAudio&&s(n),n},play:function(n,u){var d=this,_=null;if(typeof n=="number")_=n,n=null;else{if(typeof n=="string"&&d._state==="loaded"&&!d._sprite[n])return null;if(typeof n=="undefined"&&(n="__default",!d._playLock)){for(var g=0,h=0;h<d._sounds.length;h++)d._sounds[h]._paused&&!d._sounds[h]._ended&&(g++,_=d._sounds[h]._id);g===1?n=null:_=null}}var v=_?d._soundById(_):d._inactiveSound();if(!v)return null;if(_&&!n&&(n=v._sprite||"__default"),d._state!=="loaded"){v._sprite=n,v._ended=!1;var k=v._id;return d._queue.push({event:"play",action:function(){d.play(k)}}),k}if(_&&!v._paused)return u||d._loadQueue("play"),v._id;d._webAudio&&t._autoResume();var y=Math.max(0,v._seek>0?v._seek:d._sprite[n][0]/1e3),$=Math.max(0,(d._sprite[n][0]+d._sprite[n][1])/1e3-y),j=$*1e3/Math.abs(v._rate),O=d._sprite[n][0]/1e3,P=(d._sprite[n][0]+d._sprite[n][1])/1e3;v._sprite=n,v._ended=!1;var M=function(){v._paused=!1,v._seek=y,v._start=O,v._stop=P,v._loop=!!(v._loop||d._sprite[n][2])};if(y>=P){d._ended(v);return}var w=v._node;if(d._webAudio){var z=function(){d._playLock=!1,M(),d._refreshBuffer(v);var X=v._muted||d._muted?0:v._volume;w.gain.setValueAtTime(X,t.ctx.currentTime),v._playStart=t.ctx.currentTime,typeof w.bufferSource.start=="undefined"?v._loop?w.bufferSource.noteGrainOn(0,y,86400):w.bufferSource.noteGrainOn(0,y,$):v._loop?w.bufferSource.start(0,y,86400):w.bufferSource.start(0,y,$),j!==1/0&&(d._endTimers[v._id]=setTimeout(d._ended.bind(d,v),j)),u||setTimeout(function(){d._emit("play",v._id),d._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?z():(d._playLock=!0,d.once("resume",z),d._clearTimer(v._id))}else{var G=function(){w.currentTime=y,w.muted=v._muted||d._muted||t._muted||w.muted,w.volume=v._volume*t.volume(),w.playbackRate=v._rate;try{var X=w.play();if(X&&typeof Promise!="undefined"&&(X instanceof Promise||typeof X.then=="function")?(d._playLock=!0,M(),X.then(function(){d._playLock=!1,w._unlocked=!0,u?d._loadQueue():d._emit("play",v._id)}).catch(function(){d._playLock=!1,d._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):u||(d._playLock=!1,M(),d._emit("play",v._id)),w.playbackRate=v._rate,w.paused){d._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}n!=="__default"||v._loop?d._endTimers[v._id]=setTimeout(d._ended.bind(d,v),j):(d._endTimers[v._id]=function(){d._ended(v),w.removeEventListener("ended",d._endTimers[v._id],!1)},w.addEventListener("ended",d._endTimers[v._id],!1))}catch(de){d._emit("playerror",v._id,de)}};w.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(w.src=d._src,w.load());var oe=window&&window.ejecta||!w.readyState&&t._navigator.isCocoonJS;if(w.readyState>=3||oe)G();else{d._playLock=!0,d._state="loading";var ae=function(){d._state="loaded",G(),w.removeEventListener(t._canPlayEvent,ae,!1)};w.addEventListener(t._canPlayEvent,ae,!1),d._clearTimer(v._id)}}return v._id},pause:function(n){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"pause",action:function(){u.pause(n)}}),u;for(var d=u._getSoundIds(n),_=0;_<d.length;_++){u._clearTimer(d[_]);var g=u._soundById(d[_]);if(g&&!g._paused&&(g._seek=u.seek(d[_]),g._rateSeek=0,g._paused=!0,u._stopFade(d[_]),g._node))if(u._webAudio){if(!g._node.bufferSource)continue;typeof g._node.bufferSource.stop=="undefined"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),u._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||u._emit("pause",g?g._id:null)}return u},stop:function(n,u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(n)}}),d;for(var _=d._getSoundIds(n),g=0;g<_.length;g++){d._clearTimer(_[g]);var h=d._soundById(_[g]);h&&(h._seek=h._start||0,h._rateSeek=0,h._paused=!0,h._ended=!0,d._stopFade(_[g]),h._node&&(d._webAudio?h._node.bufferSource&&(typeof h._node.bufferSource.stop=="undefined"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),d._cleanBuffer(h._node)):(!isNaN(h._node.duration)||h._node.duration===1/0)&&(h._node.currentTime=h._start||0,h._node.pause(),h._node.duration===1/0&&d._clearSound(h._node))),u||d._emit("stop",h._id))}return d},mute:function(n,u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(n,u)}}),d;if(typeof u=="undefined")if(typeof n=="boolean")d._muted=n;else return d._muted;for(var _=d._getSoundIds(u),g=0;g<_.length;g++){var h=d._soundById(_[g]);h&&(h._muted=n,h._interval&&d._stopFade(h._id),d._webAudio&&h._node?h._node.gain.setValueAtTime(n?0:h._volume,t.ctx.currentTime):h._node&&(h._node.muted=t._muted?!0:n),d._emit("mute",h._id))}return d},volume:function(){var n=this,u=arguments,d,_;if(u.length===0)return n._volume;if(u.length===1||u.length===2&&typeof u[1]=="undefined"){var g=n._getSoundIds(),h=g.indexOf(u[0]);h>=0?_=parseInt(u[0],10):d=parseFloat(u[0])}else u.length>=2&&(d=parseFloat(u[0]),_=parseInt(u[1],10));var v;if(typeof d!="undefined"&&d>=0&&d<=1){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,u)}}),n;typeof _=="undefined"&&(n._volume=d),_=n._getSoundIds(_);for(var k=0;k<_.length;k++)v=n._soundById(_[k]),v&&(v._volume=d,u[2]||n._stopFade(_[k]),n._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(d,t.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=d*t.volume()),n._emit("volume",v._id))}else return v=_?n._soundById(_):n._sounds[0],v?v._volume:0;return n},fade:function(n,u,d,_){var g=this;if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(n,u,d,_)}}),g;n=Math.min(Math.max(0,parseFloat(n)),1),u=Math.min(Math.max(0,parseFloat(u)),1),d=parseFloat(d),g.volume(n,_);for(var h=g._getSoundIds(_),v=0;v<h.length;v++){var k=g._soundById(h[v]);if(k){if(_||g._stopFade(h[v]),g._webAudio&&!k._muted){var y=t.ctx.currentTime,$=y+d/1e3;k._volume=n,k._node.gain.setValueAtTime(n,y),k._node.gain.linearRampToValueAtTime(u,$)}g._startFadeInterval(k,n,u,d,h[v],typeof _=="undefined")}}return g},_startFadeInterval:function(n,u,d,_,g,h){var v=this,k=u,y=d-u,$=Math.abs(y/.01),j=Math.max(4,$>0?_/$:_),O=Date.now();n._fadeTo=d,n._interval=setInterval(function(){var P=(Date.now()-O)/_;O=Date.now(),k+=y*P,k=Math.round(k*100)/100,y<0?k=Math.max(d,k):k=Math.min(d,k),v._webAudio?n._volume=k:v.volume(k,n._id,!0),h&&(v._volume=k),(d<u&&k<=d||d>u&&k>=d)&&(clearInterval(n._interval),n._interval=null,n._fadeTo=null,v.volume(d,n._id),v._emit("fade",n._id))},j)},_stopFade:function(n){var u=this,d=u._soundById(n);return d&&d._interval&&(u._webAudio&&d._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(d._interval),d._interval=null,u.volume(d._fadeTo,n),d._fadeTo=null,u._emit("fade",n)),u},loop:function(){var n=this,u=arguments,d,_,g;if(u.length===0)return n._loop;if(u.length===1)if(typeof u[0]=="boolean")d=u[0],n._loop=d;else return g=n._soundById(parseInt(u[0],10)),g?g._loop:!1;else u.length===2&&(d=u[0],_=parseInt(u[1],10));for(var h=n._getSoundIds(_),v=0;v<h.length;v++)g=n._soundById(h[v]),g&&(g._loop=d,n._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=d,d&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,n.playing(h[v])&&(n.pause(h[v],!0),n.play(h[v],!0)))));return n},rate:function(){var n=this,u=arguments,d,_;if(u.length===0)_=n._sounds[0]._id;else if(u.length===1){var g=n._getSoundIds(),h=g.indexOf(u[0]);h>=0?_=parseInt(u[0],10):d=parseFloat(u[0])}else u.length===2&&(d=parseFloat(u[0]),_=parseInt(u[1],10));var v;if(typeof d=="number"){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,u)}}),n;typeof _=="undefined"&&(n._rate=d),_=n._getSoundIds(_);for(var k=0;k<_.length;k++)if(v=n._soundById(_[k]),v){n.playing(_[k])&&(v._rateSeek=n.seek(_[k]),v._playStart=n._webAudio?t.ctx.currentTime:v._playStart),v._rate=d,n._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(d,t.ctx.currentTime):v._node&&(v._node.playbackRate=d);var y=n.seek(_[k]),$=(n._sprite[v._sprite][0]+n._sprite[v._sprite][1])/1e3-y,j=$*1e3/Math.abs(v._rate);(n._endTimers[_[k]]||!v._paused)&&(n._clearTimer(_[k]),n._endTimers[_[k]]=setTimeout(n._ended.bind(n,v),j)),n._emit("rate",v._id)}}else return v=n._soundById(_),v?v._rate:n._rate;return n},seek:function(){var n=this,u=arguments,d,_;if(u.length===0)n._sounds.length&&(_=n._sounds[0]._id);else if(u.length===1){var g=n._getSoundIds(),h=g.indexOf(u[0]);h>=0?_=parseInt(u[0],10):n._sounds.length&&(_=n._sounds[0]._id,d=parseFloat(u[0]))}else u.length===2&&(d=parseFloat(u[0]),_=parseInt(u[1],10));if(typeof _=="undefined")return 0;if(typeof d=="number"&&(n._state!=="loaded"||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,u)}}),n;var v=n._soundById(_);if(v)if(typeof d=="number"&&d>=0){var k=n.playing(_);k&&n.pause(_,!0),v._seek=d,v._ended=!1,n._clearTimer(_),!n._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=d);var y=function(){k&&n.play(_,!0),n._emit("seek",_)};if(k&&!n._webAudio){var $=function(){n._playLock?setTimeout($,0):y()};setTimeout($,0)}else y()}else if(n._webAudio){var j=n.playing(_)?t.ctx.currentTime-v._playStart:0,O=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(O+j*Math.abs(v._rate))}else return v._node.currentTime;return n},playing:function(n){var u=this;if(typeof n=="number"){var d=u._soundById(n);return d?!d._paused:!1}for(var _=0;_<u._sounds.length;_++)if(!u._sounds[_]._paused)return!0;return!1},duration:function(n){var u=this,d=u._duration,_=u._soundById(n);return _&&(d=u._sprite[_._sprite][1]/1e3),d},state:function(){return this._state},unload:function(){for(var n=this,u=n._sounds,d=0;d<u.length;d++)u[d]._paused||n.stop(u[d]._id),n._webAudio||(n._clearSound(u[d]._node),u[d]._node.removeEventListener("error",u[d]._errorFn,!1),u[d]._node.removeEventListener(t._canPlayEvent,u[d]._loadFn,!1),u[d]._node.removeEventListener("ended",u[d]._endFn,!1),t._releaseHtml5Audio(u[d]._node)),delete u[d]._node,n._clearTimer(u[d]._id);var _=t._howls.indexOf(n);_>=0&&t._howls.splice(_,1);var g=!0;for(d=0;d<t._howls.length;d++)if(t._howls[d]._src===n._src||n._src.indexOf(t._howls[d]._src)>=0){g=!1;break}return l&&g&&delete l[n._src],t.noAudio=!1,n._state="unloaded",n._sounds=[],n=null,null},on:function(n,u,d,_){var g=this,h=g["_on"+n];return typeof u=="function"&&h.push(_?{id:d,fn:u,once:_}:{id:d,fn:u}),g},off:function(n,u,d){var _=this,g=_["_on"+n],h=0;if(typeof u=="number"&&(d=u,u=null),u||d)for(h=0;h<g.length;h++){var v=d===g[h].id;if(u===g[h].fn&&v||!u&&v){g.splice(h,1);break}}else if(n)_["_on"+n]=[];else{var k=Object.keys(_);for(h=0;h<k.length;h++)k[h].indexOf("_on")===0&&Array.isArray(_[k[h]])&&(_[k[h]]=[])}return _},once:function(n,u,d){var _=this;return _.on(n,u,d,1),_},_emit:function(n,u,d){for(var _=this,g=_["_on"+n],h=g.length-1;h>=0;h--)(!g[h].id||g[h].id===u||n==="load")&&(setTimeout(function(v){v.call(this,u,d)}.bind(_,g[h].fn),0),g[h].once&&_.off(n,g[h].fn,g[h].id));return _._loadQueue(n),_},_loadQueue:function(n){var u=this;if(u._queue.length>0){var d=u._queue[0];d.event===n&&(u._queue.shift(),u._loadQueue()),n||d.action()}return u},_ended:function(n){var u=this,d=n._sprite;if(!u._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(u._ended.bind(u,n),100),u;var _=!!(n._loop||u._sprite[d][2]);if(u._emit("end",n._id),!u._webAudio&&_&&u.stop(n._id,!0).play(n._id),u._webAudio&&_){u._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=t.ctx.currentTime;var g=(n._stop-n._start)*1e3/Math.abs(n._rate);u._endTimers[n._id]=setTimeout(u._ended.bind(u,n),g)}return u._webAudio&&!_&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,u._clearTimer(n._id),u._cleanBuffer(n._node),t._autoSuspend()),!u._webAudio&&!_&&u.stop(n._id,!0),u},_clearTimer:function(n){var u=this;if(u._endTimers[n]){if(typeof u._endTimers[n]!="function")clearTimeout(u._endTimers[n]);else{var d=u._soundById(n);d&&d._node&&d._node.removeEventListener("ended",u._endTimers[n],!1)}delete u._endTimers[n]}return u},_soundById:function(n){for(var u=this,d=0;d<u._sounds.length;d++)if(n===u._sounds[d]._id)return u._sounds[d];return null},_inactiveSound:function(){var n=this;n._drain();for(var u=0;u<n._sounds.length;u++)if(n._sounds[u]._ended)return n._sounds[u].reset();return new i(n)},_drain:function(){var n=this,u=n._pool,d=0,_=0;if(!(n._sounds.length<u)){for(_=0;_<n._sounds.length;_++)n._sounds[_]._ended&&d++;for(_=n._sounds.length-1;_>=0;_--){if(d<=u)return;n._sounds[_]._ended&&(n._webAudio&&n._sounds[_]._node&&n._sounds[_]._node.disconnect(0),n._sounds.splice(_,1),d--)}}},_getSoundIds:function(n){var u=this;if(typeof n=="undefined"){for(var d=[],_=0;_<u._sounds.length;_++)d.push(u._sounds[_]._id);return d}else return[n]},_refreshBuffer:function(n){var u=this;return n._node.bufferSource=t.ctx.createBufferSource(),n._node.bufferSource.buffer=l[u._src],n._panner?n._node.bufferSource.connect(n._panner):n._node.bufferSource.connect(n._node),n._node.bufferSource.loop=n._loop,n._loop&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop||0),n._node.bufferSource.playbackRate.setValueAtTime(n._rate,t.ctx.currentTime),u},_cleanBuffer:function(n){var u=this,d=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(t._scratchBuffer&&n.bufferSource&&(n.bufferSource.onended=null,n.bufferSource.disconnect(0),d))try{n.bufferSource.buffer=t._scratchBuffer}catch{}return n.bufferSource=null,u},_clearSound:function(n){var u=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);u||(n.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(n){this._parent=n,this.init()};i.prototype={init:function(){var n=this,u=n._parent;return n._muted=u._muted,n._loop=u._loop,n._volume=u._volume,n._rate=u._rate,n._seek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++t._counter,u._sounds.push(n),n.create(),n},create:function(){var n=this,u=n._parent,d=t._muted||n._muted||n._parent._muted?0:n._volume;return u._webAudio?(n._node=typeof t.ctx.createGain=="undefined"?t.ctx.createGainNode():t.ctx.createGain(),n._node.gain.setValueAtTime(d,t.ctx.currentTime),n._node.paused=!0,n._node.connect(t.masterGain)):t.noAudio||(n._node=t._obtainHtml5Audio(),n._errorFn=n._errorListener.bind(n),n._node.addEventListener("error",n._errorFn,!1),n._loadFn=n._loadListener.bind(n),n._node.addEventListener(t._canPlayEvent,n._loadFn,!1),n._endFn=n._endListener.bind(n),n._node.addEventListener("ended",n._endFn,!1),n._node.src=u._src,n._node.preload=u._preload===!0?"auto":u._preload,n._node.volume=d*t.volume(),n._node.load()),n},reset:function(){var n=this,u=n._parent;return n._muted=u._muted,n._loop=u._loop,n._volume=u._volume,n._rate=u._rate,n._seek=0,n._rateSeek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++t._counter,n},_errorListener:function(){var n=this;n._parent._emit("loaderror",n._id,n._node.error?n._node.error.code:0),n._node.removeEventListener("error",n._errorFn,!1)},_loadListener:function(){var n=this,u=n._parent;u._duration=Math.ceil(n._node.duration*10)/10,Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue()),n._node.removeEventListener(t._canPlayEvent,n._loadFn,!1)},_endListener:function(){var n=this,u=n._parent;u._duration===1/0&&(u._duration=Math.ceil(n._node.duration*10)/10,u._sprite.__default[1]===1/0&&(u._sprite.__default[1]=u._duration*1e3),u._ended(n)),n._node.removeEventListener("ended",n._endFn,!1)}};var l={},s=function(n){var u=n._src;if(l[u]){n._duration=l[u].duration,c(n);return}if(/^data:[^;]+;base64,/.test(u)){for(var d=atob(u.split(",")[1]),_=new Uint8Array(d.length),g=0;g<d.length;++g)_[g]=d.charCodeAt(g);f(_.buffer,n)}else{var h=new XMLHttpRequest;h.open(n._xhr.method,u,!0),h.withCredentials=n._xhr.withCredentials,h.responseType="arraybuffer",n._xhr.headers&&Object.keys(n._xhr.headers).forEach(function(v){h.setRequestHeader(v,n._xhr.headers[v])}),h.onload=function(){var v=(h.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){n._emit("loaderror",null,"Failed loading audio file with status: "+h.status+".");return}f(h.response,n)},h.onerror=function(){n._webAudio&&(n._html5=!0,n._webAudio=!1,n._sounds=[],delete l[u],n.load())},a(h)}},a=function(n){try{n.send()}catch{n.onerror()}},f=function(n,u){var d=function(){u._emit("loaderror",null,"Decoding audio data failed.")},_=function(g){g&&u._sounds.length>0?(l[u._src]=g,c(u,g)):d()};typeof Promise!="undefined"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(n).then(_).catch(d):t.ctx.decodeAudioData(n,_,d)},c=function(n,u){u&&!n._duration&&(n._duration=u.duration),Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue())},p=function(){if(!!t.usingWebAudio){try{typeof AudioContext!="undefined"?t.ctx=new AudioContext:typeof webkitAudioContext!="undefined"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var n=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),u=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=u?parseInt(u[1],10):null;if(n&&d&&d<9){var _=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!_&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain=="undefined"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};o.Howler=t,o.Howl=r,typeof De!="undefined"?(De.HowlerGlobal=e,De.Howler=t,De.Howl=r,De.Sound=i):typeof window!="undefined"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=r,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var i=r._howls.length-1;i>=0;i--)r._howls[i].stereo(t);return r},HowlerGlobal.prototype.pos=function(t,r,i){var l=this;if(!l.ctx||!l.ctx.listener)return l;if(r=typeof r!="number"?l._pos[1]:r,i=typeof i!="number"?l._pos[2]:i,typeof t=="number")l._pos=[t,r,i],typeof l.ctx.listener.positionX!="undefined"?(l.ctx.listener.positionX.setTargetAtTime(l._pos[0],Howler.ctx.currentTime,.1),l.ctx.listener.positionY.setTargetAtTime(l._pos[1],Howler.ctx.currentTime,.1),l.ctx.listener.positionZ.setTargetAtTime(l._pos[2],Howler.ctx.currentTime,.1)):l.ctx.listener.setPosition(l._pos[0],l._pos[1],l._pos[2]);else return l._pos;return l},HowlerGlobal.prototype.orientation=function(t,r,i,l,s,a){var f=this;if(!f.ctx||!f.ctx.listener)return f;var c=f._orientation;if(r=typeof r!="number"?c[1]:r,i=typeof i!="number"?c[2]:i,l=typeof l!="number"?c[3]:l,s=typeof s!="number"?c[4]:s,a=typeof a!="number"?c[5]:a,typeof t=="number")f._orientation=[t,r,i,l,s,a],typeof f.ctx.listener.forwardX!="undefined"?(f.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),f.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),f.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),f.ctx.listener.upX.setTargetAtTime(l,Howler.ctx.currentTime,.1),f.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),f.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):f.ctx.listener.setOrientation(t,r,i,l,s,a);else return c;return f},Howl.prototype.init=function(t){return function(r){var i=this;return i._orientation=r.orientation||[1,0,0],i._stereo=r.stereo||null,i._pos=r.pos||null,i._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle!="undefined"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle!="undefined"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain!="undefined"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel!="undefined"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance!="undefined"?r.maxDistance:1e4,panningModel:typeof r.panningModel!="undefined"?r.panningModel:"HRTF",refDistance:typeof r.refDistance!="undefined"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor!="undefined"?r.rolloffFactor:1},i._onstereo=r.onstereo?[{fn:r.onstereo}]:[],i._onpos=r.onpos?[{fn:r.onpos}]:[],i._onorientation=r.onorientation?[{fn:r.onorientation}]:[],t.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,r){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(t,r)}}),i;var l=typeof Howler.ctx.createStereoPanner=="undefined"?"spatial":"stereo";if(typeof r=="undefined")if(typeof t=="number")i._stereo=t,i._pos=[t,0,0];else return i._stereo;for(var s=i._getSoundIds(r),a=0;a<s.length;a++){var f=i._soundById(s[a]);if(f)if(typeof t=="number")f._stereo=t,f._pos=[t,0,0],f._node&&(f._pannerAttr.panningModel="equalpower",(!f._panner||!f._panner.pan)&&e(f,l),l==="spatial"?typeof f._panner.positionX!="undefined"?(f._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):f._panner.setPosition(t,0,0):f._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",f._id);else return f._stereo}return i},Howl.prototype.pos=function(t,r,i,l){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(t,r,i,l)}}),s;if(r=typeof r!="number"?0:r,i=typeof i!="number"?-.5:i,typeof l=="undefined")if(typeof t=="number")s._pos=[t,r,i];else return s._pos;for(var a=s._getSoundIds(l),f=0;f<a.length;f++){var c=s._soundById(a[f]);if(c)if(typeof t=="number")c._pos=[t,r,i],c._node&&((!c._panner||c._panner.pan)&&e(c,"spatial"),typeof c._panner.positionX!="undefined"?(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):c._panner.setPosition(t,r,i)),s._emit("pos",c._id);else return c._pos}return s},Howl.prototype.orientation=function(t,r,i,l){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(t,r,i,l)}}),s;if(r=typeof r!="number"?s._orientation[1]:r,i=typeof i!="number"?s._orientation[2]:i,typeof l=="undefined")if(typeof t=="number")s._orientation=[t,r,i];else return s._orientation;for(var a=s._getSoundIds(l),f=0;f<a.length;f++){var c=s._soundById(a[f]);if(c)if(typeof t=="number")c._orientation=[t,r,i],c._node&&(c._panner||(c._pos||(c._pos=s._pos||[0,0,-.5]),e(c,"spatial")),typeof c._panner.orientationX!="undefined"?(c._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):c._panner.setOrientation(t,r,i)),s._emit("orientation",c._id);else return c._orientation}return s},Howl.prototype.pannerAttr=function(){var t=this,r=arguments,i,l,s;if(!t._webAudio)return t;if(r.length===0)return t._pannerAttr;if(r.length===1)if(typeof r[0]=="object")i=r[0],typeof l=="undefined"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),t._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle!="undefined"?i.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle!="undefined"?i.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain!="undefined"?i.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel!="undefined"?i.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance!="undefined"?i.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof i.pannerAttr.refDistance!="undefined"?i.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor!="undefined"?i.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel!="undefined"?i.pannerAttr.panningModel:t._panningModel});else return s=t._soundById(parseInt(r[0],10)),s?s._pannerAttr:t._pannerAttr;else r.length===2&&(i=r[0],l=parseInt(r[1],10));for(var a=t._getSoundIds(l),f=0;f<a.length;f++)if(s=t._soundById(a[f]),s){var c=s._pannerAttr;c={coneInnerAngle:typeof i.coneInnerAngle!="undefined"?i.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle!="undefined"?i.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain!="undefined"?i.coneOuterGain:c.coneOuterGain,distanceModel:typeof i.distanceModel!="undefined"?i.distanceModel:c.distanceModel,maxDistance:typeof i.maxDistance!="undefined"?i.maxDistance:c.maxDistance,refDistance:typeof i.refDistance!="undefined"?i.refDistance:c.refDistance,rolloffFactor:typeof i.rolloffFactor!="undefined"?i.rolloffFactor:c.rolloffFactor,panningModel:typeof i.panningModel!="undefined"?i.panningModel:c.panningModel};var p=s._panner;p?(p.coneInnerAngle=c.coneInnerAngle,p.coneOuterAngle=c.coneOuterAngle,p.coneOuterGain=c.coneOuterGain,p.distanceModel=c.distanceModel,p.maxDistance=c.maxDistance,p.refDistance=c.refDistance,p.rolloffFactor=c.rolloffFactor,p.panningModel=c.panningModel):(s._pos||(s._pos=t._pos||[0,0,-.5]),e(s,"spatial"))}return t},Sound.prototype.init=function(t){return function(){var r=this,i=r._parent;r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,t.call(this),r._stereo?i.stereo(r._stereo):r._pos&&i.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var r=this,i=r._parent;return r._orientation=i._orientation,r._stereo=i._stereo,r._pos=i._pos,r._pannerAttr=i._pannerAttr,r._stereo?i.stereo(r._stereo):r._pos?i.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,i._refreshBuffer(r)),t.call(this)}}(Sound.prototype.reset);var e=function(t,r){r=r||"spatial",r==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX!="undefined"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX!="undefined"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(dr);function gl(o,e,t){let{soundFile:r=!1}=e,i=!1,l={};const s=()=>{l&&l.playing&&(l.stop(),l.unload(),l={})};return rr(async()=>{s()}),o.$$set=a=>{"soundFile"in a&&t(0,r=a.soundFile)},o.$$.update=()=>{o.$$.dirty&3&&r&&(t(1,i="https://cdn.sanity.io/files/58ueii0w/production/"+fe(r,"asset._ref","").replace("file-","").replace("-mp3",".mp3")),s(),l=new dr.Howl({src:[i],loop:!0,autoplay:!0}))},[r,i]}class yl extends te{constructor(e){super(),re(this,e,gl,null,ne,{soundFile:0})}}function Et(o){let e,t;return{c(){e=I("img"),this.h()},l(r){e=E(r,"IMG",{src:!0}),this.h()},h(){Q(e.src,t=Ae(o[0].iconImage).quality(100).height(100).url())||m(e,"src",t)},m(r,i){S(r,e,i)},p(r,i){i&1&&!Q(e.src,t=Ae(r[0].iconImage).quality(100).height(100).url())&&m(e,"src",t)},d(r){r&&b(e)}}}function wl(o){let e,t,r,i,l,s,a,f,c=o[0].iconImage&&Et(o);return{c(){e=I("div"),c&&c.c(),this.h()},l(p){e=E(p,"DIV",{class:!0,id:!0,alt:!0,style:!0,tabindex:!0,"aria-label":!0});var n=x(e);c&&c.l(n),n.forEach(b),this.h()},h(){m(e,"class","portal svelte-1ulo7kp"),m(e,"id",t=o[0]._id),m(e,"alt",r=o[0].title),m(e,"style",o[2]),m(e,"tabindex","0"),m(e,"aria-label",i="Go to "+o[0].title)},m(p,n){S(p,e,n),c&&c.m(e,null),o[6](e),s=!0,a||(f=F(e,"keydown",o[7]),a=!0)},p(p,[n]){p[0].iconImage?c?c.p(p,n):(c=Et(p),c.c(),c.m(e,null)):c&&(c.d(1),c=null),(!s||n&1&&t!==(t=p[0]._id))&&m(e,"id",t),(!s||n&1&&r!==(r=p[0].title))&&m(e,"alt",r),(!s||n&1&&i!==(i="Go to "+p[0].title))&&m(e,"aria-label",i)},i(p){s||(_e(()=>{l||(l=ue(e,se,{},!0)),l.run(1)}),s=!0)},o(p){l||(l=ue(e,se,{},!1)),l.run(0),s=!1},d(p){p&&b(e),c&&c.d(),o[6](null),p&&l&&l.end(),a=!1,f()}}}function kl(o,e,t){let r;N(o,Pe,d=>t(5,r=d));let{portal:i={}}=e,l={},s={},a=i.y*ce,f=i.x*ce;const c=`transform: translateY(${a}px) translateX(${f}px); width: ${ce}px; height: ${ce}px; background-color: ${fe(i,"backgroundColor.hex","")}; background-image: url("${fe(i,"bgImageUrl","")}");"`;ke(async()=>{const d=Je;d.content="door to "+fe(i,"targetArea.title",""),d.appendTo=l.parentElement,t(4,s=tippy(l,d))});const p=me();function n(d){ze[d?"unshift":"push"](()=>{l=d,t(1,l)})}const u=d=>{console.log("e: ",d),d.key==="Enter"&&p("room",{roomId:i.targetArea._id})};return o.$$set=d=>{"portal"in d&&t(0,i=d.portal)},o.$$.update=()=>{o.$$.dirty&48&&s.popper&&(r?s.show():s.hide()),o.$$.dirty&1&&console.log("portal: ",i)},[i,l,c,p,s,r,n,u]}class Al extends te{constructor(e){super(),re(this,e,kl,wl,ne,{portal:0})}}function xt(o,e,t){const r=o.slice();return r[4]=e[t],r}function $t(o){let e=[],t=new Map,r,i,l=o[0];const s=a=>a[4]._id;for(let a=0;a<l.length;a+=1){let f=xt(o,l,a),c=s(f);t.set(c,e[a]=St(c,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=B()},l(a){for(let f=0;f<e.length;f+=1)e[f].l(a);r=B()},m(a,f){for(let c=0;c<e.length;c+=1)e[c].m(a,f);S(a,r,f),i=!0},p(a,f){f&5&&(l=a[0],U(),e=Ge(e,f,s,1,a,l,t,r.parentNode,Ne,St,r,xt),C())},i(a){if(!i){for(let f=0;f<l.length;f+=1)T(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)D(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&b(r)}}}function St(o,e){let t,r,i;return r=new Al({props:{portal:e[4]}}),r.$on("room",e[3]),{key:o,first:null,c(){t=B(),Y(r.$$.fragment),this.h()},l(l){t=B(),W(r.$$.fragment,l),this.h()},h(){this.first=t},m(l,s){S(l,t,s),Z(r,l,s),i=!0},p(l,s){e=l;const a={};s&1&&(a.portal=e[4]),r.$set(a)},i(l){i||(T(r.$$.fragment,l),i=!0)},o(l){D(r.$$.fragment,l),i=!1},d(l){l&&b(t),K(r,l)}}}function Tl(o){let e,t,r=!o[1]&&$t(o);return{c(){r&&r.c(),e=B()},l(i){r&&r.l(i),e=B()},m(i,l){r&&r.m(i,l),S(i,e,l),t=!0},p(i,[l]){i[1]?r&&(U(),D(r,1,1,()=>{r=null}),C()):r?(r.p(i,l),l&2&&T(r,1)):(r=$t(i),r.c(),T(r,1),r.m(e.parentNode,e))},i(i){t||(T(r),t=!0)},o(i){D(r),t=!1},d(i){r&&r.d(i),i&&b(e)}}}function Il(o,e,t){let r;N(o,je,a=>t(1,r=a));const i=me();let{portals:l={}}=e;const s=a=>{a.detail.roomId&&i("room",{roomId:a.detail.roomId})};return o.$$set=a=>{"portals"in a&&t(0,l=a.portals)},[l,r,i,s]}class El extends te{constructor(e){super(),re(this,e,Il,Tl,ne,{portals:0})}}function xl(o){let e,t;return{c(){e=Be("svg"),t=Be("path"),this.h()},l(r){e=Fe(r,"svg",{version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var i=x(e);t=Fe(i,"path",{d:!0,class:!0}),x(t).forEach(b),i.forEach(b),this.h()},h(){m(t,"d","M17.7,70.4h17.4V12.5H17.7V70.4z M46.6,12.5v57.8H64V12.5H46.6z"),m(t,"class","svelte-192w1ja"),m(e,"version","1.1"),m(e,"id","Layer_1"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),m(e,"x","0px"),m(e,"y","0px"),m(e,"viewBox","0 0 81.7 82.9"),yr(e,"enable-background","new 0 0 81.7 82.9"),m(e,"xml:space","preserve"),m(e,"class","svelte-192w1ja")},m(r,i){S(r,e,i),A(e,t)},p:le,i:le,o:le,d(r){r&&b(e)}}}class $l extends te{constructor(e){super(),re(this,e,null,xl,ne,{})}}function Sl(o){let e,t,r,i,l,s,a=o[1]&&jt(o);return{c(){e=I("div"),t=I("iframe"),i=q(),a&&a.c(),l=B(),this.h()},l(f){e=E(f,"DIV",{class:!0});var c=x(e);t=E(c,"IFRAME",{class:!0,width:!0,height:!0,src:!0,frameborder:!0,color:!0,allow:!0,sandbox:!0}),x(t).forEach(b),c.forEach(b),i=L(f),a&&a.l(f),l=B(),this.h()},h(){m(t,"class","peertube svelte-11tufvb"),m(t,"width","720"),m(t,"height","480"),Q(t.src,r=o[0]+"?api=1")||m(t,"src",r),m(t,"frameborder","no"),m(t,"color","#ffffff"),m(t,"allow","autoplay; fullscreen"),m(t,"sandbox","allow-same-origin allow-scripts allow-popups"),t.allowFullscreen=!0,m(e,"class","peertube-container svelte-11tufvb"),ee(e,"hidden",o[1])},m(f,c){S(f,e,c),A(e,t),S(f,i,c),a&&a.m(f,c),S(f,l,c),s=!0},p(f,c){(!s||c&1&&!Q(t.src,r=f[0]+"?api=1"))&&m(t,"src",r),c&2&&ee(e,"hidden",f[1]),f[1]?a?(a.p(f,c),c&2&&T(a,1)):(a=jt(f),a.c(),T(a,1),a.m(l.parentNode,l)):a&&(U(),D(a,1,1,()=>{a=null}),C())},i(f){s||(T(a),s=!0)},o(f){D(a),s=!1},d(f){f&&b(e),f&&b(i),a&&a.d(f),f&&b(l)}}}function jl(o){let e,t,r;return{c(){e=I("div"),t=I("iframe"),this.h()},l(i){e=E(i,"DIV",{class:!0});var l=x(e);t=E(l,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,scrolling:!0,byline:!0,color:!0,allow:!0,class:!0}),x(t).forEach(b),l.forEach(b),this.h()},h(){m(t,"width","720"),m(t,"height","480"),Q(t.src,r="https://player.vimeo.com/video/"+Te(o[0]).id+"?autoplay=1")||m(t,"src",r),m(t,"frameborder","no"),m(t,"scrolling","no"),m(t,"byline","false"),m(t,"color","#ffffff"),m(t,"allow","autoplay; fullscreen"),t.allowFullscreen=!0,m(t,"class","svelte-11tufvb"),m(e,"class","vimeo-container svelte-11tufvb")},m(i,l){S(i,e,l),A(e,t)},p(i,l){l&1&&!Q(t.src,r="https://player.vimeo.com/video/"+Te(i[0]).id+"?autoplay=1")&&m(t,"src",r)},i:le,o:le,d(i){i&&b(e)}}}function Dl(o){let e,t,r;return{c(){e=I("div"),t=I("iframe"),this.h()},l(i){e=E(i,"DIV",{class:!0});var l=x(e);t=E(l,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,allow:!0,class:!0}),x(t).forEach(b),l.forEach(b),this.h()},h(){m(t,"width","1920"),m(t,"height","1280"),Q(t.src,r="https://www.youtube.com/embed/"+Te(o[0]).id+"?autoplay=1&rel=0&color=white")||m(t,"src",r),m(t,"frameborder","no"),m(t,"allow","autoplay; fullscreen"),t.allowFullscreen=!0,m(t,"class","svelte-11tufvb"),m(e,"class","youtube-container svelte-11tufvb")},m(i,l){S(i,e,l),A(e,t)},p(i,l){l&1&&!Q(t.src,r="https://www.youtube.com/embed/"+Te(i[0]).id+"?autoplay=1&rel=0&color=white")&&m(t,"src",r)},i:le,o:le,d(i){i&&b(e)}}}function jt(o){let e,t,r,i,l,s,a,f,c,p,n,u,d,_,g;const h=[Vl,Ol],v=[];function k(y,$){return y[3]?0:1}return a=k(o),f=v[a]=h[a](o),{c(){e=I("div"),t=I("div"),r=R(o[2]),i=q(),l=I("div"),s=I("div"),f.c(),c=q(),p=I("div"),n=I("div"),this.h()},l(y){e=E(y,"DIV",{class:!0});var $=x(e);t=E($,"DIV",{class:!0});var j=x(t);r=H(j,o[2]),j.forEach(b),i=L($),l=E($,"DIV",{class:!0});var O=x(l);s=E(O,"DIV",{class:!0});var P=x(s);f.l(P),P.forEach(b),c=L(O),p=E(O,"DIV",{class:!0});var M=x(p);n=E(M,"DIV",{class:!0,style:!0}),x(n).forEach(b),M.forEach(b),O.forEach(b),$.forEach(b),this.h()},h(){m(t,"class","title svelte-11tufvb"),m(s,"class","control svelte-11tufvb"),m(n,"class","progress svelte-11tufvb"),m(n,"style",u="width: "+o[4]+"%;"),m(p,"class","playbar svelte-11tufvb"),m(l,"class","controls svelte-11tufvb"),m(e,"class","audio-interface svelte-11tufvb")},m(y,$){S(y,e,$),A(e,t),A(t,r),A(e,i),A(e,l),A(l,s),v[a].m(s,null),A(l,c),A(l,p),A(p,n),d=!0,_||(g=F(s,"click",o[5]),_=!0)},p(y,$){(!d||$&4)&&we(r,y[2]);let j=a;a=k(y),a!==j&&(U(),D(v[j],1,1,()=>{v[j]=null}),C(),f=v[a],f||(f=v[a]=h[a](y),f.c()),T(f,1),f.m(s,null)),(!d||$&16&&u!==(u="width: "+y[4]+"%;"))&&m(n,"style",u)},i(y){d||(T(f),d=!0)},o(y){D(f),d=!1},d(y){y&&b(e),v[a].d(),_=!1,g()}}}function Ol(o){let e,t;return e=new Dr({}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Vl(o){let e,t;return e=new $l({}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Pl(o){let e,t,r,i,l,s,a,f,c;const p=[Dl,jl,Sl],n=[];function u(d,_){return _&1&&(r=null),_&1&&(i=null),_&1&&(l=null),r==null&&(r=!!(d[0].includes("youtube")||d[0].includes("youtu.be"))),r?0:(i==null&&(i=!!d[0].includes("vimeo")),i?1:(l==null&&(l=!!d[0].includes("undersco.re")),l?2:-1))}return~(s=u(o,-1))&&(a=n[s]=p[s](o)),{c(){e=I("div"),t=I("div"),a&&a.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var _=x(e);t=E(_,"DIV",{class:!0});var g=x(t);a&&a.l(g),g.forEach(b),_.forEach(b),this.h()},h(){m(t,"class","embed svelte-11tufvb"),m(e,"class","stream-container svelte-11tufvb"),ee(e,"audio",o[1])},m(d,_){S(d,e,_),A(e,t),~s&&n[s].m(t,null),c=!0},p(d,[_]){o=d;let g=s;s=u(o,_),s===g?~s&&n[s].p(o,_):(a&&(U(),D(n[g],1,1,()=>{n[g]=null}),C()),~s?(a=n[s],a?a.p(o,_):(a=n[s]=p[s](o),a.c()),T(a,1),a.m(t,null)):a=null),_&2&&ee(e,"audio",o[1])},i(d){c||(T(a),_e(()=>{f||(f=ue(e,se,{duration:300,easing:We},!0)),f.run(1)}),c=!0)},o(d){D(a),f||(f=ue(e,se,{duration:300,easing:We},!1)),f.run(0),c=!1},d(d){d&&b(e),~s&&n[s].d(),d&&f&&f.end()}}}function zl(o,e,t){const r=window.PeerTubePlayer;let{streamUrl:i=""}=e,{audioOnly:l=!0}=e,{title:s=""}=e,a,f=!1,c=0;const p=()=>{f?a.pause():a.play(),t(3,f=!f)};return ke(async()=>{i.includes("undersco.re")&&(a=new r(document.querySelector(".peertube")),await a.ready,a.play(),t(3,f=!0),a.addEventListener("playbackStatusUpdate",n=>{t(4,c=(n.position/n.duration).toFixed(4)*100)}))}),o.$$set=n=>{"streamUrl"in n&&t(0,i=n.streamUrl),"audioOnly"in n&&t(1,l=n.audioOnly),"title"in n&&t(2,s=n.title)},[i,l,s,f,c,p]}class Ml extends te{constructor(e){super(),re(this,e,zl,Pl,ne,{streamUrl:0,audioOnly:1,title:2})}}function ql(o){let e,t,r;return{c(){e=I("div"),t=I("iframe"),this.h()},l(i){e=E(i,"DIV",{class:!0});var l=x(e);t=E(l,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,color:!0,allow:!0,sandbox:!0,class:!0}),x(t).forEach(b),l.forEach(b),this.h()},h(){m(t,"width","720"),m(t,"height","480"),Q(t.src,r=o[0])||m(t,"src",r),m(t,"frameborder","no"),m(t,"color","#ffffff"),m(t,"allow","autoplay; fullscreen"),m(t,"sandbox","allow-same-origin allow-scripts allow-popups"),t.allowFullscreen=!0,m(t,"class","svelte-rt5t1v"),m(e,"class","peertube-container svelte-rt5t1v")},m(i,l){S(i,e,l),A(e,t)},p(i,l){l&1&&!Q(t.src,r=i[0])&&m(t,"src",r)},d(i){i&&b(e)}}}function Ll(o){let e,t,r;return{c(){e=I("div"),t=I("iframe"),this.h()},l(i){e=E(i,"DIV",{class:!0});var l=x(e);t=E(l,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,scrolling:!0,byline:!0,color:!0,allow:!0,class:!0}),x(t).forEach(b),l.forEach(b),this.h()},h(){m(t,"width","720"),m(t,"height","480"),Q(t.src,r="https://player.vimeo.com/video/"+Te(o[0]).id)||m(t,"src",r),m(t,"frameborder","no"),m(t,"scrolling","no"),m(t,"byline","false"),m(t,"color","#ffffff"),m(t,"allow","autoplay; fullscreen"),t.allowFullscreen=!0,m(t,"class","svelte-rt5t1v"),m(e,"class","vimeo-container svelte-rt5t1v")},m(i,l){S(i,e,l),A(e,t)},p(i,l){l&1&&!Q(t.src,r="https://player.vimeo.com/video/"+Te(i[0]).id)&&m(t,"src",r)},d(i){i&&b(e)}}}function Bl(o){let e,t,r;return{c(){e=I("div"),t=I("iframe"),this.h()},l(i){e=E(i,"DIV",{class:!0});var l=x(e);t=E(l,"IFRAME",{width:!0,height:!0,src:!0,frameborder:!0,allow:!0,class:!0}),x(t).forEach(b),l.forEach(b),this.h()},h(){m(t,"width","1920"),m(t,"height","1280"),Q(t.src,r="https://www.youtube.com/embed/"+Te(o[0]).id+"?rel=0&color=white")||m(t,"src",r),m(t,"frameborder","no"),m(t,"allow","autoplay; fullscreen"),t.allowFullscreen=!0,m(t,"class","svelte-rt5t1v"),m(e,"class","youtube-container svelte-rt5t1v")},m(i,l){S(i,e,l),A(e,t)},p(i,l){l&1&&!Q(t.src,r="https://www.youtube.com/embed/"+Te(i[0]).id+"?rel=0&color=white")&&m(t,"src",r)},d(i){i&&b(e)}}}function Fl(o){let e,t,r,i,l,s;function a(p,n){if(n&1&&(r=null),n&1&&(i=null),n&1&&(l=null),r==null&&(r=!!(p[0].includes("youtube")||p[0].includes("youtu.be"))),r)return Bl;if(i==null&&(i=!!p[0].includes("vimeo")),i)return Ll;if(l==null&&(l=!!p[0].includes("undersco.re")),l)return ql}let f=a(o,-1),c=f&&f(o);return{c(){e=I("div"),t=I("div"),c&&c.c(),this.h()},l(p){e=E(p,"DIV",{class:!0});var n=x(e);t=E(n,"DIV",{class:!0});var u=x(t);c&&c.l(u),u.forEach(b),n.forEach(b),this.h()},h(){m(t,"class","embed svelte-rt5t1v"),m(e,"class","stream-container svelte-rt5t1v")},m(p,n){S(p,e,n),A(e,t),c&&c.m(t,null)},p(p,[n]){o=p,f===(f=a(o,n))&&c?c.p(o,n):(c&&c.d(1),c=f&&f(o),c&&(c.c(),c.m(t,null)))},i(p){s||_e(()=>{s=Ue(e,se,{duration:300,easing:We}),s.start()})},o:le,d(p){p&&b(e),c&&c.d()}}}function Rl(o,e,t){let{streamUrl:r=""}=e;return o.$$set=i=>{"streamUrl"in i&&t(0,r=i.streamUrl)},[r]}class Hl extends te{constructor(e){super(),re(this,e,Rl,Fl,ne,{streamUrl:0})}}function Gl(o,e,t){var r={},i="",l="...",s=10>e?e:10,a=["img","br"],f=[],c=0,p=i,n='([\\w|-]+\\s*(=\\s*"[^"]*")?\\s*)*',u="\\s*\\/?\\s*",d="\\s*\\/\\s*",_=new RegExp("<\\/?\\w+\\s*"+n+d+">"),g=new RegExp("<\\/?\\w+\\s*"+n+u+">"),h=/(((ftp|https?):\/\/)[\-\w@:%_\+.~#?,&\/\/=]+)|((mailto:)?[_.\w\-]+@([\w][\w\-]+\.)+[a-zA-Z]{2,3})/g,v=new RegExp("<img\\s*"+n+u+">"),k=new RegExp("\\W+","g"),y=!0,$,j,O,P;function M(oe){var ae=v.exec(oe),X,de;return ae?(X=ae.index,de=ae[0].length,oe.substring(0,X)+oe.substring(X+de)):oe}function w(oe){var ae="";return oe.reverse().forEach(function(X,de){a.indexOf(X)===-1&&(ae+="</"+X+">")}),ae}function z(oe){var ae=oe.indexOf(" ");if(ae===-1&&(ae=oe.indexOf(">"),ae===-1))throw new Error("HTML tag is not well-formed : "+oe);return oe.substring(1,ae)}function G(oe,ae){var X=e-c,de=X,Me=X<t.slop,xe=Me?X:t.slop-1,$e,V=Me?0:X-t.slop,pe=ae||X+t.slop,J;if(!t.truncateLastWord){if($e=oe.slice(V,pe),ae&&$e.length<=ae)de=$e.length;else for(;(J=k.exec($e))!==null;)if(J.index<xe){if(de=X-(xe-J.index),J.index===0&&X<=1)break}else if(J.index===xe){de=X;break}else{de=X+(J.index-xe);break}oe.charAt(de-1).match(/\s$/)&&de--}return de}for(t=t||r,t.ellipsis=t.ellipsis!==void 0?t.ellipsis:l,t.truncateLastWord=t.truncateLastWord!==void 0?t.truncateLastWord:!0,t.slop=t.slop!==void 0?t.slop:s;y;){if(y=g.exec(o),!y){if(c>=e)break;if(y=h.exec(o),!y||y.index>=e){p+=o.substring(0,G(o));break}for(;y;)$=y[0],j=y.index,p+=o.substring(0,j+$.length-c),o=o.substring(j+$.length),y=h.exec(o);break}if($=y[0],j=y.index,c+j>e){p+=o.substring(0,G(o,j));break}else c+=j,p+=o.substring(0,j);$[1]==="/"?(f.pop(),P=null):(P=_.exec($),P||(O=z($),f.push(O))),P?p+=P[0]:p+=$,o=o.substring(j+$.length)}return o.length>e-c&&t.ellipsis&&(p+=t.ellipsis),p+=w(f),t.keepImageTag||(p=M(p)),p}var Nl=Gl;function Dt(o){let e,t,r,i,l,s,a=tt(o[1].startDate),f,c,p=rt(o[1].startDate)+"",n,u,d,_=o[1].title+"",g,h,v=ve(o[1],"content.content"),k,y=a&&Ot(),$=v&&Vt(o),j=o[0].importEvent&&Pt(o);return{c(){e=I("div"),t=I("img"),l=q(),s=I("div"),y&&y.c(),f=q(),c=I("div"),n=R(p),u=q(),d=I("div"),g=R(_),h=q(),$&&$.c(),k=q(),j&&j.c(),this.h()},l(O){e=E(O,"DIV",{class:!0});var P=x(e);t=E(P,"IMG",{class:!0,alt:!0,src:!0}),P.forEach(b),l=L(O),s=E(O,"DIV",{class:!0});var M=x(s);y&&y.l(M),f=L(M),c=E(M,"DIV",{class:!0});var w=x(c);n=H(w,p),w.forEach(b),u=L(M),d=E(M,"DIV",{class:!0});var z=x(d);g=H(z,_),z.forEach(b),h=L(M),$&&$.l(M),k=L(M),j&&j.l(M),M.forEach(b),this.h()},h(){m(t,"class","image svelte-1xm1bfg"),m(t,"alt",r=o[1].title),Q(t.src,i=o[0].importEvent?et(o[1].mainImage).quality(90).width(500).height(500).url():Ae(o[1].mainImage).quality(90).width(500).height(500).url())||m(t,"src",i),m(e,"class","image-container svelte-1xm1bfg"),m(c,"class","date svelte-1xm1bfg"),m(d,"class","title svelte-1xm1bfg"),m(s,"class","text-container svelte-1xm1bfg")},m(O,P){S(O,e,P),A(e,t),S(O,l,P),S(O,s,P),y&&y.m(s,null),A(s,f),A(s,c),A(c,n),A(s,u),A(s,d),A(d,g),A(s,h),$&&$.m(s,null),A(s,k),j&&j.m(s,null)},p(O,P){P&2&&r!==(r=O[1].title)&&m(t,"alt",r),P&3&&!Q(t.src,i=O[0].importEvent?et(O[1].mainImage).quality(90).width(500).height(500).url():Ae(O[1].mainImage).quality(90).width(500).height(500).url())&&m(t,"src",i),P&2&&(a=tt(O[1].startDate)),a?y||(y=Ot(),y.c(),y.m(s,f)):y&&(y.d(1),y=null),P&2&&p!==(p=rt(O[1].startDate)+"")&&we(n,p),P&2&&_!==(_=O[1].title+"")&&we(g,_),P&2&&(v=ve(O[1],"content.content")),v?$?$.p(O,P):($=Vt(O),$.c(),$.m(s,k)):$&&($.d(1),$=null),O[0].importEvent?j?j.p(O,P):(j=Pt(O),j.c(),j.m(s,null)):j&&(j.d(1),j=null)},d(O){O&&b(e),O&&b(l),O&&b(s),y&&y.d(),$&&$.d(),j&&j.d()}}}function Ot(o){let e,t,r;return{c(){e=I("div"),t=I("div"),r=R("Upcoming"),this.h()},l(i){e=E(i,"DIV",{});var l=x(e);t=E(l,"DIV",{class:!0});var s=x(t);r=H(s,"Upcoming"),s.forEach(b),l.forEach(b),this.h()},h(){m(t,"class","upcoming svelte-1xm1bfg")},m(i,l){S(i,e,l),A(e,t),A(t,r)},d(i){i&&b(e)}}}function Vt(o){let e;return{c(){e=I("div"),this.h()},l(t){e=E(t,"DIV",{class:!0});var r=x(e);r.forEach(b),this.h()},h(){m(e,"class","description")},m(t,r){S(t,e,r),e.innerHTML=o[2]},p(t,r){r&4&&(e.innerHTML=t[2])},d(t){t&&b(e)}}}function Pt(o){let e,t,r,i;return{c(){e=I("div"),t=I("a"),r=R("More Information Here"),this.h()},l(l){e=E(l,"DIV",{class:!0});var s=x(e);t=E(s,"A",{href:!0,target:!0});var a=x(t);r=H(a,"More Information Here"),a.forEach(b),s.forEach(b),this.h()},h(){m(t,"href",i="https://eyebeam.netlify.app/events/"+fe(o[1],"slug.current")),m(t,"target","_blank"),m(e,"class","link-to-full")},m(l,s){S(l,e,s),A(e,t),A(t,r)},p(l,s){s&2&&i!==(i="https://eyebeam.netlify.app/events/"+fe(l[1],"slug.current"))&&m(t,"href",i)},d(l){l&&b(e)}}}function Ul(o){let e,t=o[1]&&Dt(o);return{c(){e=I("div"),t&&t.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=x(e);t&&t.l(i),i.forEach(b),this.h()},h(){m(e,"class","event svelte-1xm1bfg")},m(r,i){S(r,e,i),t&&t.m(e,null)},p(r,[i]){r[1]?t?t.p(r,i):(t=Dt(r),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:le,o:le,d(r){r&&b(e),t&&t.d()}}}function Cl(o,e,t){let{event:r={}}=e,i=!1,l="";return ke(async()=>{r.importEvent?(t(1,i=await ar("*[_id == '"+r.importedEvent+"'][0]")),t(2,l=Nl(Or(fe(i,"content.content",[])),800))):(t(1,i=r),t(2,l=Ve(fe(i,"content.content",[]))))}),o.$$set=s=>{"event"in s&&t(0,r=s.event)},[r,i,l]}class Xl extends te{constructor(e){super(),re(this,e,Cl,Ul,ne,{event:0})}}function zt(o,e,t){const r=o.slice();return r[11]=e[t],r}function Mt(o){let e,t;return{c(){e=I("div"),t=R(o[1]),this.h()},l(r){e=E(r,"DIV",{"aria-live":!0,class:!0});var i=x(e);t=H(i,o[1]),i.forEach(b),this.h()},h(){m(e,"aria-live","polite"),m(e,"class","viewer-count svelte-pznsc8")},m(r,i){S(r,e,i),A(e,t)},p(r,i){i&2&&we(t,r[1])},d(r){r&&b(e)}}}function Yl(o){let e,t,r,i,l,s,a,f,c,p,n,u,d=o[0].events,_=[];for(let h=0;h<d.length;h+=1)_[h]=qt(zt(o,d,h));const g=h=>D(_[h],1,1,()=>{_[h]=null});return{c(){e=I("div"),t=I("div"),r=I("h1"),i=R("Welcome to the Bulletin Board"),l=q(),s=I("div"),a=q(),f=I("div");for(let h=0;h<_.length;h+=1)_[h].c();this.h()},l(h){e=E(h,"DIV",{class:!0,"aria-live":!0});var v=x(e);t=E(v,"DIV",{class:!0});var k=x(t);r=E(k,"H1",{});var y=x(r);i=H(y,"Welcome to the Bulletin Board"),y.forEach(b),l=L(k),s=E(k,"DIV",{class:!0});var $=x(s);$.forEach(b),a=L(k),f=E(k,"DIV",{class:!0});var j=x(f);for(let O=0;O<_.length;O+=1)_[O].l(j);j.forEach(b),k.forEach(b),v.forEach(b),this.h()},h(){m(s,"class","bulletin-board-actions svelte-pznsc8"),m(f,"class","bulletin-board-events"),m(t,"class","inner svelte-pznsc8"),m(e,"class","bulletin-board svelte-pznsc8"),m(e,"aria-live","polite"),ee(e,"pushed",o[3])},m(h,v){S(h,e,v),A(e,t),A(t,r),A(r,i),A(t,l),A(t,s),A(t,a),A(t,f);for(let k=0;k<_.length;k+=1)_[k].m(f,null);p=!0,n||(u=F(e,"click",o[10]),n=!0)},p(h,v){if(v&1){d=h[0].events;let k;for(k=0;k<d.length;k+=1){const y=zt(h,d,k);_[k]?(_[k].p(y,v),T(_[k],1)):(_[k]=qt(y),_[k].c(),T(_[k],1),_[k].m(f,null))}for(U(),k=d.length;k<_.length;k+=1)g(k);C()}v&8&&ee(e,"pushed",h[3])},i(h){if(!p){for(let v=0;v<d.length;v+=1)T(_[v]);_e(()=>{c||(c=ue(e,se,{},!0)),c.run(1)}),p=!0}},o(h){_=_.filter(Boolean);for(let v=0;v<_.length;v+=1)D(_[v]);c||(c=ue(e,se,{},!1)),c.run(0),p=!1},d(h){h&&b(e),He(_,h),h&&c&&c.end(),n=!1,u()}}}function Wl(o){let e,t,r,i,l,s,a=o[2]&&o[2].title&&Lt(o);return{c(){e=I("div"),t=I("div"),a&&a.c(),this.h()},l(f){e=E(f,"DIV",{class:!0,"aria-live":!0});var c=x(e);t=E(c,"DIV",{class:!0});var p=x(t);a&&a.l(p),p.forEach(b),c.forEach(b),this.h()},h(){m(t,"class","inner svelte-pznsc8"),m(e,"class","article svelte-pznsc8"),m(e,"aria-live","polite"),ee(e,"pushed",o[3])},m(f,c){S(f,e,c),A(e,t),a&&a.m(t,null),i=!0,l||(s=F(e,"click",o[9]),l=!0)},p(f,c){f[2]&&f[2].title?a?(a.p(f,c),c&4&&T(a,1)):(a=Lt(f),a.c(),T(a,1),a.m(t,null)):a&&(U(),D(a,1,1,()=>{a=null}),C()),c&8&&ee(e,"pushed",f[3])},i(f){i||(T(a),_e(()=>{r||(r=ue(e,se,{},!0)),r.run(1)}),i=!0)},o(f){D(a),r||(r=ue(e,se,{},!1)),r.run(0),i=!1},d(f){f&&b(e),a&&a.d(),f&&r&&r.end(),l=!1,s()}}}function Zl(o){let e=ve(o[0],"content.content"),t,r,i=e&&Ft(o);return{c(){i&&i.c(),t=B()},l(l){i&&i.l(l),t=B()},m(l,s){i&&i.m(l,s),S(l,t,s),r=!0},p(l,s){s&1&&(e=ve(l[0],"content.content")),e?i?(i.p(l,s),s&1&&T(i,1)):(i=Ft(l),i.c(),T(i,1),i.m(t.parentNode,t)):i&&(U(),D(i,1,1,()=>{i=null}),C())},i(l){r||(T(i),r=!0)},o(l){D(i),r=!1},d(l){i&&i.d(l),l&&b(t)}}}function Kl(o){let e,t,r,i,l,s;return t=new Hl({props:{streamUrl:o[0].videoUrl}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0,"aria-live":!0});var f=x(e);W(t.$$.fragment,f),f.forEach(b),this.h()},h(){m(e,"class","video svelte-pznsc8"),m(e,"aria-live","polite"),ee(e,"pushed",o[3])},m(a,f){S(a,e,f),Z(t,e,null),i=!0,l||(s=F(e,"click",o[7]),l=!0)},p(a,f){const c={};f&1&&(c.streamUrl=a[0].videoUrl),t.$set(c),f&8&&ee(e,"pushed",a[3])},i(a){i||(T(t.$$.fragment,a),_e(()=>{r||(r=ue(e,se,{},!0)),r.run(1)}),i=!0)},o(a){D(t.$$.fragment,a),r||(r=ue(e,se,{},!1)),r.run(0),i=!1},d(a){a&&b(e),K(t),a&&r&&r.end(),l=!1,s()}}}function qt(o){let e,t;return e=new Xl({props:{event:o[11]}}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i&1&&(l.event=r[11]),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Lt(o){let e=o[2].title+"",t,r,i=ve(o[2],"content.content"),l,s,a=i&&Bt(o);return{c(){t=R(e),r=q(),a&&a.c(),l=B()},l(f){t=H(f,e),r=L(f),a&&a.l(f),l=B()},m(f,c){S(f,t,c),S(f,r,c),a&&a.m(f,c),S(f,l,c),s=!0},p(f,c){(!s||c&4)&&e!==(e=f[2].title+"")&&we(t,e),c&4&&(i=ve(f[2],"content.content")),i?a?(a.p(f,c),c&4&&T(a,1)):(a=Bt(f),a.c(),T(a,1),a.m(l.parentNode,l)):a&&(U(),D(a,1,1,()=>{a=null}),C())},i(f){s||(T(a),s=!0)},o(f){D(a),s=!1},d(f){f&&b(t),f&&b(r),a&&a.d(f),f&&b(l)}}}function Bt(o){let e,t;return e=new ur({props:{blocks:o[2].content.content,mainSite:!0}}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i&4&&(l.blocks=r[2].content.content),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Ft(o){let e,t,r,i,l,s,a;return r=new ur({props:{blocks:o[0].content.content}}),{c(){e=I("div"),t=I("div"),Y(r.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0,"aria-live":!0});var c=x(e);t=E(c,"DIV",{class:!0});var p=x(t);W(r.$$.fragment,p),p.forEach(b),c.forEach(b),this.h()},h(){m(t,"class","inner svelte-pznsc8"),m(e,"class","article svelte-pznsc8"),m(e,"aria-live","polite"),ee(e,"pushed",o[3])},m(f,c){S(f,e,c),A(e,t),Z(r,t,null),l=!0,s||(a=F(e,"click",o[8]),s=!0)},p(f,c){const p={};c&1&&(p.blocks=f[0].content.content),r.$set(p),c&8&&ee(e,"pushed",f[3])},i(f){l||(T(r.$$.fragment,f),_e(()=>{i||(i=ue(e,se,{},!0)),i.run(1)}),l=!0)},o(f){D(r.$$.fragment,f),i||(i=ue(e,se,{},!1)),i.run(0),l=!1},d(f){f&&b(e),K(r),f&&i&&i.end(),s=!1,a()}}}function Rt(o){let e,t=o[0].infoText+"",r;return{c(){e=I("div"),r=R(t),this.h()},l(i){e=E(i,"DIV",{class:!0});var l=x(e);r=H(l,t),l.forEach(b),this.h()},h(){m(e,"class","info-text svelte-pznsc8")},m(i,l){S(i,e,l),A(e,r)},p(i,l){l&1&&t!==(t=i[0].infoText+"")&&we(r,t)},d(i){i&&b(e)}}}function Ql(o){let e,t,r,i,l,s,a,f,c,p,n,u=o[0].contentType==="video"&&Mt(o);const d=[Kl,Zl,Wl,Yl],_=[];function g(v,k){return v[0].contentType==="video"?0:v[0].contentType==="text"?1:v[0].contentType==="importedPost"?2:v[0].isBulletinBoard?3:-1}~(l=g(o))&&(s=_[l]=d[l](o));let h=o[0].infoText&&Rt(o);return{c(){u&&u.c(),e=q(),t=I("button"),r=R("Return"),i=q(),s&&s.c(),a=q(),h&&h.c(),f=B(),this.h()},l(v){u&&u.l(v),e=L(v),t=E(v,"BUTTON",{class:!0,"aria-label":!0});var k=x(t);r=H(k,"Return"),k.forEach(b),i=L(v),s&&s.l(v),a=L(v),h&&h.l(v),f=B(),this.h()},h(){m(t,"class","return-button svelte-pznsc8"),m(t,"aria-label","Return")},m(v,k){u&&u.m(v,k),S(v,e,k),S(v,t,k),A(t,r),S(v,i,k),~l&&_[l].m(v,k),S(v,a,k),h&&h.m(v,k),S(v,f,k),c=!0,p||(n=F(t,"click",o[6]),p=!0)},p(v,[k]){v[0].contentType==="video"?u?u.p(v,k):(u=Mt(v),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null);let y=l;l=g(v),l===y?~l&&_[l].p(v,k):(s&&(U(),D(_[y],1,1,()=>{_[y]=null}),C()),~l?(s=_[l],s?s.p(v,k):(s=_[l]=d[l](v),s.c()),T(s,1),s.m(a.parentNode,a)):s=null),v[0].infoText?h?h.p(v,k):(h=Rt(v),h.c(),h.m(f.parentNode,f)):h&&(h.d(1),h=null)},i(v){c||(T(s),c=!0)},o(v){D(s),c=!1},d(v){u&&u.d(v),v&&b(e),v&&b(t),v&&b(i),~l&&_[l].d(v),v&&b(a),h&&h.d(v),v&&b(f),p=!1,n()}}}function Jl(o,e,t){let r,i;N(o,sr,_=>t(5,r=_)),N(o,fr,_=>t(3,i=_));let{article:l={}}=e,s=0,a="",f;ke(async()=>{Vr(l),l.contentType==="importedPost"&&l.importedPost&&t(2,f=await ar("*[_id == '"+l.importedPost+"'][0]"))}),rr(async()=>{Pr()});const c=()=>{ye.set(!1)},p=_=>{_.target.classList.contains("video")&&ye.set(!1)},n=_=>{_.target.classList.contains("article")&&ye.set(!1)},u=_=>{_.target.classList.contains("article")&&ye.set(!1)},d=_=>{_.target.classList.contains("bulletin-board")&&ye.set(!1)};return o.$$set=_=>{"article"in _&&t(0,l=_.article)},o.$$.update=()=>{if(o.$$.dirty&49){t(4,s=0);for(const[_,g]of Object.entries(r))g.viewing===l._id&&t(4,s++,s)}o.$$.dirty&16&&t(1,a=s===1?"You are the only one here.":`${s} people are here.`)},[l,a,f,i,s,r,c,p,n,u,d]}class eo extends te{constructor(e){super(),re(this,e,Jl,Ql,ne,{article:0})}}function to(o){let e,t,r,i,l,s,a,f,c,p,n,u,d,_,g,h;return{c(){e=I("div"),t=I("div"),r=R(o[0]),i=q(),l=I("div"),s=I("div"),a=I("div"),f=R("\u25B8"),c=R(`
      Yes`),p=q(),n=I("div"),u=I("div"),d=R("\u25B8"),_=R(`
      No`),this.h()},l(v){e=E(v,"DIV",{class:!0});var k=x(e);t=E(k,"DIV",{});var y=x(t);r=H(y,o[0]),y.forEach(b),i=L(k),l=E(k,"DIV",{class:!0});var $=x(l);s=E($,"DIV",{class:!0,tabindex:!0,autofocus:!0});var j=x(s);a=E(j,"DIV",{class:!0});var O=x(a);f=H(O,"\u25B8"),O.forEach(b),c=H(j,`
      Yes`),j.forEach(b),p=L($),n=E($,"DIV",{class:!0,tabindex:!0});var P=x(n);u=E(P,"DIV",{class:!0});var M=x(u);d=H(M,"\u25B8"),M.forEach(b),_=H(P,`
      No`),P.forEach(b),$.forEach(b),k.forEach(b),this.h()},h(){m(a,"class","marker svelte-p2qmve"),m(s,"class","choice svelte-p2qmve"),m(s,"tabindex","0"),m(s,"autofocus",""),m(u,"class","marker svelte-p2qmve"),m(n,"class","choice svelte-p2qmve"),m(n,"tabindex","0"),m(l,"class","multiple-choice"),m(e,"class","room-dialog-box svelte-p2qmve")},m(v,k){S(v,e,k),A(e,t),A(t,r),A(e,i),A(e,l),A(l,s),A(s,a),A(a,f),A(s,c),A(l,p),A(l,n),A(n,u),A(u,d),A(n,_),s.focus(),g||(h=[F(s,"click",o[3]),F(s,"keydown",o[4]),F(n,"click",o[5]),F(n,"keydown",o[6])],g=!0)},p(v,[k]){k&1&&we(r,v[0])},i:le,o:le,d(v){v&&b(e),g=!1,Ie(h)}}}function ro(o,e,t){const r=me();let{text:i=""}=e,{roomId:l=""}=e;const s=p=>{r("room",{roomId:l})},a=p=>{p.code==="Enter"&&r("room",{roomId:l})},f=p=>{r("room",{roomId:!1})},c=p=>{p.code==="Enter"&&r("room",{roomId:!1})};return o.$$set=p=>{"text"in p&&t(0,i=p.text),"roomId"in p&&t(1,l=p.roomId)},[i,l,r,s,a,f,c]}class no extends te{constructor(e){super(),re(this,e,ro,to,ne,{text:0,roomId:1})}}function io(o){let e,t,r,i;return t=new no({props:{text:`Go to ${o[1]}?`,roomId:o[0]}}),t.$on("room",o[3]),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(l){e=E(l,"DIV",{class:!0});var s=x(e);W(t.$$.fragment,s),s.forEach(b),this.h()},h(){m(e,"class","caption-container svelte-ukizaq")},m(l,s){S(l,e,s),Z(t,e,null),i=!0},p(l,[s]){const a={};s&2&&(a.text=`Go to ${l[1]}?`),s&1&&(a.roomId=l[0]),t.$set(a)},i(l){i||(T(t.$$.fragment,l),r||_e(()=>{r=Ue(e,se,{}),r.start()}),i=!0)},o(l){D(t.$$.fragment,l),i=!1},d(l){l&&b(e),K(t)}}}function lo(o,e,t){const r=me();let{roomIntent:i=""}=e,{roomTitle:l=""}=e;const s=a=>{r("room",{roomId:a.detail.roomId})};return o.$$set=a=>{"roomIntent"in a&&t(0,i=a.roomIntent),"roomTitle"in a&&t(1,l=a.roomTitle)},[i,l,r,s]}class oo extends te{constructor(e){super(),re(this,e,lo,io,ne,{roomIntent:0,roomTitle:1})}}function ao(o){let e,t,r,i,l,s,a,f,c,p,n,u,d,_,g,h;return{c(){e=I("div"),t=I("div"),r=R(o[0]),i=q(),l=I("div"),s=I("div"),a=I("div"),f=R("\u25B8"),c=R(`
      Yes`),p=q(),n=I("div"),u=I("div"),d=R("\u25B8"),_=R(`
      No`),this.h()},l(v){e=E(v,"DIV",{class:!0});var k=x(e);t=E(k,"DIV",{});var y=x(t);r=H(y,o[0]),y.forEach(b),i=L(k),l=E(k,"DIV",{class:!0});var $=x(l);s=E($,"DIV",{class:!0,tabindex:!0,autofocus:!0});var j=x(s);a=E(j,"DIV",{class:!0});var O=x(a);f=H(O,"\u25B8"),O.forEach(b),c=H(j,`
      Yes`),j.forEach(b),p=L($),n=E($,"DIV",{class:!0,tabindex:!0});var P=x(n);u=E(P,"DIV",{class:!0});var M=x(u);d=H(M,"\u25B8"),M.forEach(b),_=H(P,`
      No`),P.forEach(b),$.forEach(b),k.forEach(b),this.h()},h(){m(a,"class","marker svelte-spoley"),m(s,"class","choice svelte-spoley"),m(s,"tabindex","0"),m(s,"autofocus",""),m(u,"class","marker svelte-spoley"),m(n,"class","choice svelte-spoley"),m(n,"tabindex","0"),m(l,"class","multiple-choice"),m(e,"class","object-dialog-box svelte-spoley")},m(v,k){S(v,e,k),A(e,t),A(t,r),A(e,i),A(e,l),A(l,s),A(s,a),A(a,f),A(s,c),A(l,p),A(l,n),A(n,u),A(u,d),A(n,_),s.focus(),g||(h=[F(s,"click",o[3]),F(s,"keydown",o[4]),F(n,"click",o[5]),F(n,"keydown",o[6])],g=!0)},p(v,[k]){k&1&&we(r,v[0])},i:le,o:le,d(v){v&&b(e),g=!1,Ie(h)}}}function so(o,e,t){const r=me();let{text:i=""}=e,{objectId:l=""}=e;const s=p=>{r("object",{objectId:l})},a=p=>{p.code==="Enter"&&r("object",{objectId:l})},f=p=>{r("object",{objectId:!1})},c=p=>{p.code==="Enter"&&r("object",{objectId:!1})};return o.$$set=p=>{"text"in p&&t(0,i=p.text),"objectId"in p&&t(1,l=p.objectId)},[i,l,r,s,a,f,c]}class fo extends te{constructor(e){super(),re(this,e,so,ao,ne,{text:0,objectId:1})}}function uo(o){let e,t,r,i,l,s;return i=new fo({props:{text:`Look at ${o[1]}?`,objectId:o[0]}}),i.$on("object",o[3]),{c(){e=I("div"),t=R(o[1]),r=q(),Y(i.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=x(e);t=H(f,o[1]),r=L(f),W(i.$$.fragment,f),f.forEach(b),this.h()},h(){m(e,"class","caption-container svelte-ukizaq")},m(a,f){S(a,e,f),A(e,t),A(e,r),Z(i,e,null),s=!0},p(a,[f]){(!s||f&2)&&we(t,a[1]);const c={};f&2&&(c.text=`Look at ${a[1]}?`),f&1&&(c.objectId=a[0]),i.$set(c)},i(a){s||(T(i.$$.fragment,a),l||_e(()=>{l=Ue(e,se,{}),l.start()}),s=!0)},o(a){D(i.$$.fragment,a),s=!1},d(a){a&&b(e),K(i)}}}function co(o,e,t){const r=me();let{objectIntent:i=""}=e,{objectTitle:l=""}=e;const s=a=>{r("object",{objectId:a.detail.objectId})};return o.$$set=a=>{"objectIntent"in a&&t(0,i=a.objectIntent),"objectTitle"in a&&t(1,l=a.objectTitle)},[i,l,r,s]}class _o extends te{constructor(e){super(),re(this,e,co,uo,ne,{objectIntent:0,objectTitle:1})}}function po(o){let e,t;return{c(){e=Be("svg"),t=Be("path"),this.h()},l(r){e=Fe(r,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0,class:!0});var i=x(e);t=Fe(i,"path",{d:!0,class:!0}),x(t).forEach(b),i.forEach(b),this.h()},h(){m(t,"d","M4.8474 7.78418L0.703963 0.607532L8.99084 0.607531L4.8474 7.78418Z"),m(t,"class","svelte-fiesz8"),m(e,"width","9"),m(e,"height","8"),m(e,"viewBox","0 0 9 8"),m(e,"fill","none"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"class","svelte-fiesz8")},m(r,i){S(r,e,i),A(e,t)},p:le,i:le,o:le,d(r){r&&b(e)}}}class vo extends te{constructor(e){super(),re(this,e,null,po,ne,{})}}function Ht(o){let e,t,r,i,l;return t=new vo({}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var a=x(e);W(t.$$.fragment,a),a.forEach(b),this.h()},h(){m(e,"class","next-caption svelte-ajuidy")},m(s,a){S(s,e,a),Z(t,e,null),r=!0,i||(l=F(e,"click",o[6]),i=!0)},p:le,i(s){r||(T(t.$$.fragment,s),r=!0)},o(s){D(t.$$.fragment,s),r=!1},d(s){s&&b(e),K(t),i=!1,l()}}}function mo(o){let e,t,r=Ve(o[2].text.content)+"",i,l,s,a,f,c,p=o[1]<o[0].length-1&&Ht(o);return{c(){e=I("div"),t=I("div"),s=q(),p&&p.c(),this.h()},l(n){e=E(n,"DIV",{class:!0});var u=x(e);t=E(u,"DIV",{class:!0});var d=x(t);d.forEach(b),s=L(u),p&&p.l(u),u.forEach(b),this.h()},h(){m(t,"class","caption-box svelte-ajuidy"),m(e,"class","caption-container svelte-ajuidy")},m(n,u){S(n,e,u),A(e,t),t.innerHTML=r,A(e,s),p&&p.m(e,null),a=!0,f||(c=F(t,"click",o[5]),f=!0)},p(n,[u]){o=n,(!a||u&4)&&r!==(r=Ve(o[2].text.content)+"")&&(t.innerHTML=r),o[1]<o[0].length-1?p?(p.p(o,u),u&3&&T(p,1)):(p=Ht(o),p.c(),T(p,1),p.m(e,null)):p&&(U(),D(p,1,1,()=>{p=null}),C())},i(n){a||(_e(()=>{l&&l.end(1),i=Ue(t,se,o[4]),i.start()}),T(p),a=!0)},o(n){i&&i.invalidate(),l=wr(t,se,{duration:100}),D(p),a=!1},d(n){n&&b(e),n&&l&&l.end(),p&&p.d(),f=!1,c()}}}function ho(o,e,t){const r=me(),i={duration:500};let{text:l=[]}=e,s=0,a=!1;const f=p=>{s<l.length-1?(t(1,s++,s),t(2,a=l[s])):r("close")},c=p=>{t(1,s++,s),t(2,a=l[s])};return o.$$set=p=>{"text"in p&&t(0,l=p.text)},o.$$.update=()=>{o.$$.dirty&3&&l.length>0&&t(2,a=l[s])},[l,s,a,r,i,f,c]}class bo extends te{constructor(e){super(),re(this,e,ho,mo,ne,{text:0})}}function go(o){let e,t,r,i,l,s,a,f;return{c(){e=I("div"),t=I("div"),r=I("input"),i=q(),l=I("button"),s=R("Send"),this.h()},l(c){e=E(c,"DIV",{class:!0});var p=x(e);t=E(p,"DIV",{class:!0});var n=x(t);r=E(n,"INPUT",{placeholder:!0,type:!0,maxlength:!0,class:!0}),i=L(n),l=E(n,"BUTTON",{class:!0});var u=x(l);s=H(u,"Send"),u.forEach(b),n.forEach(b),p.forEach(b),this.h()},h(){m(r,"placeholder","Write a message..."),m(r,"type","[text]"),m(r,"maxlength","600"),m(r,"class","svelte-423k25"),m(l,"class","svelte-423k25"),m(t,"class","chat-input svelte-423k25"),m(e,"class","chat-container svelte-423k25")},m(c,p){S(c,e,p),A(e,t),A(t,r),Le(r,o[0]),A(t,i),A(t,l),A(l,s),a||(f=[F(r,"input",o[3]),F(r,"keydown",o[4]),F(l,"click",o[1])],a=!0)},p(c,[p]){p&1&&Le(r,c[0])},i:le,o:le,d(c){c&&b(e),a=!1,Ie(f)}}}function yo(o,e,t){const r=me();let i="",{chatMessages:l=[]}=e;const s=()=>{r("submit",{text:i}),t(0,i="")};function a(){i=this.value,t(0,i)}const f=c=>{c.keyCode==13&&s()};return o.$$set=c=>{"chatMessages"in c&&t(2,l=c.chatMessages)},[i,s,l,a,f]}class wo extends te{constructor(e){super(),re(this,e,yo,go,ne,{chatMessages:2})}}function ko(o){let e,t,r,i,l,s,a,f,c,p,n,u,d,_,g,h,v,k,y;return{c(){e=I("div"),t=I("div"),r=I("span"),i=R("\u2190"),l=q(),s=I("div"),a=I("div"),f=I("span"),c=R("\u2191"),p=q(),n=I("div"),u=I("span"),d=R("\u2193"),_=q(),g=I("div"),h=I("span"),v=R("\u2192"),this.h()},l($){e=E($,"DIV",{class:!0});var j=x(e);t=E(j,"DIV",{class:!0});var O=x(t);r=E(O,"SPAN",{});var P=x(r);i=H(P,"\u2190"),P.forEach(b),O.forEach(b),l=L(j),s=E(j,"DIV",{class:!0});var M=x(s);a=E(M,"DIV",{class:!0});var w=x(a);f=E(w,"SPAN",{class:!0});var z=x(f);c=H(z,"\u2191"),z.forEach(b),w.forEach(b),p=L(M),n=E(M,"DIV",{class:!0});var G=x(n);u=E(G,"SPAN",{class:!0});var oe=x(u);d=H(oe,"\u2193"),oe.forEach(b),G.forEach(b),M.forEach(b),_=L(j),g=E(j,"DIV",{class:!0});var ae=x(g);h=E(ae,"SPAN",{});var X=x(h);v=H(X,"\u2192"),X.forEach(b),ae.forEach(b),j.forEach(b),this.h()},h(){m(t,"class","key left svelte-1q9tct4"),m(f,"class","svelte-1q9tct4"),m(a,"class","key up svelte-1q9tct4"),m(u,"class","svelte-1q9tct4"),m(n,"class","key down svelte-1q9tct4"),m(s,"class","vert svelte-1q9tct4"),m(g,"class","key right svelte-1q9tct4"),m(e,"class","phone-navigation svelte-1q9tct4")},m($,j){S($,e,j),A(e,t),A(t,r),A(r,i),A(e,l),A(e,s),A(s,a),A(a,f),A(f,c),A(s,p),A(s,n),A(n,u),A(u,d),A(e,_),A(e,g),A(g,h),A(h,v),k||(y=[F(t,"click",o[2]),F(a,"click",o[3]),F(n,"click",o[4]),F(g,"click",o[5])],k=!0)},p:le,i:le,o:le,d($){$&&b(e),k=!1,Ie(y)}}}function Ao(o){const e={UP:38,DOWN:40,LEFT:37,RIGHT:39},t=a=>{document.dispatchEvent(new KeyboardEvent("keydown",{keyCode:a}))};return[e,t,()=>{t(e.LEFT)},()=>{t(e.UP)},()=>{t(e.DOWN)},()=>{t(e.RIGHT)}]}class To extends te{constructor(e){super(),re(this,e,Ao,ko,ne,{})}}function Gt(o,e,t){const r=o.slice();return r[32]=e[t],r}function Nt(o){let e,t;return e=new Yi({props:{avatars:o[2]}}),e.$on("finish",o[20]),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&4&&(l.avatars=r[2]),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Ut(o){let e,t,r,i,l;return t=new Ki({props:{room:o[5],$$slots:{default:[Io]},$$scope:{ctx:o}}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var a=x(e);W(t.$$.fragment,a),a.forEach(b),this.h()},h(){m(e,"class","viewport svelte-pgjlfq"),ee(e,"pushed",o[7])},m(s,a){S(s,e,a),Z(t,e,null),o[22](e),r=!0,i||(l=F(e,"keydown",o[23]),i=!0)},p(s,a){const f={};a[0]&32&&(f.room=s[5]),a[0]&37|a[1]&16&&(f.$$scope={dirty:a,ctx:s}),t.$set(f),a[0]&128&&ee(e,"pushed",s[7])},i(s){r||(T(t.$$.fragment,s),r=!0)},o(s){D(t.$$.fragment,s),r=!1},d(s){s&&b(e),K(t),o[22](null),i=!1,l()}}}function Io(o){let e,t,r,i,l,s,a,f;return e=new nl({props:{players:o[0],currentRoomId:o[5]._id,avatars:o[2]}}),r=new ul({props:{objects:fe(o[5],"objects",[])}}),l=new bl({props:{zones:fe(o[5],"zones",[])}}),a=new El({props:{portals:fe(o[5],"portals",[])}}),a.$on("room",o[21]),{c(){Y(e.$$.fragment),t=q(),Y(r.$$.fragment),i=q(),Y(l.$$.fragment),s=q(),Y(a.$$.fragment)},l(c){W(e.$$.fragment,c),t=L(c),W(r.$$.fragment,c),i=L(c),W(l.$$.fragment,c),s=L(c),W(a.$$.fragment,c)},m(c,p){Z(e,c,p),S(c,t,p),Z(r,c,p),S(c,i,p),Z(l,c,p),S(c,s,p),Z(a,c,p),f=!0},p(c,p){const n={};p[0]&1&&(n.players=c[0]),p[0]&32&&(n.currentRoomId=c[5]._id),p[0]&4&&(n.avatars=c[2]),e.$set(n);const u={};p[0]&32&&(u.objects=fe(c[5],"objects",[])),r.$set(u);const d={};p[0]&32&&(d.zones=fe(c[5],"zones",[])),l.$set(d);const _={};p[0]&32&&(_.portals=fe(c[5],"portals",[])),a.$set(_)},i(c){f||(T(e.$$.fragment,c),T(r.$$.fragment,c),T(l.$$.fragment,c),T(a.$$.fragment,c),f=!0)},o(c){D(e.$$.fragment,c),D(r.$$.fragment,c),D(l.$$.fragment,c),D(a.$$.fragment,c),f=!1},d(c){K(e,c),c&&b(t),K(r,c),c&&b(i),K(l,c),c&&b(s),K(a,c)}}}function Ct(o){let e,t;return e=new yl({props:{soundFile:o[5].backgroundSound}}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&32&&(l.soundFile=r[5].backgroundSound),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Xt(o){let e,t;return e=new Ml({props:{streamUrl:o[32].videoUrl,audioOnly:o[32].audioOnly,title:o[32].title}}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&512&&(l.streamUrl=r[32].videoUrl),i[0]&512&&(l.audioOnly=r[32].audioOnly),i[0]&512&&(l.title=r[32].title),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Yt(o){let e,t,r=!o[10]&&(o[5]._id==o[32].parentArea._ref||o[11]._id==o[32].parentArea._ref)&&Xt(o);return{c(){r&&r.c(),e=B()},l(i){r&&r.l(i),e=B()},m(i,l){r&&r.m(i,l),S(i,e,l),t=!0},p(i,l){!i[10]&&(i[5]._id==i[32].parentArea._ref||i[11]._id==i[32].parentArea._ref)?r?(r.p(i,l),l[0]&3616&&T(r,1)):(r=Xt(i),r.c(),T(r,1),r.m(e.parentNode,e)):r&&(U(),D(r,1,1,()=>{r=null}),C())},i(i){t||(T(r),t=!0)},o(i){D(r),t=!1},d(i){r&&r.d(i),i&&b(e)}}}function Wt(o){let e,t;return e=new oo({props:{roomIntent:o[12],roomTitle:o[4][o[12]].title}}),e.$on("room",o[24]),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&4096&&(l.roomIntent=r[12]),i[0]&4112&&(l.roomTitle=r[4][r[12]].title),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Zt(o){let e,t;return e=new _o({props:{objectIntent:o[13],objectTitle:o[5].objects.find(o[25]).title}}),e.$on("object",o[26]),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&8192&&(l.objectIntent=r[13]),i[0]&8224&&(l.objectTitle=r[5].objects.find(r[25]).title),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Kt(o){let e,t,r=o[3]&&Qt(o);return{c(){r&&r.c(),e=B()},l(i){r&&r.l(i),e=B()},m(i,l){r&&r.m(i,l),S(i,e,l),t=!0},p(i,l){i[3]?r?(r.p(i,l),l[0]&8&&T(r,1)):(r=Qt(i),r.c(),T(r,1),r.m(e.parentNode,e)):r&&(U(),D(r,1,1,()=>{r=null}),C())},i(i){t||(T(r),t=!0)},o(i){D(r),t=!1},d(i){r&&r.d(i),i&&b(e)}}}function Qt(o){let e,t;return e=new bo({props:{text:o[3]}}),e.$on("close",o[27]),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&8&&(l.text=r[3]),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Jt(o){let e,t;return e=new eo({props:{article:o[14]}}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&16384&&(l.article=r[14]),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function er(o){let e,t;return e=new wo({props:{chatMessages:o[15].filter(o[28])}}),e.$on("submit",o[29]),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},p(r,i){const l={};i[0]&32800&&(l.chatMessages=r[15].filter(r[28])),e.$set(l)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function tr(o){let e,t;return e=new To({}),{c(){Y(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,i){Z(e,r,i),t=!0},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Eo(o){let e,t,r=ve(o[5],"backgroundSound.asset")&&o[8],i,l,s,a,f,c,p,n,u,d=o[6]==Re.ONBOARDING&&Nt(o),_=o[5]&&Ut(o),g=r&&Ct(o),h=o[9],v=[];for(let w=0;w<h.length;w+=1)v[w]=Yt(Gt(o,h,w));const k=w=>D(v[w],1,1,()=>{v[w]=null});let y=o[12]&&Wt(o),$=o[13]&&Zt(o),j=!o[10]&&!o[7]&&!o[14]&&!o[12]&&!o[13]&&Kt(o),O=o[14]&&Jt(o),P=!o[10]&&!o[7]&&!o[14]&&er(o),M=o[16]&&!o[14]&&tr();return{c(){d&&d.c(),e=q(),_&&_.c(),t=q(),g&&g.c(),i=q();for(let w=0;w<v.length;w+=1)v[w].c();l=q(),y&&y.c(),s=q(),$&&$.c(),a=q(),j&&j.c(),f=q(),O&&O.c(),c=q(),P&&P.c(),p=q(),M&&M.c(),n=B()},l(w){d&&d.l(w),e=L(w),_&&_.l(w),t=L(w),g&&g.l(w),i=L(w);for(let z=0;z<v.length;z+=1)v[z].l(w);l=L(w),y&&y.l(w),s=L(w),$&&$.l(w),a=L(w),j&&j.l(w),f=L(w),O&&O.l(w),c=L(w),P&&P.l(w),p=L(w),M&&M.l(w),n=B()},m(w,z){d&&d.m(w,z),S(w,e,z),_&&_.m(w,z),S(w,t,z),g&&g.m(w,z),S(w,i,z);for(let G=0;G<v.length;G+=1)v[G].m(w,z);S(w,l,z),y&&y.m(w,z),S(w,s,z),$&&$.m(w,z),S(w,a,z),j&&j.m(w,z),S(w,f,z),O&&O.m(w,z),S(w,c,z),P&&P.m(w,z),S(w,p,z),M&&M.m(w,z),S(w,n,z),u=!0},p(w,z){if(w[6]==Re.ONBOARDING?d?(d.p(w,z),z[0]&64&&T(d,1)):(d=Nt(w),d.c(),T(d,1),d.m(e.parentNode,e)):d&&(U(),D(d,1,1,()=>{d=null}),C()),w[5]?_?(_.p(w,z),z[0]&32&&T(_,1)):(_=Ut(w),_.c(),T(_,1),_.m(t.parentNode,t)):_&&(U(),D(_,1,1,()=>{_=null}),C()),z[0]&288&&(r=ve(w[5],"backgroundSound.asset")&&w[8]),r?g?(g.p(w,z),z[0]&288&&T(g,1)):(g=Ct(w),g.c(),T(g,1),g.m(i.parentNode,i)):g&&(U(),D(g,1,1,()=>{g=null}),C()),z[0]&3616){h=w[9];let G;for(G=0;G<h.length;G+=1){const oe=Gt(w,h,G);v[G]?(v[G].p(oe,z),T(v[G],1)):(v[G]=Yt(oe),v[G].c(),T(v[G],1),v[G].m(l.parentNode,l))}for(U(),G=h.length;G<v.length;G+=1)k(G);C()}w[12]?y?(y.p(w,z),z[0]&4096&&T(y,1)):(y=Wt(w),y.c(),T(y,1),y.m(s.parentNode,s)):y&&(U(),D(y,1,1,()=>{y=null}),C()),w[13]?$?($.p(w,z),z[0]&8192&&T($,1)):($=Zt(w),$.c(),T($,1),$.m(a.parentNode,a)):$&&(U(),D($,1,1,()=>{$=null}),C()),!w[10]&&!w[7]&&!w[14]&&!w[12]&&!w[13]?j?(j.p(w,z),z[0]&29824&&T(j,1)):(j=Kt(w),j.c(),T(j,1),j.m(f.parentNode,f)):j&&(U(),D(j,1,1,()=>{j=null}),C()),w[14]?O?(O.p(w,z),z[0]&16384&&T(O,1)):(O=Jt(w),O.c(),T(O,1),O.m(c.parentNode,c)):O&&(U(),D(O,1,1,()=>{O=null}),C()),!w[10]&&!w[7]&&!w[14]?P?(P.p(w,z),z[0]&17536&&T(P,1)):(P=er(w),P.c(),T(P,1),P.m(p.parentNode,p)):P&&(U(),D(P,1,1,()=>{P=null}),C()),w[16]&&!w[14]?M?z[0]&81920&&T(M,1):(M=tr(),M.c(),T(M,1),M.m(n.parentNode,n)):M&&(U(),D(M,1,1,()=>{M=null}),C())},i(w){if(!u){T(d),T(_),T(g);for(let z=0;z<h.length;z+=1)T(v[z]);T(y),T($),T(j),T(O),T(P),T(M),u=!0}},o(w){D(d),D(_),D(g),v=v.filter(Boolean);for(let z=0;z<v.length;z+=1)D(v[z]);D(y),D($),D(j),D(O),D(P),D(M),u=!1},d(w){d&&d.d(w),w&&b(e),_&&_.d(w),w&&b(t),g&&g.d(w),w&&b(i),He(v,w),w&&b(l),y&&y.d(w),w&&b(s),$&&$.d(w),w&&b(a),j&&j.d(w),w&&b(f),O&&O.d(w),w&&b(c),P&&P.d(w),w&&b(p),M&&M.d(w),w&&b(n)}}}function xo(o,e,t){let r,i,l,s,a,f,c,p,n,u,d,_,g,h,v,k,y;N(o,Yr,V=>t(30,r=V)),N(o,Wr,V=>t(4,i=V)),N(o,qe,V=>t(5,l=V)),N(o,Zr,V=>t(31,s=V)),N(o,nt,V=>t(19,a=V)),N(o,sr,V=>t(0,f=V)),N(o,Ce,V=>t(6,c=V)),N(o,fr,V=>t(7,p=V)),N(o,Kr,V=>t(8,n=V)),N(o,Qr,V=>t(9,u=V)),N(o,je,V=>t(10,d=V)),N(o,Jr,V=>t(11,_=V)),N(o,Xe,V=>t(12,g=V)),N(o,it,V=>t(13,h=V)),N(o,ye,V=>t(14,v=V)),N(o,or,V=>t(15,k=V)),N(o,Ye,V=>t(16,y=V));let $={},j=[],O=!1;const P=async V=>{Pe.set(!1),await Rr($),console.log("world object: ",i),console.log("room id: ",V);const pe=l._id,J=i[V];qe.set(J),i[V].mainArea?history.replaceState(null,null," "):history.replaceState(null,null,"#"+fe(i[V],"slug.current",""));let he=Se(4,6),Ee=Se(4,6);if(J.portals&&J.portals.find(be=>be.targetArea._id===pe)){const be=J.portals.find(_r=>_r.targetArea._id===pe);for(;he=Se(be.x-2,be.x+2),Ee=Se(be.y-2,be.y),he<1||Ee<1||he>J.dimensions.width||Ee>J.dimensions.height||he==be.x&&he==be.x;);}Hr({id:J._id,x:he,y:Ee}),await Gr($),Pe.set(!0),ve(J,"introductionTexts")?t(3,O=J.introductionTexts):t(3,O=!1)},M=async(V,pe)=>{let J={uuid:a.uuid,name:s&&s.name?s.name:V,shape:ve(s,"avatar._ref")?s.avatar._ref:pe,onboarded:!0,room:l._id,x:Se(10,30),y:Se(5,15)};if(await Nr(J),ge("\u2713 (4) Game server connected"),await Ur(),ge("\u2713 (5) Keyboard initialized"),Cr(),ge("\u2713 (6) Stream listener initialized"),window.location.hash){const he=window.location.hash.substring(1);for(const[Ee,be]of Object.entries(i))if(fe(i[Ee],"slug.current","")===he){P(Ee);break}}ve(l,"introductionTexts")&&t(3,O=l.introductionTexts),ge("\u2713 (7) Show main room introduction"),ge("__ => App loaded"),Oe.set("open-eyebeam-name",V),Oe.set("open-eyebeam-avatar",pe),Ce.set(Re.READY),setTimeout(()=>{je.set(!1)},3e3),Ye.set(window.matchMedia("(max-width: 800px)").matches)};ke(async()=>{ge("__ => App starting...");try{await zr()}catch(J){Mr("Error in authentication:",J)}ge("\u2713 (1) Auth client configured "),Oe.get("open-eyebeam-logged-in")&&!r&&qr(),await Lr(),ge("\u2713 (2) World built");for(const[J,he]of Object.entries(i))if(i[J].mainArea){qe.set(i[J]);break}t(2,j=await Br()),ge("\u2713 (3) Avatars loaded"),nt.update(J=>(J.uuid=Fr(),J));let V=Oe.get("open-eyebeam-name"),pe=Oe.get("open-eyebeam-avatar");!V&&!r?Ce.set(Re.ONBOARDING):M(V,pe)});const w=V=>{M(V.detail.name,V.detail.avatar)},z=V=>{V.detail.roomId&&P(V.detail.roomId),Xe.set(!1)};function G(V){ze[V?"unshift":"push"](()=>{$=V,t(1,$)})}const oe=V=>{V.key==="Escape"&&ye.set(!1)},ae=V=>{V.detail.roomId&&P(g),Xe.set(!1)},X=V=>V._id==h,de=V=>{V.detail.objectId&&ye.set(l.objects.find(pe=>pe._id==h)),it.set(!1)},Me=V=>{t(3,O=!1)},xe=V=>V.room===l._id,$e=V=>{Xr(V,l)};return o.$$.update=()=>{o.$$.dirty[0]&524289&&f[a.uuid]&&(f[a.uuid].x||f[a.uuid].x)&&(en(),tn(),rn())},[f,$,j,O,i,l,c,p,n,u,d,_,g,h,v,k,y,P,M,a,w,z,G,oe,ae,X,de,Me,xe,$e]}class Do extends te{constructor(e){super(),re(this,e,xo,Eo,ne,{},null,[-1,-1])}}export{Do as default};
